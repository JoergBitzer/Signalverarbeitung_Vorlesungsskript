
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>6. Filter &#8212; Signalverarbeitung 1</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="7. Literaturverzeichnis" href="zbibliography.html" />
    <link rel="prev" title="5. Spektren" href="spektren.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Signalverarbeitung 1</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Signalverarbeitung 1
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="grundlagen.html">
   1. Einführung
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="signale.html">
   2. Signale
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="systeme.html">
   3. Systeme
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ztrafo.html">
   4. z-Transformation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="spektren.html">
   5. Spektren
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   6. Filter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="zbibliography.html">
   7. Literaturverzeichnis
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/JoergBitzer/Signalverarbeitung_Vorlesungsskript/master?urlpath=tree/filter.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/JoergBitzer/Signalverarbeitung_Vorlesungsskript/"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/JoergBitzer/Signalverarbeitung_Vorlesungsskript//issues/new?title=Issue%20on%20page%20%2Ffilter.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/filter.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="_sources/filter.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#filtertypen">
   6.1. Filtertypen
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#realisierungsformen">
   6.2. Realisierungsformen
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fir-filter">
     6.2.1. FIR-Filter
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#beschreibung-als-blockdiagramm">
       6.2.1.1. Beschreibung als Blockdiagramm
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fir-filter-design">
     6.2.2. FIR-Filter Design
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#fenster-methode">
       6.2.2.1. Fenster-Methode
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#parks-mcclellan">
       6.2.2.2. Parks-McClellan
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#linearphasige-filter">
       6.2.2.3. Linearphasige Filter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#minimalphasige-fir-filter">
       6.2.2.4. Minimalphasige FIR-Filter
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iir-filter">
     6.2.3. IIR-Filter
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       6.2.3.1. Beschreibung als Blockdiagramm
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#filterstrukturen-fur-sos">
       6.2.3.2. Filterstrukturen für SOS
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#vom-blockdiagramm-zur-ubertragungsfunktion">
       6.2.3.3. Vom Blockdiagramm zur Übertragungsfunktion
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iir-filterdesign">
     6.2.4. IIR-Filterdesign
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#notch-filter">
       6.2.4.1. Notch-Filter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#allpasse">
       6.2.4.2. Allpässe
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sec-iir-filterdesign">
     6.2.5. IIR-Filterdesign
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#butterworth-filter">
       6.2.5.1. Butterworth-Filter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#tschebyscheff-i-filter">
       6.2.5.2. Tschebyscheff-I-Filter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#tschebyscheff-ii-filter">
       6.2.5.3. Tschebyscheff-II-Filter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cauer-filter">
       6.2.5.4. Cauer-Filter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#vor-und-nachteile-der-unterschiedlichen-entwurfsverfahren">
       6.2.5.5. Vor- und Nachteile der unterschiedlichen Entwurfsverfahren
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#entwurf-von-hochpass-bandpass-und-bandsperr-filter">
       6.2.5.6. Entwurf von Hochpass, Bandpass und Bandsperr-Filter
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Filter</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#filtertypen">
   6.1. Filtertypen
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#realisierungsformen">
   6.2. Realisierungsformen
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fir-filter">
     6.2.1. FIR-Filter
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#beschreibung-als-blockdiagramm">
       6.2.1.1. Beschreibung als Blockdiagramm
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fir-filter-design">
     6.2.2. FIR-Filter Design
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#fenster-methode">
       6.2.2.1. Fenster-Methode
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#parks-mcclellan">
       6.2.2.2. Parks-McClellan
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#linearphasige-filter">
       6.2.2.3. Linearphasige Filter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#minimalphasige-fir-filter">
       6.2.2.4. Minimalphasige FIR-Filter
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iir-filter">
     6.2.3. IIR-Filter
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       6.2.3.1. Beschreibung als Blockdiagramm
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#filterstrukturen-fur-sos">
       6.2.3.2. Filterstrukturen für SOS
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#vom-blockdiagramm-zur-ubertragungsfunktion">
       6.2.3.3. Vom Blockdiagramm zur Übertragungsfunktion
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iir-filterdesign">
     6.2.4. IIR-Filterdesign
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#notch-filter">
       6.2.4.1. Notch-Filter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#allpasse">
       6.2.4.2. Allpässe
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sec-iir-filterdesign">
     6.2.5. IIR-Filterdesign
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#butterworth-filter">
       6.2.5.1. Butterworth-Filter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#tschebyscheff-i-filter">
       6.2.5.2. Tschebyscheff-I-Filter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#tschebyscheff-ii-filter">
       6.2.5.3. Tschebyscheff-II-Filter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cauer-filter">
       6.2.5.4. Cauer-Filter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#vor-und-nachteile-der-unterschiedlichen-entwurfsverfahren">
       6.2.5.5. Vor- und Nachteile der unterschiedlichen Entwurfsverfahren
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#entwurf-von-hochpass-bandpass-und-bandsperr-filter">
       6.2.5.6. Entwurf von Hochpass, Bandpass und Bandsperr-Filter
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="filter">
<span id="sec-filter"></span><h1><span class="section-number">6. </span>Filter<a class="headerlink" href="#filter" title="Permalink to this headline">#</a></h1>
<p>Filter sind spezielle Systeme, die in diesem Abschnitt grundsätzlich als
LTI-Systeme angenommen werden (es gibt auch nicht LTI-Filter wie z.B. das Median Filter, diese sind aber nicht-linear). Die Aufgabe von Filtern ist typischerweise bestimmte
Frequenzanteile aus dem Signal verändern, also zu verstärken, abzuschwächen oder ganz zu entfernen.</p>
<p>Alle nicht-trivialen LTI-Systeme erzeugen eine Filterwirkung, trotzdem
werden nicht alle LTI-Systeme als Filter bezeichnet, wenn das Ziel beim
Entwurf nicht die Filterwirkung sondern irgendeine andere Eigenschaft
ist. Ein Beipiel sei die Berechnung des gleitenden Mittelwertes eines Signals. berechnen. Eine solches
System ist automatisch auch ein Filter, wird aber trotzdem nicht
unbedingt als solches bezeichnet. In vielen Fällen ist die Filterwirkung
sogar ein unerwünschter Nebeneffekt.</p>
<p>Ziel dieses Abschnittes ist es, die Grundtypen von Filtern kennen zu
lernen. Diese können als nicht-rekursive und rekursive Implementierungen vorliegen.
Abschließend werden in einer sehr kompakten Form einige bekannte
Entwurfsverfahren für die beiden Realisierungsformen vorgestellt.</p>
<section id="filtertypen">
<h2><span class="section-number">6.1. </span>Filtertypen<a class="headerlink" href="#filtertypen" title="Permalink to this headline">#</a></h2>
<p>Bei der Typisierung von Filtern schauen wir uns zunächst die sogenannten
Sperrfilter an. Ihr Entwurfsziel ist, möglichst einen bestimmten
Frequenzbereich vollständig aus dem Spektrum zu entfernen. Dabei wird
zwischen vier Grundtypen unterschieden:</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Demoscript for &quot;Signalverarbeitung 1&quot;</span>
<span class="c1">#</span>
<span class="c1"># Version: 1.0   18.02.2022</span>
<span class="c1"># </span>
<span class="c1"># This software is released as public domain under CC0 1.0</span>
<span class="c1"># https://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="c1">#-------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>

<span class="c1"># Script to create an ideal and realistic lowpass</span>

<span class="c1"># determine where we&#39;re running from and set paths accordingly</span>
<span class="k">try</span><span class="p">:</span> 
    <span class="k">if</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ZMQInteractiveShell&#39;</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;../../&#39;</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">sv.mplstyle&#39;</span><span class="p">)</span>

<span class="n">Fs</span> <span class="o">=</span> <span class="mi">8000</span>
<span class="n">fg</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># cutoff frequency</span>
<span class="n">order</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">*</span><span class="n">Fs</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="n">fg</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">Fs</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">lfilter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># dB, max amplitude = 0dB</span>
<span class="n">spectrum_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> 
<span class="n">freq_vec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_abs</span><span class="p">))</span> <span class="c1"># freq bins, for plotting</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax_spectrum</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># ideal frequency respose of filter</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">fg</span><span class="p">,</span> <span class="n">Fs</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Fs</span><span class="o">-</span><span class="n">fg</span><span class="p">,</span> <span class="n">Fs</span><span class="p">],</span> 
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Optimale Entwurfsvorgabe&quot;</span><span class="p">)</span>
<span class="c1"># actual realization</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_vec</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> 
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Mögliche Realisierung&quot;</span><span class="p">)</span>

<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in Hz &#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Dämpfung in dB&#39;</span><span class="p">,</span> 
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">Fs</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">105</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Tiefpass </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s1">.Odnung&#39;</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># glue this figure to paste it later (no effect outside of MyST NB)</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;DesignTP&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Demoscript for &quot;Signalverarbeitung 1&quot;</span>
<span class="c1">#</span>
<span class="c1"># Version: 1.0   18.02.2022</span>
<span class="c1"># </span>
<span class="c1"># This software is released as public domain under CC0 1.0</span>
<span class="c1"># https://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="c1">#-------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>

<span class="c1"># Script to create an ideal and realistic highpass</span>

<span class="c1"># determine where we&#39;re running from and set paths accordingly</span>
<span class="k">try</span><span class="p">:</span> 
    <span class="k">if</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ZMQInteractiveShell&#39;</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;../../&#39;</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">sv.mplstyle&#39;</span><span class="p">)</span>

<span class="n">Fs</span> <span class="o">=</span> <span class="mi">8000</span>
<span class="n">fg</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># cutoff frequency</span>
<span class="n">order</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">*</span><span class="n">Fs</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="n">fg</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">Fs</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">lfilter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># dB, max amplitude = 0dB</span>
<span class="n">spectrum_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> 
<span class="n">freq_vec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_abs</span><span class="p">))</span> <span class="c1"># freq bins, for plotting</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax_spectrum</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># ideal frequency respose of filter</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">fg</span><span class="p">,</span> <span class="n">Fs</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Fs</span><span class="o">-</span><span class="n">fg</span><span class="p">,</span> <span class="n">Fs</span><span class="p">],</span> 
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Optimale Entwurfsvorgabe&quot;</span><span class="p">)</span>
<span class="c1"># actual realization</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_vec</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">,</span> 
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Mögliche Realisierung&quot;</span><span class="p">)</span>

<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in Hz &#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Dämpfung in dB&#39;</span><span class="p">,</span> 
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">Fs</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">105</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Hochpass </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s1">.Odnung&#39;</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># glue this figure to paste it later (no effect outside of MyST NB)</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;DesignHP&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Demoscript for &quot;Signalverarbeitung 1&quot;</span>
<span class="c1">#</span>
<span class="c1"># Version: 1.0   18.02.2022</span>
<span class="c1"># </span>
<span class="c1"># This software is released as public domain under CC0 1.0</span>
<span class="c1"># https://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="c1">#-------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>

<span class="c1"># Script to create an ideal and realistic bandpass</span>

<span class="c1"># determine where we&#39;re running from and set paths accordingly</span>
<span class="k">try</span><span class="p">:</span> 
    <span class="k">if</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ZMQInteractiveShell&#39;</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;../../&#39;</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">sv.mplstyle&#39;</span><span class="p">)</span>

<span class="n">Fs</span> <span class="o">=</span> <span class="mi">8000</span>
<span class="n">fg</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">]</span><span class="c1"># cutoff frequency</span>
<span class="n">order</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">*</span><span class="n">Fs</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">b</span><span class="p">,</span><span class="n">a</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="n">fg</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;bandpass&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">Fs</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">lfilter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="c1"># dB, max amplitude = 0dB</span>
<span class="n">spectrum_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> 
<span class="n">freq_vec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_abs</span><span class="p">))</span> <span class="c1"># freq bins, for plotting</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax_spectrum</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># ideal frequency respose of filter</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">],</span> 
        <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">fg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fg</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Fs</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Fs</span><span class="o">-</span><span class="n">fg</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Fs</span><span class="o">-</span><span class="n">fg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Fs</span><span class="p">],</span> 
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Optimale Entwurfsvorgabe&quot;</span><span class="p">)</span>
<span class="c1"># actual realization</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_vec</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">,</span> 
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Mögliche Realisierung&quot;</span><span class="p">)</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in Hz &#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Dämpfung in dB&#39;</span><span class="p">,</span> 
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">Fs</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">105</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Bandpass </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s1">.Odnung&#39;</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># glue this figure to paste it later (no effect outside of MyST NB)</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;DesignBP&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Demoscript for &quot;Signalverarbeitung 1&quot;</span>
<span class="c1">#</span>
<span class="c1"># Version: 1.0   18.02.2022</span>
<span class="c1"># </span>
<span class="c1"># This software is released as public domain under CC0 1.0</span>
<span class="c1"># https://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="c1">#-------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>

<span class="c1"># Script to create an ideal and realistic bandstop</span>

<span class="c1"># determine where we&#39;re running from and set paths accordingly</span>
<span class="k">try</span><span class="p">:</span> 
    <span class="k">if</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ZMQInteractiveShell&#39;</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;../../&#39;</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">sv.mplstyle&#39;</span><span class="p">)</span>

<span class="n">Fs</span> <span class="o">=</span> <span class="mi">8000</span>
<span class="n">fg</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">]</span><span class="c1"># cutoff frequency</span>
<span class="n">order</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">*</span><span class="n">Fs</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">b</span><span class="p">,</span><span class="n">a</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="n">fg</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;bandstop&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">Fs</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">lfilter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="c1"># dB, max amplitude = 0dB</span>
<span class="n">spectrum_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> 
<span class="n">freq_vec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_abs</span><span class="p">))</span> <span class="c1"># freq bins, for plotting</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">ax_spectrum</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># ideal frequency respose of filter</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> 
        <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">fg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fg</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Fs</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Fs</span><span class="o">-</span><span class="n">fg</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Fs</span><span class="o">-</span><span class="n">fg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Fs</span><span class="p">],</span> 
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Optimale Entwurfsvorgabe&quot;</span><span class="p">)</span>
<span class="c1"># actual realization</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_vec</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">,</span> 
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Mögliche Realisierung&quot;</span><span class="p">)</span>

<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in Hz &#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Dämpfung in dB&#39;</span><span class="p">,</span> 
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">Fs</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">105</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Bandsperre </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s1">.Odnung&#39;</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># glue this figure to paste it later (no effect outside of MyST NB)</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;DesignBS&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="b03cf27c-3269-4856-9f03-e5cbf60c9d01" name="e317c6c2-b34a-43b0-94e0-c196225dc477" type="radio">
</input><label class="sd-tab-label" for="b03cf27c-3269-4856-9f03-e5cbf60c9d01">
Tiefpass</label><div class="sd-tab-content docutils">
<p><strong>Tiefpass:</strong> Ziel des Tiefpasses ist es alle hohen Frequenzen ab
einer zu definierenden Grenzfrequenz <span class="math notranslate nohighlight">\(f_\text{g}\)</span> aus dem Spektrum zu
entfernen. In der technischen Umsetzung ist es aber nicht möglich,
einen abrupten Übergang zwischen dem sog. Durchlassbereich (tiefe
Frequenzen beim Tiefpass) und dem Sperrbereich zu realisieren. Eine
praktische Realisierung hat deshalb immer bestimmte Grenz- und
Übergangsbereiche.</p>
<figure class="align-default" id="fig-designtp" style="width: 100%">
<div class="cell_output docutils container">
<img alt="_images/filter_1_1.png" src="_images/filter_1_1.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 6.1 </span><span class="caption-text">Optimaler
Entwurf eines Tiefpasses (<span class="math notranslate nohighlight">\(f_\text{s}\)</span> = 8 kHz und Grenzfrequenz = <span class="math notranslate nohighlight">\(f_\text{g}\)</span> =
1 kHz) und Realisierung durch Butterworth-Filter 6. Ordnung (siehe <a class="reference internal" href="#sec-butterworth-filter"><span class="std std-numref">Abschnitt 6.2.5.1</span></a>)</span><a class="headerlink" href="#fig-designtp" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="53bd93ae-9772-41d4-9fbe-50583213a5c7" name="e317c6c2-b34a-43b0-94e0-c196225dc477" type="radio">
</input><label class="sd-tab-label" for="53bd93ae-9772-41d4-9fbe-50583213a5c7">
Hochpass</label><div class="sd-tab-content docutils">
<p><strong>Hochpass:</strong> Das inverse Designziel zum Tiefpass liegt dem
Hochpassentwurf zu Grunde. Es sollen möglichst alle tiefen
Frequenzen aus dem Spektrum entfernt werden. Auch hier gelten die
beim Tiefpass erwähnten Einschränkungen.</p>
<figure class="align-default" id="fig-designhp" style="width: 100%">
<div class="cell_output docutils container">
<img alt="_images/filter_2_1.png" src="_images/filter_2_1.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 6.2 </span><span class="caption-text">Optimaler
Entwurf eines Hochpasses (<span class="math notranslate nohighlight">\(f_\text{s}\)</span> = 8 kHz und Grenzfrequenz = <span class="math notranslate nohighlight">\(f_\text{g}\)</span> =
1 kHz) und Realisierung durch Butterworth-Filter 6. Ordnung (siehe <a class="reference internal" href="#sec-butterworth-filter"><span class="std std-numref">Abschnitt 6.2.5.1</span></a>)</span><a class="headerlink" href="#fig-designhp" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="3b73ec7a-4895-4b9e-8553-dfa45fc6e7c1" name="e317c6c2-b34a-43b0-94e0-c196225dc477" type="radio">
</input><label class="sd-tab-label" for="3b73ec7a-4895-4b9e-8553-dfa45fc6e7c1">
Bandpass</label><div class="sd-tab-content docutils">
<p><strong>Bandpass:</strong> Im Gegensatz zu den vorher erwähnten Typen hat das
Bandpassfilter zwei Grenzfrequenzen <span class="math notranslate nohighlight">\(f_1\)</span> und <span class="math notranslate nohighlight">\(f_2\)</span>. Das
Designziel ist, nur die Frequenzen zwischen <span class="math notranslate nohighlight">\(f_1\)</span> und <span class="math notranslate nohighlight">\(f_2\)</span>
durchzulassen und alle Frequenzen unterhalb von <span class="math notranslate nohighlight">\(f_1\)</span> bzw. oberhalb
von <span class="math notranslate nohighlight">\(f_2\)</span> zu entfernen. Die Differenz zwischen <span class="math notranslate nohighlight">\(f1\)</span> und <span class="math notranslate nohighlight">\(f_2\)</span> wird
Bandbreite <span class="math notranslate nohighlight">\(B = f_2 -
        f_1\)</span> genannt.</p>
<figure class="align-default" id="fig-designbp" style="width: 100%">
<div class="cell_output docutils container">
<img alt="_images/filter_3_1.png" src="_images/filter_3_1.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 6.3 </span><span class="caption-text">Optimaler
Entwurf eines Bandpasses (<span class="math notranslate nohighlight">\(f_\text{s}\)</span> = 8 kHz und Grenzfrequenz <span class="math notranslate nohighlight">\(f_1\)</span> = 1
kHz und <span class="math notranslate nohighlight">\(f_2 =\)</span> 3 kHz) und Realisierung durch Butterworth-Filter 6.
Ordnung (siehe <a class="reference internal" href="#sec-butterworth-filter"><span class="std std-numref">Abschnitt 6.2.5.1</span></a>)</span><a class="headerlink" href="#fig-designbp" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="ce95c687-7260-49b0-9317-478ceb500cf7" name="e317c6c2-b34a-43b0-94e0-c196225dc477" type="radio">
</input><label class="sd-tab-label" for="ce95c687-7260-49b0-9317-478ceb500cf7">
Bandsperre</label><div class="sd-tab-content docutils">
<p><strong>Bandsperre:</strong> Die Bandsperre stellt die inverse Funktion zum
Bandpass dar. Bei diesem Entwurf sollen möglichst alle Frequenzen im
Bereich zwischen <span class="math notranslate nohighlight">\(f_1\)</span> und <span class="math notranslate nohighlight">\(f_2\)</span> aus dem Spektrum entfernt werden.</p>
<figure class="align-default" id="fig-designbs" style="width: 100%">
<div class="cell_output docutils container">
<img alt="_images/filter_4_1.png" src="_images/filter_4_1.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 6.4 </span><span class="caption-text">Optimaler
Entwurf einer Bandsperre (<span class="math notranslate nohighlight">\(f_\text{s}\)</span> = 8 kHz und Grenzfrequenz <span class="math notranslate nohighlight">\(f_1\)</span> = 1
kHz und <span class="math notranslate nohighlight">\(f_2 =\)</span> 3 kHz) und Realisierung durch Butterworth-Filter 6.
Ordnung (siehe <a class="reference internal" href="#sec-butterworth-filter"><span class="std std-numref">Abschnitt 6.2.5.1</span></a>)</span><a class="headerlink" href="#fig-designbs" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<p>Eine weitere Gruppe von Filtern hat das Ziel, Signale die durch eine
Übertragung verändert wurden, wieder in ihre ursprüngliche Form zurück
zu bringen. Das Ziel ist also, ein verändertes Spektrum zu begradigen,
bzw. auszugleichen. Aus dieser Aufgabe folgt auch die verwendete
englische Typbezeichnung Equalizer. In der Tonstudiotechnik werden diese
Filter zwar nicht nur zu diesem Zweck verwendet, aber auch dort werden
die Klangformungsfilter als Equalizer bezeichnet. Equalizer ist ein sehr
allgemeiner Begriff und kann Filter beinhalten, die eine vollständige
Vorgabe der Übertragungsfunktion versuchen zu realisieren. Zum Beispiel
bei der Hörgeräteanpassung, die eine vollständige Beschreibung des
Hörverlustes als Ausgangsbasis verwendet. Oder aber es werden nur
bestimmte Bereiche verändert. Zu dieser letzten Gruppe gehören die
Equalizer, wie sie in der Tonstudiotechnik verwendet werden. Hierbei
wird zwischen den parametrischen Equalizern und den sogenannten
Terzband-Equalizern (eine (große) Terz beschreibt eine drittel Oktave,
die wiederum eine Frequenzverdoppelung beschreibt) unterschieden.</p>
<p>Bei den parametrischen Equalizern können durch die drei Parameter</p>
<ul class="simple">
<li><p>Frequenz,</p></li>
<li><p>Verstärkung bzw. Abschwächung und</p></li>
<li><p>Güte (<span class="math notranslate nohighlight">\(Q\)</span>-Faktor)</p></li>
</ul>
<p>sehr genaue Eingriffe in das Klangspektrum vorgenommen werden. Dabei ist
die Güte <span class="math notranslate nohighlight">\(Q = \frac{f_\text{m}}{B}\)</span> als Verhältnis von Mittenfrequenz <span class="math notranslate nohighlight">\(f_\text{m}\)</span> und Bandbreite <span class="math notranslate nohighlight">\(B\)</span> definiert.</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Demoscript for &quot;Signalverarbeitung 1&quot;</span>
<span class="c1">#</span>
<span class="c1"># Version: 1.0   18.02.2022</span>
<span class="c1"># </span>
<span class="c1"># This software is released as public domain under CC0 1.0</span>
<span class="c1"># https://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="c1">#-------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">from</span> <span class="nn">matplotlib.widgets</span> <span class="kn">import</span> <span class="n">Slider</span>

<span class="c1"># determine where we&#39;re running from and set paths accordingly</span>
<span class="k">try</span><span class="p">:</span> 
    <span class="k">if</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ZMQInteractiveShell&#39;</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;../../&#39;</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">sv.mplstyle&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_peak_EQ</span><span class="p">(</span><span class="n">f_0</span><span class="p">,</span> <span class="n">gain_dB</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">f_s</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    calculates filter coefficients of a peak equalizer</span>
<span class="sd">    with the given parameters</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    f_0 : int</span>
<span class="sd">        peak frequency in Hz</span>
<span class="sd">    gain_dB : int</span>
<span class="sd">        dB gain at peak</span>
<span class="sd">    Q : float</span>
<span class="sd">        Quality of filter</span>
<span class="sd">    f_s : int</span>
<span class="sd">        sampling frequency</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">K</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f_0</span><span class="o">/</span><span class="p">(</span><span class="n">f_s</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span>
    <span class="n">den</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">gain_dB</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">V0</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">gain_dB</span><span class="o">/</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">den</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">K</span><span class="o">/</span><span class="n">Q</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span><span class="p">)</span>
        <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">V0</span><span class="o">*</span><span class="n">K</span><span class="o">/</span><span class="n">Q</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span><span class="p">)</span>
        <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">K</span><span class="o">*</span><span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">V0</span><span class="o">*</span><span class="n">K</span><span class="o">/</span><span class="n">Q</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span><span class="p">)</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">K</span><span class="o">*</span><span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">K</span><span class="o">/</span><span class="n">Q</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">V0</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">gain_dB</span><span class="o">/</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">den</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">V0</span><span class="o">*</span><span class="n">K</span><span class="o">/</span><span class="n">Q</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span><span class="p">)</span>
        <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">K</span><span class="o">/</span><span class="n">Q</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span><span class="p">)</span>
        <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">K</span><span class="o">*</span><span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">K</span><span class="o">/</span><span class="n">Q</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span><span class="p">)</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">K</span><span class="o">*</span><span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">V0</span><span class="o">*</span><span class="n">K</span><span class="o">/</span><span class="n">Q</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span><span class="p">)</span>
    
    <span class="n">b</span> <span class="o">/=</span> <span class="n">den</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">/=</span> <span class="n">den</span>
    
    <span class="k">return</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span>
    

<span class="n">gains</span> <span class="o">=</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">]</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">48000</span>
<span class="n">freq</span><span class="o">=</span> <span class="mi">8000</span>
<span class="n">Q</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_gain</span><span class="p">,</span> <span class="n">ax_freq</span><span class="p">,</span> <span class="n">ax_Q</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">gain</span> <span class="ow">in</span> <span class="n">gains</span><span class="p">:</span>
    <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">get_peak_EQ</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">gain</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span> <span class="c1"># get filter coeefficients        </span>
    <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span> <span class="c1"># calculate impulse response</span>
    <span class="n">h_db</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">))</span> <span class="c1"># dB</span>
    <span class="n">ax_gain</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h_db</span><span class="p">)</span>

<span class="n">ax_gain</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in Hz&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Verstärkung in dB&#39;</span><span class="p">,</span>     
        <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Peak-EQ mit variablem Gain </span><span class="se">\n\</span>
<span class="s1">        bei Frequenz f = </span><span class="si">{</span><span class="n">freq</span><span class="si">}</span><span class="s1"> Hz mit Güte Q = </span><span class="si">{</span><span class="n">Q</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">freqs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="n">fs</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="n">fs</span><span class="o">/</span><span class="mi">3</span><span class="p">]</span>
<span class="n">gain</span> <span class="o">=</span> <span class="mi">12</span>
<span class="k">for</span> <span class="n">freq</span> <span class="ow">in</span> <span class="n">freqs</span><span class="p">:</span>
    <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">get_peak_EQ</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">gain</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span> <span class="c1"># get filter coeefficients</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span> <span class="c1"># calculate impulse response</span>
    <span class="n">h_db</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">))</span> <span class="c1"># dB</span>
    <span class="n">ax_freq</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h_db</span><span class="p">)</span>
<span class="n">ax_freq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in Hz&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Verstärkung in dB&#39;</span><span class="p">,</span> 
        <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Peak-EQ mit variabler Frequenz </span><span class="se">\n\</span>
<span class="s1">        bei Gain = </span><span class="si">{</span><span class="n">gain</span><span class="si">}</span><span class="s1"> dB und Güte Q = </span><span class="si">{</span><span class="n">Q</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">Qs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">freq</span> <span class="o">=</span> <span class="mi">8000</span>

<span class="k">for</span> <span class="n">Q</span> <span class="ow">in</span> <span class="n">Qs</span><span class="p">:</span>
    <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">get_peak_EQ</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">gain</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span> <span class="c1"># get filter coeefficients</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span> <span class="c1"># calculate impulse response</span>
    <span class="n">h_db</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">))</span> <span class="c1"># dB</span>
    <span class="n">ax_Q</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h_db</span><span class="p">)</span>
<span class="n">ax_Q</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in Hz&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Verstärkung in dB&#39;</span><span class="p">,</span> 
         <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Peak-EQ mit variabler Güte </span><span class="se">\n\</span>
<span class="s1">         bei Frequenz f = </span><span class="si">{</span><span class="n">freq</span><span class="si">}</span><span class="s1"> Hz und Gain = </span><span class="si">{</span><span class="n">gain</span><span class="si">}</span><span class="s1"> dB&#39;</span><span class="p">)</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># glue this figure to paste it later (no effect outside of MyST NB)</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;EQ_GainParam&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="b0b9fa3f-b404-4412-9633-c8e4fd54ec8e" name="f43e1ebb-e731-45df-8168-edb47f049dfe" type="radio">
</input><label class="sd-tab-label" for="b0b9fa3f-b404-4412-9633-c8e4fd54ec8e">
Buchabbildung</label><div class="sd-tab-content docutils">
<figure class="align-default" id="fig-eq-gainparam" style="width: 100%">
<div class="cell_output docutils container">
<img alt="_images/filter_7_2.png" src="_images/filter_7_2.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 6.5 </span><span class="caption-text">Equalizerübertragungskurve bei Veränderung der
Güte</span><a class="headerlink" href="#fig-eq-gainparam" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="9f086920-b586-44b0-a1d5-8215ed9f7f24" name="f43e1ebb-e731-45df-8168-edb47f049dfe" type="radio">
</input><label class="sd-tab-label" for="9f086920-b586-44b0-a1d5-8215ed9f7f24">
Interaktiv arbeiten</label><div class="sd-tab-content docutils">
<ol class="simple">
<li><p>Starten des interaktiven Programms - <code class="docutils literal notranslate"><span class="pre">Filter_Peak_EQ.py</span></code> in <code class="docutils literal notranslate"><span class="pre">jupyterbook/code/interactive_programs/</span></code></p></li>
<li><p>Mit Slidern Parameter einstellen</p></li>
</ol>
</div>
</div>
<p>Es gibt auch noch spezielle Filter für den Hoch- und Tiefpassbereich,
die als Kuhschwanzfilter (Shelving-Filter) bezeichnet werden. Hierbei
stehen nur die zwei Parameter Frequenz und Verstärkung bzw. Abschwächung
zur Verfügung.</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Demoscript for &quot;Signalverarbeitung 1&quot;</span>
<span class="c1">#</span>
<span class="c1"># Version: 1.0   18.02.2022</span>
<span class="c1"># </span>
<span class="c1"># This software is released as public domain under CC0 1.0</span>
<span class="c1"># https://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="c1">#-------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">from</span> <span class="nn">matplotlib.widgets</span> <span class="kn">import</span> <span class="n">RadioButtons</span>
<span class="kn">from</span> <span class="nn">matplotlib.widgets</span> <span class="kn">import</span> <span class="n">Slider</span>

<span class="c1"># determine where we&#39;re running from and set paths accordingly</span>
<span class="k">try</span><span class="p">:</span> 
    <span class="k">if</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ZMQInteractiveShell&#39;</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;../../&#39;</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">sv.mplstyle&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">getShelvingEQ</span><span class="p">(</span><span class="n">f_0</span><span class="p">,</span> <span class="n">Gain_dB</span><span class="p">,</span> <span class="n">shelf_type</span><span class="p">,</span> <span class="n">fs</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    calculates filter coefficients of a shelving equalizer</span>
<span class="sd">    with the given parameters</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    f_0 : int</span>
<span class="sd">        peak frequency in Hz</span>
<span class="sd">    gain_dB : int</span>
<span class="sd">        dB gain at peak</span>
<span class="sd">    shelf_type : str</span>
<span class="sd">        &quot;high&quot; for high-shelf, anything else for low shelf</span>
<span class="sd">    fs : int</span>
<span class="sd">        sampling frequency</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">K</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f_0</span><span class="o">/</span><span class="p">(</span><span class="n">fs</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span>
    <span class="n">den</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="n">shelf_type</span> <span class="o">==</span> <span class="s2">&quot;high&quot;</span><span class="p">):</span> <span class="c1"># High-Shelf</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">Gain_dB</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">V0</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">Gain_dB</span><span class="o">/</span><span class="mi">20</span><span class="p">)</span>
            <span class="n">den</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span>
            <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">V0</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">V0</span><span class="p">)</span><span class="o">*</span><span class="n">K</span><span class="o">+</span><span class="n">K</span><span class="o">*</span><span class="n">K</span> 
            <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">K</span><span class="o">*</span><span class="n">K</span> <span class="o">-</span> <span class="n">V0</span><span class="p">)</span> 
            <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">V0</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">V0</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span>  
            <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">K</span><span class="o">*</span><span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>            
            <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span>  
            <span class="n">b</span> <span class="o">/=</span> <span class="n">den</span>
            <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">/=</span> <span class="n">den</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">V0</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">Gain_dB</span><span class="o">/</span><span class="mi">20</span><span class="p">)</span>
            <span class="n">den</span> <span class="o">=</span> <span class="n">V0</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">V0</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span>
            <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span> 
            <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">K</span><span class="o">*</span><span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> 
            <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span>  
            <span class="n">b</span> <span class="o">/=</span> <span class="n">den</span>
            <span class="n">den</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">V0</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span><span class="o">/</span><span class="n">V0</span>
            <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">K</span><span class="o">*</span><span class="n">K</span><span class="o">/</span><span class="n">V0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> 
            <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">V0</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span><span class="o">/</span><span class="n">V0</span><span class="p">)</span>  
            <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">/=</span> <span class="n">den</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1">#Low-Shelf 0 or default for != 1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">Gain_dB</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">V0</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">Gain_dB</span><span class="o">/</span><span class="mi">20</span><span class="p">)</span>
            <span class="n">den</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span>
            <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">V0</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">V0</span><span class="o">*</span><span class="n">K</span><span class="o">*</span><span class="n">K</span> 
            <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">V0</span><span class="o">*</span><span class="n">K</span><span class="o">*</span><span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> 
            <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">V0</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">V0</span><span class="o">*</span><span class="n">K</span><span class="o">*</span><span class="n">K</span>  
            <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">K</span><span class="o">*</span><span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> 
            <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span>  
        <span class="k">else</span><span class="p">:</span>
            <span class="n">V0</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">Gain_dB</span><span class="o">/</span><span class="mi">20</span><span class="p">)</span>
            <span class="n">den</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">V0</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">V0</span><span class="o">*</span><span class="n">K</span><span class="o">*</span><span class="n">K</span>
            <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span> 
            <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">K</span><span class="o">*</span><span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> 
            <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span>  
            <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">V0</span><span class="o">*</span><span class="n">K</span><span class="o">*</span><span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">V0</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">V0</span><span class="o">*</span><span class="n">K</span><span class="o">*</span><span class="n">K</span>
            
        <span class="n">b</span> <span class="o">/=</span> <span class="n">den</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">/=</span> <span class="n">den</span>

    <span class="k">return</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span>

<span class="c1">#parameters</span>
<span class="n">gains</span> <span class="o">=</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">]</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">48000</span>
<span class="n">f_c</span> <span class="o">=</span> <span class="mi">8000</span>
<span class="n">shelf_types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;low&quot;</span><span class="p">,</span> <span class="s2">&quot;high&quot;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_gain</span><span class="p">,</span> <span class="n">ax_freq</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">gain</span> <span class="ow">in</span> <span class="n">gains</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">ftype</span> <span class="ow">in</span> <span class="n">shelf_types</span><span class="p">:</span>
        <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">getShelvingEQ</span><span class="p">(</span><span class="n">f_c</span><span class="p">,</span> <span class="n">gain</span><span class="p">,</span> <span class="n">ftype</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span> <span class="c1"># get filter coefficients</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span> <span class="c1"># calculate impulse response</span>
        <span class="c1">#with numpy.errstate(divide=&#39;ignore&#39;):</span>
        <span class="n">h_db</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">))</span> <span class="c1"># dB</span>
        <span class="n">ax_gain</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h_db</span><span class="p">)</span>

<span class="n">ax_gain</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in Hz&#39;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Verstärkung in dB&#39;</span><span class="p">,</span> 
        <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Shelf-EQs variablem Gain </span><span class="se">\n</span><span class="s1"> bei Grenzfrequenz f = </span><span class="si">{</span><span class="n">f_c</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>

        

<span class="n">freqs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="n">fs</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="n">fs</span><span class="o">/</span><span class="mi">3</span><span class="p">]</span>
<span class="n">gain</span> <span class="o">=</span> <span class="mi">12</span>
<span class="k">for</span> <span class="n">f_c</span> <span class="ow">in</span> <span class="n">freqs</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">ftype</span> <span class="ow">in</span> <span class="n">shelf_types</span><span class="p">:</span>
        <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">getShelvingEQ</span><span class="p">(</span><span class="n">f_c</span><span class="p">,</span> <span class="n">gain</span><span class="p">,</span> <span class="n">ftype</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span> <span class="c1"># get filter coefficients</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">fs</span> <span class="o">=</span> <span class="n">fs</span><span class="p">)</span> <span class="c1"># calculate impulse response</span>
        <span class="k">with</span> <span class="n">numpy</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
            <span class="n">h_db</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">))</span> <span class="c1"># dB</span>
        <span class="n">ax_freq</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h_db</span><span class="p">)</span>
<span class="n">ax_freq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in Hz&#39;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Verstärkung in dB&#39;</span><span class="p">,</span> 
        <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Shelf-EQs mit variabler Grenzfrequenz </span><span class="se">\n</span><span class="s1"> bei Gain = </span><span class="si">{</span><span class="n">gain</span><span class="si">}</span><span class="s1"> dB&#39;</span><span class="p">)</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># glue this figure to paste it later (no effect outside of MyST NB)</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;EQ_ShelvParam&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="eeec004e-4116-4afc-9977-400f0514281c" name="feeb0f20-c964-4465-bd63-4c1522750262" type="radio">
</input><label class="sd-tab-label" for="eeec004e-4116-4afc-9977-400f0514281c">
Buchabbildung</label><div class="sd-tab-content docutils">
<figure class="align-default" id="fig-eq-shelvparam" style="width: 100%">
<div class="cell_output docutils container">
<img alt="_images/filter_10_3.png" src="_images/filter_10_3.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 6.6 </span><span class="caption-text">Equalizerübertragungskurven eines Hoch bzw. Tiefpasskuhschwanzfilters bei Veränderung der Verstärkung und Frequenz</span><a class="headerlink" href="#fig-eq-shelvparam" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="57427f8b-761a-4afe-be05-ed889a77f683" name="feeb0f20-c964-4465-bd63-4c1522750262" type="radio">
</input><label class="sd-tab-label" for="57427f8b-761a-4afe-be05-ed889a77f683">
Interaktiv arbeiten</label><div class="sd-tab-content docutils">
<ol class="simple">
<li><p>Starten des interaktiven Programms - <code class="docutils literal notranslate"><span class="pre">Filter_Shelving_EQ.py</span></code> in <code class="docutils literal notranslate"><span class="pre">jupyterbook/code/interactive_programs/</span></code></p></li>
<li><p>Mit Slidern Parameter einstellen</p></li>
</ol>
</div>
</div>
<p>Im Gegensatz zu den vollparametrischen EQs sind bei einem Terzband-Equalizer
die Frequenzen und Güten festgelegt. Der Nutzer hat nur einen Einfluss
auf die Verstärkung oder Absenkung. Der Vorteil dieser Equalizer ist ihre
einfache Bedienung und die Möglichkeit sofort zu sehen, welche
Frequenzveränderungen vorgenommen werden. Die Mittenfrequenzen der
Filter sind standardisiert:</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span>

<span class="n">df_oktav</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;index&#39;</span><span class="p">:[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> 
    <span class="s1">&#39;Frequenz (Hz)&#39;</span><span class="p">:[</span><span class="mf">31.5</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">8000</span><span class="p">,</span> <span class="mi">16000</span><span class="p">]})</span>
<span class="n">df_terz</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">16</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> 
     <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">]</span> <span class="p">,</span>
    <span class="s1">&#39;Frequenz (Hz)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span><span class="mf">31.5</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> 
     <span class="mi">315</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">630</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1250</span><span class="p">,</span><span class="mi">1600</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span><span class="mi">2500</span><span class="p">,</span>
     <span class="mi">3150</span><span class="p">,</span><span class="mi">4000</span><span class="p">,</span><span class="mi">5000</span><span class="p">,</span><span class="mi">6300</span><span class="p">,</span><span class="mi">8000</span><span class="p">,</span><span class="mi">10000</span><span class="p">,</span><span class="mi">12500</span><span class="p">,</span><span class="mi">16000</span><span class="p">,</span><span class="mi">20000</span><span class="p">]})</span>
<span class="n">df_oktav</span> <span class="o">=</span> <span class="n">df_oktav</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="n">df_terz</span> <span class="o">=</span> <span class="n">df_terz</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;df_oktav&quot;</span><span class="p">,</span> <span class="n">df_oktav</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;df_terz&quot;</span><span class="p">,</span> <span class="n">df_terz</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row docutils">
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm docutils">
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Oktav-EQ</div>
<figure class="align-default" id="tab-df-oktav" style="width: 300px">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequenz (Hz)</th>
    </tr>
    <tr>
      <th>index</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>-5</th>
      <td>31.5</td>
    </tr>
    <tr>
      <th>-4</th>
      <td>63.0</td>
    </tr>
    <tr>
      <th>-3</th>
      <td>125.0</td>
    </tr>
    <tr>
      <th>-2</th>
      <td>250.0</td>
    </tr>
    <tr>
      <th>-1</th>
      <td>500.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>1000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4000.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8000.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16000.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</figure>
</div>
</div>
</div>
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm docutils">
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Terz-EQ</div>
<figure class="align-default" id="tab-df-terz" style="width: 300px">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequenz (Hz)</th>
    </tr>
    <tr>
      <th>index</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>-16</th>
      <td>25.0</td>
    </tr>
    <tr>
      <th>-15</th>
      <td>31.5</td>
    </tr>
    <tr>
      <th>-14</th>
      <td>40.0</td>
    </tr>
    <tr>
      <th>-13</th>
      <td>50.0</td>
    </tr>
    <tr>
      <th>-12</th>
      <td>63.0</td>
    </tr>
    <tr>
      <th>-11</th>
      <td>80.0</td>
    </tr>
    <tr>
      <th>-10</th>
      <td>100.0</td>
    </tr>
    <tr>
      <th>-9</th>
      <td>125.0</td>
    </tr>
    <tr>
      <th>-8</th>
      <td>160.0</td>
    </tr>
    <tr>
      <th>-7</th>
      <td>200.0</td>
    </tr>
    <tr>
      <th>-6</th>
      <td>250.0</td>
    </tr>
    <tr>
      <th>-5</th>
      <td>315.0</td>
    </tr>
    <tr>
      <th>-4</th>
      <td>400.0</td>
    </tr>
    <tr>
      <th>-3</th>
      <td>500.0</td>
    </tr>
    <tr>
      <th>-2</th>
      <td>630.0</td>
    </tr>
    <tr>
      <th>-1</th>
      <td>800.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>1000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1250.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1600.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2500.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>3150.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>4000.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>5000.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>6300.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>8000.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10000.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12500.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>16000.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>20000.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>Für bestimmte Anwendungen (z.B. Synthesizer) werden auch manchmal Filter
verwendet, die in ihrer Grundcharakteristik den Sperrfiltern
entsprechen, aber zusätzlich in der Nähe der Grenzfrequenz eine
Verstärkung einbringen. Diese Verstärkungsfrequenzen kommen bei
natürlichen Musikinstrumenten ebenfalls häufig vor. Man spricht in
diesem Fall von Resonanzfrequenzen, da bestimmte Signalanteile im
Filter eine starke Resonanz finden.</p>
</section>
<section id="realisierungsformen">
<h2><span class="section-number">6.2. </span>Realisierungsformen<a class="headerlink" href="#realisierungsformen" title="Permalink to this headline">#</a></h2>
<p>Wir haben gesehen, dass es eine Vielzahl von unterschiedlichen
Filtereinsatzmöglichkeiten gibt. Bisher wurde aber keinerlei Hinweis auf
die Realsierungsformen gegeben. Aus der Beschreibung von Systemen kennen
wir zwei unterschiedliche Systemarten. Die Systeme mit Rückkopplung
(rekursiv) und ohne Rückkopplung (transversal). Als Bezeichnung hatten wir
Infinite Impulse Response (IIR) bzw. Finite Impulse Response (FIR) Systeme
eingeführt.
Und genau diese Bezeichnungen kennzeichnen auch die beiden grundsätzlichen
Realisierungsformen von Filtern.</p>
<section id="fir-filter">
<h3><span class="section-number">6.2.1. </span>FIR-Filter<a class="headerlink" href="#fir-filter" title="Permalink to this headline">#</a></h3>
<p>Die Anwendung von FIR-Filtern ist ausschließlich durch digitale
Signalverarbeitung möglich, da eine Realisierung in Analogtechnk mit
elektrischen Bauelementen nicht möglich ist. FIR-Filter zeichnen sich
durch einige positive Eigenschaften aus. In erster Linie kann die
Stabilität immer garantiert werden. Alle FIR-Filter sind stabil.
Weiterhin ist es möglich mit FIR-Systemem Filter zu realisieren, die nur
den Betragsfrequenzgang verändern und sonst nur eine zeitliche
Verzögerung des Signals bewirken. Die zeitliche Verzögerung macht sich
in der Übertragungsfunktion durch eine lineare Phase deutlich. Diese
Filter werden deshalb linearphasig genannt.</p>
<section id="beschreibung-als-blockdiagramm">
<h4><span class="section-number">6.2.1.1. </span>Beschreibung als Blockdiagramm<a class="headerlink" href="#beschreibung-als-blockdiagramm" title="Permalink to this headline">#</a></h4>
<p>Bisher haben wir FIR-Systeme nur als Differenzengleichung oder als
z-Übertragungsfunktion kennen gelernt. Um die noch folgende
Implementierung zu ermöglichen ist eine andere Darstellung aber
hilfreicher. Schaut man sich die Differenzengleichung für ein FIR-Filter
genauer an, so erkennt man, dass man 3 verschiedene Bauteile benötigt werden:</p>
<ul class="simple">
<li><p>Addierer</p></li>
<li><p>Multiplizierer</p></li>
<li><p>Einen Verzögerungseinheit, die das Signal um genau ein Sample <span class="math notranslate nohighlight">\(T\)</span>
verzögert. Dies kann durch ein einfaches Speicherelement geschehen.</p></li>
</ul>
<p>Diese 3 Elemente werden im folgenden durch die in <a class="reference internal" href="#fig-blockdiagrammsymbole"><span class="std std-numref">Abbildung 6.7</span></a> gezeigten Symbole beschrieben.</p>
<figure class="align-default" id="fig-blockdiagrammsymbole">
<a class="reference internal image-reference" href="_images/BlockdiagrammSymbole.png"><img alt="_images/BlockdiagrammSymbole.png" src="_images/BlockdiagrammSymbole.png" style="width: 75%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 6.7 </span><span class="caption-text">Symbole zur Darstellung von Filterstrukturen als
Blockdiagramm.</span><a class="headerlink" href="#fig-blockdiagrammsymbole" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Beispielsweise ergibt sich für ein FIR-System erster Ordnung, das durch
<span class="math notranslate nohighlight">\(y(k) = b_0 x(k) + b_1 x(k-1)\)</span> beschrieben ist, das Blockschaltbild in
<a class="reference internal" href="#fig-firersterordnung"><span class="std std-numref">Abbildung 6.8</span></a>).</p>
<figure class="align-default" id="fig-firersterordnung">
<a class="reference internal image-reference" href="_images/FIRErsterOrdnung.png"><img alt="_images/FIRErsterOrdnung.png" src="_images/FIRErsterOrdnung.png" style="width: 30%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 6.8 </span><span class="caption-text">Blockdiagramm eines FIR-Filters 1.
Ordnung</span><a class="headerlink" href="#fig-firersterordnung" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Zur Realisierung eines allgemeinen FIR-Filters muss das allgemeine
Blockschaltbild genauer betrachtet werden (siehe <a class="reference internal" href="#fig-fir-allgemeinblock"><span class="std std-numref">Abbildung 6.9</span></a>).</p>
<figure class="align-default" id="fig-fir-allgemeinblock">
<a class="reference internal image-reference" href="_images/FIR_allgemeinBlock.png"><img alt="_images/FIR_allgemeinBlock.png" src="_images/FIR_allgemeinBlock.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 6.9 </span><span class="caption-text">Allgemeine FIR-Filter
Struktur.</span><a class="headerlink" href="#fig-fir-allgemeinblock" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Es wird deutlich, dass wir bei <span class="math notranslate nohighlight">\(N\)</span> Koeffizienten <span class="math notranslate nohighlight">\(N-1\)</span> Speicherelemente
benötigen, die die jeweilige Vergangenheit von <span class="math notranslate nohighlight">\(x(k)\)</span> speichern.</p>
<p>Um einen Ausgangswert <span class="math notranslate nohighlight">\(y(k)\)</span> zu berechnen, muss die Summe</p>
<div class="math notranslate nohighlight" id="equation-eq-fir-filter">
<span class="eqno">(6.1)<a class="headerlink" href="#equation-eq-fir-filter" title="Permalink to this equation">#</a></span>\[
    y(k) = \sum_{i = 0}^{N-1} b_i x(k-i)
\]</div>
<p>berechnet werden.
Abschließend wird der Speicher um eine Stelle weiter geschoben.
Gleichung <a class="reference internal" href="#equation-eq-fir-filter">(6.1)</a> ist bereits von der Faltung bekannt. Somit
ist ein FIR-Filter also eine andere Bezeichnung für ein System zur
Faltung.</p>
</section>
</section>
<section id="fir-filter-design">
<h3><span class="section-number">6.2.2. </span>FIR-Filter Design<a class="headerlink" href="#fir-filter-design" title="Permalink to this headline">#</a></h3>
<p>Nachdem die Strukturen zur Realisierung von Filtern bekannt sind, fehlt
noch die Bestimmung der einzelnen Filterkoeffizienten. Es muss also
überlegt werden, wie aus einem bestimmten Entwurf des Filters im
Frequenzbereich, geeignete Koeffizienten im Zeitbereich berechnet werden
können. Dazu betrachten wir zunächst nur die FIR-Filter. Es sind
verschiedene Verfahren bekannt. Die beiden am häufigsten Methoden sollen
im weiteren genauer erläutert werden.</p>
<section id="fenster-methode">
<h4><span class="section-number">6.2.2.1. </span>Fenster-Methode<a class="headerlink" href="#fenster-methode" title="Permalink to this headline">#</a></h4>
<p>Aus dem Abschnitt über Spektren ist uns bekannt, dass wir zu einer
Zeitfolge mit Hilfe der DTFT ein Spektrum berechnen können, dass in
<span class="math notranslate nohighlight">\(2\pi\)</span> periodisch ist. Zu dieser Hintransformation gibt es auch die
korrespondierende Rücktransformation die als</p>
<div class="math notranslate nohighlight" id="equation-fir-idtft-def">
<span class="eqno">(6.2)<a class="headerlink" href="#equation-fir-idtft-def" title="Permalink to this equation">#</a></span>\[
    x(k) = \frac{1}{2\pi}\int_{-\pi}^{\pi} X(e^{j \Omega}) e^{j\Omega k} \text{d}\Omega
\]</div>
<p>definiert ist. Somit ist es natürlich auch möglich zu einem bestimmten
Frequenzentwurf eine zugehörige Zeitfolge zu berechnen. Nehmen wir
beispielsweise an, wir suchen die Koeffizienten, um ein ideales
Tiefpassfilter mit der Grenzfrequenz <span class="math notranslate nohighlight">\(\Omega_\text{g}\)</span> zu realisieren. Die
Definition der Übertragungsfunktion ist somit</p>
<div class="math notranslate nohighlight" id="equation-fir-bsp-tiefpass">
<span class="eqno">(6.3)<a class="headerlink" href="#equation-fir-bsp-tiefpass" title="Permalink to this equation">#</a></span>\[\begin{split}
    H(e^{j \Omega}) = \Bigg\{ \begin{array}{lcc}
1 &amp; für &amp; -\Omega_\text{g} \leq \Omega \leq  \Omega_\text{g}\\
0 &amp; &amp; \Omega_\text{g} &lt; |\Omega| \leq \pi
\end{array}
\end{split}\]</div>
<p>Für die gesuchten Filterkoeffizienten ergibt sich</p>
<div class="math notranslate nohighlight" id="equation-fir-tp-ideal">
<span class="eqno">(6.4)<a class="headerlink" href="#equation-fir-tp-ideal" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{aligned}
    h(k) &amp; = &amp;\frac{1}{2\pi}\int_{-\pi}^{\pi} H(e^{j \Omega}) e^{j\Omega k} \text{d}\Omega\\
         &amp; = &amp;\frac{1}{2\pi}\int_{-\Omega_\text{g}}^{\Omega_\text{g}}e^{j\Omega k} \text{d}\Omega\\
         &amp; = &amp;\frac{\Omega_\text{g}}{\pi} \frac{\sin(\Omega_\text{g} k)}{\Omega_\text{g} k}\end{aligned}
\end{split}\]</div>
<p>Problematisch an diesem Ergebnis ist zum einen, dass sich die gefundene
Koeffizienten unendlich ausdehnen und zum anderen, dass das Filter auch
noch nicht-kausale Anteile enthält. Aus dem ersten Grund muss immer eine
Begrenzung vorgenommen werden. Das heißt die gefundenen Koeffizienten
werden nach einer bestimmten Länge zu beiden Seiten der Zeitachse
gleichmäßig abgeschnitten. Dies führt nicht mehr zum idealen Tiefpass,
sondern zu einer Approximation. Der sich ergebende Fehler kann aus der
Überlegung zur Spektrumsanalyse ersehen werden. Die Begrenzung
entspricht einer Gewichtung der Filterkoeffizienten mit einem
Rechteck-Fenster. Diese Multiplikation führt im Frequenzbereich zu einer
Faltung mit der Übertragungsfunktion des Rechtecks. Für den idealen
Tiefpass hat das zwei Konsequenzen. Erstens ist der Übergang vom
Durchlass- zum Sperrbereich nicht mehr unendlich steil und zweitens
enstehen an der Übergangsstelle Überschwinger. Vergrößert man nun die
Länge des Ausschnitts, so wird der Übergangsbereich schmaller, und die
Überschwinger konzentrieren sich an der Übergangsstelle, aber die Höhe
der Überschwinger bleiben gleich (siehe
<a class="reference internal" href="#fig-gibbspheanomen"><span class="std std-numref">Abbildung 6.10</span></a> ). Dies wird als Gibbs’sches Phänomen
bezeichnet.</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Demoscript for &quot;Signalverarbeitung 1&quot;</span>
<span class="c1">#</span>
<span class="c1"># Version: 1.0   18.02.2022</span>
<span class="c1"># </span>
<span class="c1"># This software is released as public domain under CC0 1.0</span>
<span class="c1"># https://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="c1">#-------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>

<span class="c1"># determine where we&#39;re running from and set paths accordingly</span>
<span class="k">try</span><span class="p">:</span> 
    <span class="k">if</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ZMQInteractiveShell&#39;</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;../../&#39;</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">sv.mplstyle&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_si</span><span class="p">,</span> <span class="n">ax_spec</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="n">samples</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">201</span><span class="p">)</span>
<span class="n">si</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
<span class="n">mid</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>

<span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">f0</span> <span class="o">=</span> <span class="mi">100</span>

<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">si</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f0</span> <span class="o">*</span> <span class="n">samples</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">samples</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">*</span><span class="n">f0</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># si(0) = 1 to avoid division by zero</span>
        <span class="n">si</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># cut si-function</span>
<span class="n">si_short</span> <span class="o">=</span> <span class="n">si</span><span class="p">[(</span><span class="n">mid</span><span class="o">-</span><span class="mi">25</span><span class="p">):(</span><span class="n">mid</span><span class="o">+</span><span class="mi">25</span><span class="p">)]</span>
<span class="n">samples_short</span> <span class="o">=</span> <span class="n">samples</span><span class="p">[(</span><span class="n">mid</span><span class="o">-</span><span class="mi">25</span><span class="p">):(</span><span class="n">mid</span><span class="o">+</span><span class="mi">25</span><span class="p">)]</span>

<span class="c1">#ax_si = pyplot.subplot(1, 2, 1)</span>
<span class="n">ax_si</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">si</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">)</span>
<span class="n">ax_si</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">samples_short</span><span class="p">,</span> <span class="n">si_short</span><span class="p">)</span>
<span class="n">ax_si</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenkindex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x(k)&#39;</span><span class="p">,</span> 
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;SI-Funktion&#39;</span><span class="p">)</span>
<span class="n">ax_si</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>

<span class="c1"># zero padding, for display resolution</span>
<span class="n">si_short</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span> <span class="o">+</span> <span class="n">si_short</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span>
<span class="n">si</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span> <span class="o">+</span> <span class="n">si</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span>

<span class="n">spectrum_short</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">si_short</span><span class="p">)</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">si</span><span class="p">)</span>

<span class="n">w</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">si</span><span class="p">))</span>
<span class="n">w_short</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">si_short</span><span class="p">))</span>

<span class="c1">#ax_spec = pyplot.subplot(1, 2, 2)</span>
<span class="n">ax_spec</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_short</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">spectrum_short</span><span class="p">)),</span> 
        <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">)</span>
<span class="n">ax_spec</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)))</span> <span class="c1"># dB spectrum</span>
<span class="n">ax_spec</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz normalisiert mit w/pi&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude in dB&#39;</span><span class="p">,</span> 
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Spektrum&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]))</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># glue this figure to paste it later (no effect outside of MyST NB)</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;GippsPheanomen&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="fig-gibbspheanomen" style="width: 100%">
<div class="cell_output docutils container">
<img alt="_images/filter_22_1.png" src="_images/filter_22_1.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 6.10 </span><span class="caption-text">Veranschaulichung des
Gibbs’schen Phänomens am Beispiel eines Tiefpassfilters.</span><a class="headerlink" href="#fig-gibbspheanomen" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Die Ursache hierfür ist in der Übertragungsfunktion des Rechteckfensters
zu suchen. Betrachtet man diese Funktion für die beiden betrachteten
Längen, so erkennt man die Konzenzentration der Überschwinger bei der
Frequenz Null. Die Höhe der Überschwinger bleibt aber identisch. Genau
dieses Verhalten wird durch die Faltung im Frequenzbereich auf die
Übertragungsfunktion des idealen Tiefpasses aufgeprägt. Man kann aber
zeigen, dass die Approximation im Sinne des kleinsten
Fehlerquadrates <em>Minimum Mean Square Error (MMSE)</em> über alle Frequenzen
optimal ist <span id="id1">[<a class="reference internal" href="zbibliography.html#id3" title="K. D. Kammeyer and K. Kroschel. Digitale Signalverarbeitung: Filterung und Spektralanalyse. Teubner, Stuttgart, 3. edition, 1998.">KK98</a>]</span>.</p>
<p>Um die nicht-kausalen Anteile zu beseitigen ist zusätzlich noch eine
zeitliche Verschiebung der gefundenen Filterkoeffizienten notwendig.
Diese Verschiebung führt dann, wie man durch den Verschiebungssatz der
Fourier-Transformation sieht, zu einer linearen Phase des entworfenen
Tiefpasses.</p>
<p>Zur Vermeidung der Überschwinger (<em>Ripple</em>) können nun dieselben Techniken
verwendet werden, die auch die Spektralanalyse verbessert haben. Eine
Nutzung der dort vorgestellten Fensterfunktionen führt auf eine
geringere Ausprägung der Ripple, wobei gleichzeitig der Übergangsbereich
zwischen Durchgangs- und Sperrbereich zunimmt. Um das zu
veranschaulichen, ist in <a class="reference internal" href="#fig-bspfensterentwurf1"><span class="std std-numref">Abbildung 6.11</span></a>
der Entwurf eines Filters mit unterschiedlichen Fensterfunktionen gezeigt.
Man erkennt deutlich, dass mit zunehmendem Übergangsbereich die Überschwinger
abnehmen, wobei diese bei Nutzung der Fensterfunktionen nur noch im
Sperrbereich deutlich zu erkennen sind.</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Demoscript for &quot;Signalverarbeitung 1&quot;</span>
<span class="c1">#</span>
<span class="c1"># Version: 1.0   18.02.2022</span>
<span class="c1"># </span>
<span class="c1"># This software is released as public domain under CC0 1.0</span>
<span class="c1"># https://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="c1">#-------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>

<span class="c1"># determine where we&#39;re running from and set paths accordingly</span>
<span class="k">try</span><span class="p">:</span> 
    <span class="k">if</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ZMQInteractiveShell&#39;</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;../../&#39;</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">sv.mplstyle&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_51</span><span class="p">,</span> <span class="n">ax_201</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">eps</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span> <span class="c1"># for slight offset to avoid division by 0</span>
<span class="n">f_s</span> <span class="o">=</span> <span class="mi">48000</span> 
<span class="n">f_g</span> <span class="o">=</span> <span class="mi">4800</span> <span class="c1"># Hz, cuttoff frequency</span>

<span class="n">trans_width</span> <span class="o">=</span> <span class="mi">1200</span>  <span class="c1"># Hz, Width of transition from pass band to stop band</span>

<span class="c1"># filter length 51</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">51</span>      <span class="c1"># Size of the FIR filter.</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="o">-</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">N</span><span class="p">)</span>

<span class="c1"># Remez filter design</span>
<span class="n">taps</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">remez</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">f_g</span><span class="p">,</span> <span class="n">f_g</span> <span class="o">+</span> <span class="n">trans_width</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">f_s</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Hz</span><span class="o">=</span><span class="n">f_s</span><span class="p">)</span>
<span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">taps</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">worN</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span>

<span class="c1"># Von Hann filter design</span>
<span class="n">w_rad</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f_g</span><span class="o">/</span><span class="n">f_s</span> <span class="c1"># cutoff freq in rang od 0 -&gt; 2*pi</span>
<span class="c1"># designing the filter</span>
<span class="n">rect_window_51</span> <span class="o">=</span> <span class="n">w_rad</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">w_rad</span><span class="o">*</span><span class="n">idxs</span><span class="o">+</span><span class="n">eps</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">w_rad</span><span class="o">*</span><span class="n">idxs</span><span class="o">+</span><span class="n">eps</span><span class="p">)</span>
<span class="n">von_hann_window</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">N</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">von_hann_window</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">idx</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>
<span class="n">window_51</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rect_window_51</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">von_hann_window</span><span class="p">)</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">window_51</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">)))</span>
<span class="n">mid</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># shift area from pi -&gt; 2pi to -pi -&gt; 0</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">spectrum</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">):],</span> <span class="n">spectrum</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">)]])</span> 
<span class="c1"># dB maximum = 0dB</span>
<span class="n">spectrum_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> 
<span class="n">freqs_fft</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_abs</span><span class="p">))</span> <span class="c1"># freq bins, for plotting</span>

<span class="n">ax_51</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)))</span>
<span class="n">ax_51</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_fft</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax_51</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in rad/s&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Pegel in dB&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span> 
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Filterlänge 51&#39;</span><span class="p">)</span>

<span class="c1"># filter length 201</span>
<span class="c1"># -----------------</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">201</span>     <span class="c1"># Size of the FIR filter.</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="o">-</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">N</span><span class="p">)</span>

<span class="n">taps</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">remez</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">f_g</span><span class="p">,</span> <span class="n">f_g</span> <span class="o">+</span> <span class="n">trans_width</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">f_s</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Hz</span><span class="o">=</span><span class="n">f_s</span><span class="p">)</span>
<span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">taps</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">worN</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span>
<span class="c1"># Von Hann</span>
<span class="n">w_rad</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f_g</span><span class="o">/</span><span class="n">f_s</span> <span class="c1"># cutoff freq in rang od 0 -&gt; 2*p</span>
<span class="c1"># designing the filter</span>
<span class="n">rect_window_51</span> <span class="o">=</span> <span class="n">w_rad</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">w_rad</span><span class="o">*</span><span class="n">idxs</span><span class="o">+</span><span class="n">eps</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">w_rad</span><span class="o">*</span><span class="n">idxs</span><span class="o">+</span><span class="n">eps</span><span class="p">)</span>
<span class="n">von_hann_window</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">N</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">von_hann_window</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">idx</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>
<span class="n">window_201</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rect_window_51</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">von_hann_window</span><span class="p">)</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">window_201</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">)))</span>
<span class="n">mid</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># shift area from pi -&gt; 2pi to -pi -&gt; 0</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">spectrum</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">):],</span> <span class="n">spectrum</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">)]])</span> 
<span class="c1"># dB maximum = 0dB</span>
<span class="n">spectrum_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> 
<span class="n">freqs_fft</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_abs</span><span class="p">))</span> <span class="c1"># freq bins, for plotting</span>


<span class="n">ax_201</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)))</span>
<span class="n">ax_201</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_fft</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax_201</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in rad/s&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Pegel in dB&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span> 
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Filterlänge 201&#39;</span><span class="p">)</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># glue this figure to paste it later (no effect outside of MyST NB)</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;BspFensterEntwurf&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="fig-bspfensterentwurf1" style="width: 100%">
<div class="cell_output docutils container">
<img alt="_images/filter_25_1.png" src="_images/filter_25_1.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 6.11 </span><span class="caption-text">Beispiel eines Tiefpass-Entwurfes mit
Rechteck und Hann-Fenster unterschiedlicher
Länge. <span class="math notranslate nohighlight">\(f_\text{g} = \Omega_\text{g} = 0{,}2\pi\)</span>.</span><a class="headerlink" href="#fig-bspfensterentwurf1" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="parks-mcclellan">
<h4><span class="section-number">6.2.2.2. </span>Parks-McClellan<a class="headerlink" href="#parks-mcclellan" title="Permalink to this headline">#</a></h4>
<p>Im letzten Abschnitt wurde eine optimale Lösung vorgestellt, die den
mittleren Fehler über das Gesamtspektrum minimiert. Dabei hat sich aber
der Fehler an der Übergangsstelle konzentriert. Eine weitere optimale
Lösung ist, den Fehler über alle Frequenzen gleich zu verteilen. Die
verbleibende Fehlergröße ist dabei nur von der gewählten Ordnung des
Filters abhängig. Zur Lösung dieses Problems wurde von Parks und
McClellan der sog. Remez-Algorithmus entwickelt, der zur optimalen
Lösung konvergiert. Der Restfehler ist dabei minimal für alle
Frequenzen. Diese Minimierung des maximalen Fehlers wird auch als
Tschebyscheff-Lösung bezeichnet.</p>
<p>Um die Lösung zu verdeutlichen und die Unterschiede zur Fenster-Methode
heraus zu arbeiten, ist in <a class="reference internal" href="#fig-bspfensterremez"><span class="std std-numref">Abbildung 6.13</span></a><br />
ein Entwurf eines Tiefpass-Filters
mittels Remez-Entwurfsverfahren und mittels Fenster-Entwurfs mit
Hann-Fenster gegenüber gestellt. Wir erkennen, dass bei gleicher Ordnung
das Remez-Verfahren eine insgesamt bessere Sperrdämpfung aufweist.
Dies bedeutet im Umkehrschluss, dass bei einer im Entwurf
spezifizierten Sperrdämpfung die Ordnung des resultierenden Filters beim
Remez-Verfahren deutlich kleiner ist. Für die konkrete Realisierung
bedeutet dies eine deutliche Aufwandsreduktion.</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Demoscript for &quot;Signalverarbeitung 1&quot;</span>
<span class="c1">#</span>
<span class="c1"># Version: 1.0   18.02.2022</span>
<span class="c1"># </span>
<span class="c1"># This software is released as public domain under CC0 1.0</span>
<span class="c1"># https://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="c1">#-------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>

<span class="c1"># determine where we&#39;re running from and set paths accordingly</span>
<span class="k">try</span><span class="p">:</span> 
    <span class="k">if</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ZMQInteractiveShell&#39;</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;../../&#39;</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">sv.mplstyle&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_51</span><span class="p">,</span> <span class="n">ax_201</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">eps</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span> <span class="c1"># for slight offset to avoid division by 0</span>
<span class="n">f_s</span> <span class="o">=</span> <span class="mi">48000</span>
<span class="n">f_g</span> <span class="o">=</span> <span class="mi">4800</span> <span class="c1"># cutoff frequency</span>


<span class="n">trans_width</span> <span class="o">=</span> <span class="mi">1200</span>  <span class="c1"># Hz, Width of transition from pass band to stop band</span>

<span class="c1"># filter length 51</span>
<span class="c1"># ----------------</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">51</span> <span class="c1"># Size of the FIR filter.</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="o">-</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">N</span><span class="p">)</span>

<span class="c1"># Remez filter design</span>
<span class="n">taps</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">remez</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">f_g</span><span class="p">,</span> <span class="n">f_g</span> <span class="o">+</span> <span class="n">trans_width</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">f_s</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Hz</span><span class="o">=</span><span class="n">f_s</span><span class="p">)</span>
<span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">taps</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">worN</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span>

<span class="c1"># boxcar window filter design</span>
<span class="n">w_rad</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f_g</span><span class="o">/</span><span class="n">f_s</span> <span class="c1"># cutoff freq in rang od 0 -&gt; 2*pi</span>
<span class="c1"># designing the filter</span>
<span class="n">rect_window_51</span> <span class="o">=</span> <span class="n">w_rad</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">w_rad</span><span class="o">*</span><span class="n">idxs</span><span class="o">+</span><span class="n">eps</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">w_rad</span><span class="o">*</span><span class="n">idxs</span><span class="o">+</span><span class="n">eps</span><span class="p">)</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">rect_window_51</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<span class="n">mid</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># shift area from pi -&gt; 2pi to -pi -&gt; 0</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">spectrum</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">):],</span> <span class="n">spectrum</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">)]])</span> 
<span class="c1"># dB maximum = 0dB</span>
<span class="n">spectrum_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> 
<span class="n">freqs_fft</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_abs</span><span class="p">))</span> <span class="c1"># freq bins, for plotting</span>

<span class="n">ax_51</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)))</span>
<span class="n">ax_51</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_fft</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax_51</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in rad/s&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Pegel in dB&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span> 
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Filterlänge 51&#39;</span><span class="p">)</span>

<span class="c1"># filter length 201</span>
<span class="c1"># -----------------</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">201</span> <span class="c1"># Size of the FIR filter</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="o">-</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">N</span><span class="p">)</span>

<span class="c1"># Remez filter design</span>
<span class="n">taps</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">remez</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">f_g</span><span class="p">,</span> <span class="n">f_g</span> <span class="o">+</span> <span class="n">trans_width</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">f_s</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Hz</span><span class="o">=</span><span class="n">f_s</span><span class="p">)</span>
<span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">taps</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">worN</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span>

<span class="c1"># boxcar window filter design</span>
<span class="n">w_rad</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f_g</span><span class="o">/</span><span class="n">f_s</span> <span class="c1"># cutoff freq in rang od 0 -&gt; 2*pi</span>
<span class="c1"># designing the filter</span>
<span class="n">rect_window_201</span> <span class="o">=</span> <span class="n">w_rad</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">w_rad</span><span class="o">*</span><span class="n">idxs</span><span class="o">+</span><span class="n">eps</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">w_rad</span><span class="o">*</span><span class="n">idxs</span><span class="o">+</span><span class="n">eps</span><span class="p">)</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">rect_window_201</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">)))</span>
<span class="n">mid</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># shift area from pi -&gt; 2pi to -pi -&gt; 0</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">spectrum</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">):],</span> <span class="n">spectrum</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">)]])</span> 
<span class="c1"># dB maximum = 0dB</span>
<span class="n">spectrum_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> 
<span class="n">freqs_fft</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_abs</span><span class="p">))</span> <span class="c1"># freq bins, for plotting</span>


<span class="n">ax_201</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)))</span>
<span class="n">ax_201</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_fft</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax_201</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in rad/s&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Pegel in dB&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span> 
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Filterlänge 201&#39;</span><span class="p">)</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># glue this figure to paste it later (no effect outside of MyST NB)</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;BspFensterRemez&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="5913fcbe-ced7-4ab2-8d46-58e195eeb7de" name="182a5926-fccf-4a84-82ed-2184b34e7b79" type="radio">
</input><label class="sd-tab-label" for="5913fcbe-ced7-4ab2-8d46-58e195eeb7de">
Entwurf</label><div class="sd-tab-content docutils">
<p>Fenster Entwurf</p>
<figure class="align-default" id="fig-bspfensterentwurf2" style="width: 100%">
<div class="cell_output docutils container">
<img alt="_images/filter_25_1.png" src="_images/filter_25_1.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 6.12 </span><span class="caption-text">Beispiel eines Tiefpass-Entwurfes mit
Rechteck und Hann-Fenster unterschiedlicher Länge.
<span class="math notranslate nohighlight">\(f_\text{g} = \Omega_\text{g} = 0{,}2\pi\)</span>.</span><a class="headerlink" href="#fig-bspfensterentwurf2" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="e4999a9a-4f07-4208-bfb5-004770f1f11d" name="182a5926-fccf-4a84-82ed-2184b34e7b79" type="radio">
</input><label class="sd-tab-label" for="e4999a9a-4f07-4208-bfb5-004770f1f11d">
Remez</label><div class="sd-tab-content docutils">
<p>Remez Fenster</p>
<figure class="align-default" id="fig-bspfensterremez" style="width: 100%">
<div class="cell_output docutils container">
<img alt="_images/filter_28_1.png" src="_images/filter_28_1.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 6.13 </span><span class="caption-text">Beispiel eines Tiefpass-Entwurfes mit dem
Remez-Algorithmus und der Fenster-Methode unterschiedlicher Länge.
<span class="math notranslate nohighlight">\(f_\text{g} = \Omega_\text{g} = 0{,}2\pi\)</span>.</span><a class="headerlink" href="#fig-bspfensterremez" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<div class="error admonition">
<p class="admonition-title">To Do</p>
<p>Aufzeigen der Fenstermethode für allgemeine Übertragungsfunktionen, Design im Frequenzbereich, IFFT und dann Ausschneiden, je nach Ordnung</p>
</div>
</section>
<section id="linearphasige-filter">
<h4><span class="section-number">6.2.2.3. </span>Linearphasige Filter<a class="headerlink" href="#linearphasige-filter" title="Permalink to this headline">#</a></h4>
<p>Linearphasigkeit ist eine interessante Eigenschaft in der
Nachrichtentechnik, da mit Ihrer Hilfe ein Signal gefiltert werden kann,
ohne weitere Phasenverzerrungen einzuführen. Weiterhin führt die
Linearphasigkeit dazu, dass alle Frequenzanteile des Signals um einen
konstanten Betrag verzögert werden. Diese Verzögerung wird als
Gruppenlaufzeit bezeichnet und ist über</p>
<div class="math notranslate nohighlight" id="equation-eq-def-gruppenlaufzeit">
<span class="eqno">(6.5)<a class="headerlink" href="#equation-eq-def-gruppenlaufzeit" title="Permalink to this equation">#</a></span>\[
    \tau_\text{g}(e^{(j \Omega)}) = - \frac{\delta \arg\{H(e^{(j \Omega)})\}}{\delta \Omega}
\]</div>
<p>als Ableitung der Phase zur Frequenz definiert.</p>
<p>Wir haben bereits für das einfache Filter mit der Impulsantwort
<span class="math notranslate nohighlight">\(h(k) = [1\:\: 1]\)</span> festgestellt, dass es sich um einen Tiefpass mit
linearer Phase handelt. Diese Eigenschaft beruht drauf, dass die
Nullstellen dieses FIR-Systems nur auf dem Einheitskreis liegen.
Zusätzlich sind aber auch alle Systeme linearphasig die am Einheitskreis
gespiegelte Nullstellen aufweisen. Es muss also gelten, dass zu jeder
Nullstelle <span class="math notranslate nohighlight">\(z_i\)</span> die nicht auf dem Einheitskreis liegt eine weitere
Nullstelle mit <span class="math notranslate nohighlight">\(z_{\ell} = 1/z_i\)</span> existiert.</p>
<p>Diese Symmetrie in der Pol-Nullstellenebene führt zu bestimmten
Eigenschaften bei den Koeffizienten. Man kann zeigen, dass 4
verschiedene Möglichkeiten existieren, linearphasige FIR-Filter zu
realisieren <span id="id2">[<a class="reference internal" href="zbibliography.html#id3" title="K. D. Kammeyer and K. Kroschel. Digitale Signalverarbeitung: Filterung und Spektralanalyse. Teubner, Stuttgart, 3. edition, 1998.">KK98</a>]</span>. Diese unterscheiden sich darin, ob die Ordnung
gerade oder ungerade ist und ob die Koeffizienten zur Mitte des Filters
achsen- oder punktsymmetrisch sind. Daraus ergeben sich folgende
Abhängigkeiten:</p>
<figure class="align-default" id="fig-linphasetypen">
<a class="reference internal image-reference" href="_images/LinPhaseTypen.png"><img alt="_images/LinPhaseTypen.png" src="_images/LinPhaseTypen.png" style="width: 100%;" /></a>
</figure>
<p>Aus diesen vier Symmetrieanordnungen resultieren einige Eigenschaften
für die Übertragungsfunktion. Nur mit einem Filter Typ I lassen sich
alle Grundfiltercharakteristika erzeugen. Bei den anderen Typen ergeben
sich feste Werte für bestimmte Punkte der Übertragungsfunktion. So ist
für den Typ II immer eine Nullstelle bei <span class="math notranslate nohighlight">\(\Omega = 0\)</span> und
<span class="math notranslate nohighlight">\(\Omega = \pi\)</span>, während der Typ III immer eine Nullstelle bei
<span class="math notranslate nohighlight">\(\Omega = \pm \pi\)</span> besitzt. Typ IV dagegen hat immer eine Nullstelle bei
<span class="math notranslate nohighlight">\(\Omega = 0\)</span></p>
<p>Dies hat natürlich Konsequenzen für den Entwurf von linearphasigen
FIR-Filtern. So sollte man nie versuchen einen Hochpass zu entwerfen und
gleichzeitig Typ II oder Typ III verwenden wollen. Das heißt, man sollte
darauf achten, ob das gewünschte Filterverhalten, auch mit dem
Entwurfsvorgaben zusammen passen.</p>
</section>
<section id="minimalphasige-fir-filter">
<h4><span class="section-number">6.2.2.4. </span>Minimalphasige FIR-Filter<a class="headerlink" href="#minimalphasige-fir-filter" title="Permalink to this headline">#</a></h4>
<p>Eine weitere besondere Klasse an FIR-Filtern sind sogenannte
minimalphasige Filter. Das heisst, dieses Filter realisiert eine
bestimmte Betragsübertragungsfunktion mit der minimalen Phase.<br />
Es zeigt sich dass sich dieser Filtertyp genau dann ergibt, wenn alle Nullstellen
innerhalb der Einheitskreises liegen. Eine Realisierung ist also entweder
über ein Berechnen aller Nullstellen und deren Spiegelung am
Einheitskreis möglich, da sich so nur die Phase aber nicht das
Betragsverhalten ändert. Die Zerlegung von Filtern sehr hoher
Ordnung ist numerisch aufwändig und durch mögliche
Rundungsfehler nicht immer stabil.</p>
<p>Eine andere Methode nutzt die besondere Eigenschaft
minimalphasiger Filter, dass es eine direkte Verknüpfung zwischen dem
Betrag und der Phase gibt. Hierzu wird die sog. Hilbert-Transformation
verwendet, die aber erst in einem späteren Abschnitt intensiver
eingeführt wird. An dieser Stelle soll ein Vorstellen des Designalgorithmus
genügen, um eine beliebige Betragsübertragungsfunktion
(meist linearphasig, siehe Entwurfsmethoden) in einen minimalphasigen
Entwurf zu überführen.</p>
<p>Gehen wir davon aus, dass die Betragsübertragungsfunktion <span class="math notranslate nohighlight">\(|H(e^{(j \Omega)})|\)</span> bekannt ist.
Eine Logarithmierung dieses Spektrums ist möglich, so lange keine echte Nullstelle vorhanden
ist, dies kann durch eine untere Schwelle gewährleistet werden. Dieses
neue logarithmierte Spektrum wird mit Hilfe einer
IDFT in den Zeitbereich transformiert. Da es sich um eine reelle gerade Funktion handelt,
ergibt sich auch wieder eine reelle gerade Funktion. Diese
Zeitbereichslösung wird nun so verändert, dass alle negativen Zeiten
(oder positive Zeiten oberhalb von N/2, durch die Zirkulareigenschaft
der DFT ist das gleichwertig) zu Null gesetzt und alle anderen
Werte mit zwei multipliziert werden. Diese neue Funktion wird nun mit
der FFT erneut in den Frequenzbereich transformiert. Um die
Logarithmierung rückgängig zu machen wird für jeden Frequenzpunkt die
Exponenten-Funktion angewendet. Eine erneute IFFT der resultierenden
Funktion führt auf die Filterkoeffizienten, die das minimalphasige
Filter repräsentieren. <a class="reference internal" href="#fig-minphasenbsp"><span class="std std-numref">Abbildung 6.14</span></a>  zeigt die Ergebnisse für einen
einfaches Filter achter Ordnung bei vorgegebenem
Betragsübertragungsverhalten.</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Demoscript for &quot;Signalverarbeitung 1&quot;</span>
<span class="c1">#</span>
<span class="c1"># Version: 1.0   18.02.2022</span>
<span class="c1"># </span>
<span class="c1"># This software is released as public domain under CC0 1.0</span>
<span class="c1"># https://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="c1">#-------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>

<span class="c1"># determine where we&#39;re running from and set paths accordingly</span>
<span class="k">try</span><span class="p">:</span> 
    <span class="k">if</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ZMQInteractiveShell&#39;</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;../../&#39;</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">sv.mplstyle&#39;</span><span class="p">)</span>

<span class="n">eps</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span> <span class="c1"># for slight offset to avoid division by 0</span>

<span class="c1"># create exemplary non-recursive filter coefficients (mirrored at unit circle)</span>
<span class="n">b1</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.98</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span>
<span class="n">b2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">0.98</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">poly</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">)))</span>
<span class="n">h</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="n">W</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">4</span><span class="o">*</span><span class="mi">1024</span><span class="p">,</span> <span class="n">whole</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">((</span><span class="n">ax_H</span><span class="p">,</span> <span class="n">ax_void</span><span class="p">),</span> <span class="p">(</span><span class="n">ax_lin_zeit</span><span class="p">,</span> <span class="n">ax_min_zeit</span><span class="p">),</span> 
        <span class="p">(</span><span class="n">ax_lin_phase</span><span class="p">,</span> <span class="n">ax_min_phase</span><span class="p">))</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># create a linear phase filter from the exististing impulse response</span>
<span class="n">log_H</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span><span class="o">+</span><span class="n">eps</span><span class="p">)</span>
<span class="n">h_c</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">log_H</span><span class="p">)</span><span class="o">.</span><span class="n">real</span>
<span class="n">h_c</span><span class="p">[</span><span class="mi">1</span> <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h_c</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span> <span class="o">*=</span> <span class="mi">2</span>
<span class="n">h_c</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h_c</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span> <span class="p">:</span> <span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> 
<span class="n">H_min_log</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">h_c</span><span class="p">)</span>
<span class="n">H_min</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">H_min_log</span><span class="p">)</span>
<span class="n">h_min</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">H_min</span><span class="p">)</span>
<span class="n">h_min</span> <span class="o">=</span> <span class="n">h_min</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>

<span class="n">ax_H</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span><span class="o">+</span><span class="n">eps</span><span class="p">))</span>
<span class="n">ax_lin_zeit</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax_min_zeit</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">h_min</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax_lin_phase</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">H</span><span class="p">)))</span>
<span class="n">ax_min_phase</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">H_min</span><span class="p">)))</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># glue this figure to paste it later (no effect outside of MyST NB)</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;MinPhasenBsp&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="fig-minphasenbsp" style="width: 100%">
<div class="cell_output docutils container">
<img alt="_images/filter_33_2.png" src="_images/filter_33_2.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 6.14 </span><span class="caption-text">Entwurf eines Filters mit gegebener
Betragsübertragungsfunktion. a) als linearphasiges Filter und b) als
minimalphasiges
Filter.</span><a class="headerlink" href="#fig-minphasenbsp" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Eine mögliche Matlab- bzw. Python-Implementierung sieht folgendermaßen aus:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="ec487228-7de8-45c5-a4a0-64f17c0ee343" name="aedde17c-ad20-4977-877c-ee36d2ab424e" type="radio">
</input><label class="sd-tab-label" for="ec487228-7de8-45c5-a4a0-64f17c0ee343">
Matlab</label><div class="sd-tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c">%v_H contains the magnitude vector of the desired filter</span><span class="w"></span>
<span class="w">    </span><span class="n">log_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">log</span><span class="p">(</span><span class="n">v_H</span><span class="o">+</span><span class="nb">eps</span><span class="p">);</span><span class="w"> </span><span class="c">% eps is the smallest positive number in matlab</span><span class="w"></span>
<span class="w">                          </span><span class="c">% prevents log of zero</span><span class="w"></span>
<span class="w">    </span><span class="n">h_ceps</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">real</span><span class="p">(</span><span class="nb">ifft</span><span class="p">(</span><span class="n">log_H</span><span class="p">));</span><span class="w"> </span><span class="c">% real for removing quantization error</span><span class="w"></span>
<span class="w">    </span><span class="n">h_ceps</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">h_ceps</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">h_ceps</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">h_ceps</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">h_ceps</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">h_ceps</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="k">end</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c">% Setting to zero</span><span class="w"></span>
<span class="w">    </span><span class="n">H_min_log</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">fft</span><span class="p">(</span><span class="n">h_ceps</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">H_min</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">exp</span><span class="p">(</span><span class="n">H_min_log</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">v_h</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">real</span><span class="p">(</span><span class="nb">ifft</span><span class="p">(</span><span class="n">H_min</span><span class="p">));</span><span class="w"></span>
</pre></div>
</div>
</div>
<input id="b86d94f4-3ddc-41b1-8409-68f02db16515" name="aedde17c-ad20-4977-877c-ee36d2ab424e" type="radio">
</input><label class="sd-tab-label" for="b86d94f4-3ddc-41b1-8409-68f02db16515">
Python</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="kn">import</span> <span class="nn">numpy</span>
    <span class="c1">#v_H contains the magnitude vector of the desired filter</span>
    
    <span class="n">eps</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span> <span class="c1"># eps is the smallest positive in python </span>
    <span class="n">log_H</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span><span class="o">+</span><span class="n">eps</span><span class="p">)</span> <span class="c1"># eps prevents log of zero</span>
    <span class="n">h_c</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">log_H</span><span class="p">)</span><span class="o">.</span><span class="n">real</span> <span class="c1"># real for removing quantization error</span>
    <span class="n">h_c</span><span class="p">[</span><span class="mi">1</span> <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h_c</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span> <span class="o">*=</span> <span class="mi">2</span>
    <span class="n">h_c</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h_c</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span> <span class="p">:</span> <span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># Setting to zero</span>
    <span class="n">H_min_log</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">h_c</span><span class="p">)</span>
    <span class="n">H_min</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">H_min_log</span><span class="p">)</span>
    <span class="n">h_min</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">H_min</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="iir-filter">
<h3><span class="section-number">6.2.3. </span>IIR-Filter<a class="headerlink" href="#iir-filter" title="Permalink to this headline">#</a></h3>
<p>Im Gegensatz zu den FIR-Filtern haben IIR-Filter auch rekursive Anteile.
Die Implementierung ist durch das Stabilitätsproblem sehr viel
schwieriger. Gleichzeitig können sehr unterschiedliche Strukturen
verwendet werden, die alle unterschiedliche Eigenschaften haben.</p>
<section id="id3">
<h4><span class="section-number">6.2.3.1. </span>Beschreibung als Blockdiagramm<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h4>
<p>Die Grundform des Blockdiagramms eines IIR-Filters ist in <a class="reference internal" href="#fig-iir-allgemeinblock"><span class="std std-numref">Abbildung 6.15</span></a>  gezeigt.</p>
<figure class="align-default" id="fig-iir-allgemeinblock">
<a class="reference internal image-reference" href="_images/IIR_allgemeinBlock.png"><img alt="_images/IIR_allgemeinBlock.png" src="_images/IIR_allgemeinBlock.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 6.15 </span><span class="caption-text">IIR-Filter Struktur in Direkt Form I.</span><a class="headerlink" href="#fig-iir-allgemeinblock" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Diese sehr grundlegende Struktur, die die Differenzengleichung
geradlinig umsetzt wird als Direkt Form I bezeichnet. Sie ist einfach gängigen Programmiersprachen
umzusetzen. Problematisch ist aber, dass bei einer
höheren Ordnung <span class="math notranslate nohighlight">\(N&gt;8\)</span> numerische Probleme auftreten, da bei vielen
Filterentwürfen Filterkoeffizienten herauskommen, die im Zahlenbereich
weit auseinander liegen und schlecht gleichzeitig in einem quantisierten
Datenformat repräsentiert werden können.</p>
<p>Um dies zu vermeiden, wird im allgemeinen eine Zerlegung von Filtern
höherer Ordnung in Filter 2. Ordnung vorgenommen. Diese werden dann
<em>Second Order Sections</em> oder <em>Biquads</em> genannt. Eine kaskadierte
Schaltung führt dann abschließend wieder zum Originaldesign, ohne die
numerischen Schwierigkeiten zu beinhalten (siehe <a class="reference internal" href="#fig-iir-sos-zrlegung"><span class="std std-numref">Abbildung 6.16</span></a>).</p>
<figure class="align-default" id="fig-iir-sos-zrlegung">
<a class="reference internal image-reference" href="_images/IIR_SOS_Zrlegung.png"><img alt="_images/IIR_SOS_Zrlegung.png" src="_images/IIR_SOS_Zrlegung.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 6.16 </span><span class="caption-text">Beispiel einer SOS-Zerlegung eines IIR-Filters
6.Ordnung.</span><a class="headerlink" href="#fig-iir-sos-zrlegung" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Mathematisch lässt sich die Zerlegung folgendermaßen darstellen:</p>
<div class="math notranslate nohighlight" id="equation-eq-sos-zerlegung">
<span class="eqno">(6.6)<a class="headerlink" href="#equation-eq-sos-zerlegung" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{aligned}
    H(z) &amp;=&amp; \frac{b_0 + b_1 z^{-1} +  b_2 z^{-2} + \cdots +  b_{N-1} z^{-(N-1)}}
                  {1 + a_1 z^{-1} +  a_2 z^{-2} + \cdots +  a_{N-1} z^{-(N-1)}} \\
         &amp; = &amp; \frac{b_{0_1} + b_{1_1} z^{-1} +  b_{2_1} z^{-2} }{1 + a_{1_1} z^{-1} + a_{2_1} z^{-2}}
         \frac{b_{0_2} + b_{1_2} z^{-1} +  b_{2_2} z^{-2} }{1 + a_{1_2} z^{-1} + a_{2_2} z^{-2}}  \cdots
         \frac{b_{0_N} + b_{1_N} z^{-1} +  b_{2_N} z^{-2} }{1 + a_{1_N} z^{-1} + a_{2_N} z^{-2}}\end{aligned}
\end{split}\]</div>
<p>Die Zusammenführung zweier Pole und Nullstellen sollte dabei immer so
erfolgen, dass die Pole und Nullstellen möglichst dicht beieinander
liegen (siehe <a class="reference internal" href="#fig-zp2sos"><span class="std std-numref">Abbildung 6.17</span></a> ).</p>
<figure class="align-default" id="fig-zp2sos">
<a class="reference internal image-reference" href="_images/Zp2sos.png"><img alt="_images/Zp2sos.png" src="_images/Zp2sos.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 6.17 </span><span class="caption-text">Pol-Nullstellenzuordnung eines Filters
6.Ordnung zu drei Second Order
Sections.</span><a class="headerlink" href="#fig-zp2sos" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="filterstrukturen-fur-sos">
<h4><span class="section-number">6.2.3.2. </span>Filterstrukturen für SOS<a class="headerlink" href="#filterstrukturen-fur-sos" title="Permalink to this headline">#</a></h4>
<p>Die Direkt Form I ist nicht die einzige Möglichkeit ein IIR-Filter zu
realisieren. Um die anderen Strukturen zu verdeutlichen, konzentrieren
wir uns auf die wichtigen SOS-Filter. Eine wichtige Anforderung an
Realisierungen spielen die Anzahl der Multiplikationen und die Anzahl
der benötigten Speicherplätze. Zusätzlich muss noch auf das numerische
Verhalten bei einer quantisierten Datendarstellung geachtet werden. Den
letzten Punkt werden wir zunächst nicht behandeln.</p>
<p>Eine Analyse der DF1 zeigt, dass wir fünf Multiplikationen und vier
Speicherplätze benötigen. Durch Umstellen des Blockdiagramms lässt sich
erkennen, dass es möglich ist die Speicher für den Transversal- und für
den Rückführungszweig zusammen zu legen (siehe <a class="reference internal" href="#fig-df1-to-df2"><span class="std std-numref">Abbildung 6.18</span></a> ). Diese Umstellung ist erlaubt, da wir
zum einen den Transversal- und den Rückführungszweig als zwei getrennte
Systeme auffassen können, zum anderen da beide Einzelsysteme LTI-Systeme
sind und somit das Vertauschen keinen Einfluss auf das
Übertragungsverhalten hat. Die jetzt parallel liegenden Speicherelemente
können in einem abschließenden Schritt zusammen gefasst werden. Es
ergibt sich die sogenannte Direkt-Form II mit einer minimalen Anzahl von
zwei Speicherelementen. Strukturen mit minimaler Anzahl an
Speicherelementen werden kanonisch genannt.</p>
<figure class="align-default" id="fig-df1-to-df2">
<a class="reference internal image-reference" href="_images/DF1_to_DF2.png"><img alt="_images/DF1_to_DF2.png" src="_images/DF1_to_DF2.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 6.18 </span><span class="caption-text">Umwandlung einer DF1 Struktur in die
kanonische DF2 Struktur. Die grau hinterlegten Verzögerungselemente
können zu einem Element zusammen gefasst werden, da sie jeweils dasselbe
Signal als Eingang haben.</span><a class="headerlink" href="#fig-df1-to-df2" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="vom-blockdiagramm-zur-ubertragungsfunktion">
<h4><span class="section-number">6.2.3.3. </span>Vom Blockdiagramm zur Übertragungsfunktion<a class="headerlink" href="#vom-blockdiagramm-zur-ubertragungsfunktion" title="Permalink to this headline">#</a></h4>
<div class="error admonition">
<p class="admonition-title">To Do</p>
<p>Analyse des Block-Diagramms mit z-Trafo daraus folgend die Übertragungsfunktion , ??Wie geht es anders herum??</p>
</div>
</section>
</section>
<section id="iir-filterdesign">
<h3><span class="section-number">6.2.4. </span>IIR-Filterdesign<a class="headerlink" href="#iir-filterdesign" title="Permalink to this headline">#</a></h3>
<p>Um die Theorie des Entwurfs traditioneller IIR-Filter genauer zu
erläutern fehlen an dieser Stelle noch einige theoretische Konzepte. <a class="reference internal" href="#sec-iir-filterdesign"><span class="std std-numref">Abschnitt 6.2.5</span></a> gibt alleridngs einen ersten Einblick in Entwurfsverfahren von IIR-Filtern auf Basis von Matlab.</p>
<p>Mit den bisherigen Erkenntnissen sind aber schon Lösungen für einige
spezielle Filter möglich.</p>
<section id="notch-filter">
<h4><span class="section-number">6.2.4.1. </span>Notch-Filter<a class="headerlink" href="#notch-filter" title="Permalink to this headline">#</a></h4>
<div class="error admonition">
<p class="admonition-title">To Do</p>
<p>Entwurf in z-Ebene durch Nullstellen auf dem Einheitskreis und Polstellen mit verringertem Radius und gleichem Winkel, Anwendungen bzw. Design Bsp.: DC Filter, Netzbrummﬁlter</p>
</div>
</section>
<section id="allpasse">
<h4><span class="section-number">6.2.4.2. </span>Allpässe<a class="headerlink" href="#allpasse" title="Permalink to this headline">#</a></h4>
<div class="error admonition">
<p class="admonition-title">To Do</p>
<p>Wiederholung spezielles Pol-Nullstellendiagramm, Überlegungen zum Entwurf im z-Bereich, Anwendungen: Spezielle Filter</p>
</div>
</section>
</section>
<section id="sec-iir-filterdesign">
<span id="id4"></span><h3><span class="section-number">6.2.5. </span>IIR-Filterdesign<a class="headerlink" href="#sec-iir-filterdesign" title="Permalink to this headline">#</a></h3>
<p>Der Entwurf von IIR-Filtern erfolgt historisch bedingt etwas anders.
Rekursive Filter sind sehr viel enger mit analogen Filtern verwandt.
Eine Möglichkeit des IIR-Filterentwurfs besteht deshalb darin, einen
analogen Entwurf durchzuführen und das Resultat in den Digitalbereich zu
transformieren. Da bisher noch keine analogen Filter genauer besprochen
wurden, soll an dieser Stelle nur Beispielhaft typische Lösungen und
ihre Stärken und Schwächen gezeigt werden.</p>
<section id="butterworth-filter">
<span id="sec-butterworth-filter"></span><h4><span class="section-number">6.2.5.1. </span>Butterworth-Filter<a class="headerlink" href="#butterworth-filter" title="Permalink to this headline">#</a></h4>
<p>Ziel des Butterworth-Entwurfs ist einen möglichst flachen
Durchlassbereich zu erhalten. Dies wird im analogen Entwurf durch
Nutzung einer Potenzfunktion gewährleistet (siehe Abschnitt
Analogentwurf) Aus diesem Grund wird dieser Entwurf auch als <em>Maximum
Flat Design</em> bezeichnet. In Matlab stehen die Befehle <code class="docutils literal notranslate"><span class="pre">butter</span></code> und
<code class="docutils literal notranslate"><span class="pre">buttord</span></code> für das Design zu Verfügung, wobei mit buttord zu einem
definierten Design die benötigten Entwurfsparameter bestimmt werden und
butter der eigentliche Entwurf ist. Angegeben werden meist zwei
Arbeitspunkte des Filters, zum einen bis zu welcher Frequenz der
Durchlassbereich definiert ist und welche Abstand von der 0dB Linie noch
als Durchlass gilt. Zum anderen ab welcher Frequenz eine bestimmte
Dämpfung erreicht werden muss (Sperrbereich). Da die Grenzfrequenz des
Butterworth-Filter durch die <span class="math notranslate nohighlight">\(-3\)</span>dB Grenze definiert, wird in Butterord
eine Anpassung an diese Frequenz vorgenommen.</p>
<p>Beispiel einer Filterspezifikation für normierte Frequenzen:<br />
Durchlassbereich bis <span class="math notranslate nohighlight">\(0.1\pi\)</span> und maximale Dämpfung von <span class="math notranslate nohighlight">\(0.2\)</span>dB.<br />
Sperrbereich ab <span class="math notranslate nohighlight">\(02\pi\)</span> und minimale Dämpfung von <span class="math notranslate nohighlight">\(30dB\)</span>.<br />
Der dazugehörige Code sieht dann wie folgt aus:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="e23d5f16-e163-40f6-a8aa-4d54671e0818" name="a8a5b363-eab8-41e5-b2ec-1b1cf87bc3c1" type="radio">
</input><label class="sd-tab-label" for="e23d5f16-e163-40f6-a8aa-4d54671e0818">
Matlab</label><div class="sd-tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">Pass_freq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span><span class="w"> </span><span class="c">% Matlab uses normalized frequencies from 0..2</span><span class="w"></span>
<span class="w">    </span><span class="n">Pass_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_freq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="p">[</span><span class="n">N</span><span class="p">,</span><span class="n">f_g</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">buttord</span><span class="p">(</span><span class="n">Pass_freq</span><span class="p">,</span><span class="n">Stop_freq</span><span class="p">,</span><span class="n">Pass_dB</span><span class="p">,</span><span class="n">Stop_dB</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c">% Result is 7th Order and f_g = 0.1247</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">f_g</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<input id="70c5d34e-fe24-43a0-834c-0511345dd301" name="a8a5b363-eab8-41e5-b2ec-1b1cf87bc3c1" type="radio">
</input><label class="sd-tab-label" for="70c5d34e-fe24-43a0-834c-0511345dd301">
Python</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
    <span class="n">Pass_freq</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">Pass_dB</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Stop_freq</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Stop_dB</span> <span class="o">=</span> <span class="mi">30</span>
    
    <span class="n">order</span><span class="p">,</span> <span class="n">wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">buttord</span><span class="p">(</span><span class="n">wp</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">ws</span><span class="o">=</span><span class="n">Stop_freq</span><span class="p">,</span> <span class="n">gpass</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">gstop</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">f_s</span><span class="p">)</span>
    <span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="tschebyscheff-i-filter">
<h4><span class="section-number">6.2.5.2. </span>Tschebyscheff-I-Filter<a class="headerlink" href="#tschebyscheff-i-filter" title="Permalink to this headline">#</a></h4>
<p>Im Gegensatz zum Butterworth-Filter ist das Ziel des Tschebyscheff-I
Filters im Durchlassbereich die maximal zulässige Durchlassdämpfung
nicht zu überschreiten. Gleichzeitig wird aber erlaubt, diesen Bereich
bis zur Grenzfrequenz auszunutzen. Die Tschebyscheff-Optimierung hat
also immer zum Ziel den Maximalen Fehler zu minimieren. Der Entwurf wird
auch als Equiripple-Design bezeichnet. Dies führt zu einem Entwurf mit
geringerer Ordnung. Die zugehörigen Matlab-Befehle lauten <code class="docutils literal notranslate"><span class="pre">cheb1ord</span></code> und
<code class="docutils literal notranslate"><span class="pre">cheby1</span></code>. Für das Design-Beispiel ergibt sich der folgende Code.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="156bd5ee-6956-44b7-865c-25e167b8987e" name="616601de-d749-4e21-9f1f-9e36a56953fc" type="radio">
</input><label class="sd-tab-label" for="156bd5ee-6956-44b7-865c-25e167b8987e">
Matlab</label><div class="sd-tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">Pass_freq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span><span class="w"> </span><span class="c">% Matlab uses normalized frequencies from 0..2</span><span class="w"></span>
<span class="w">    </span><span class="n">Pass_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_freq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="p">[</span><span class="n">N</span><span class="p">,</span><span class="n">f_g</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheb1ord</span><span class="p">(</span><span class="n">Pass_freq</span><span class="p">,</span><span class="n">Stop_freq</span><span class="p">,</span><span class="n">Pass_dB</span><span class="p">,</span><span class="n">Stop_dB</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c">% Results in a 5th Order filter with f_g = 0.1</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheby1</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Pass_dB</span><span class="p">,</span><span class="n">f_g</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<input id="a24232d6-691c-41e5-8a53-271ba9cd512a" name="616601de-d749-4e21-9f1f-9e36a56953fc" type="radio">
</input><label class="sd-tab-label" for="a24232d6-691c-41e5-8a53-271ba9cd512a">
Python</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
    <span class="n">Pass_freq</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">Pass_dB</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Stop_freq</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Stop_dB</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="n">order</span><span class="p">,</span> <span class="n">wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheb1ord</span><span class="p">(</span><span class="n">wp</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">ws</span><span class="o">=</span><span class="n">Stop_freq</span><span class="p">,</span> <span class="n">gpass</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">gstop</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">f_s</span><span class="p">)</span>
    <span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheby1</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">rp</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="tschebyscheff-ii-filter">
<h4><span class="section-number">6.2.5.3. </span>Tschebyscheff-II-Filter<a class="headerlink" href="#tschebyscheff-ii-filter" title="Permalink to this headline">#</a></h4>
<p>Das Tschebyscheff-II-Filter ist der Inverse Entwurf zum Typ I. Das Ziel
ist also ein flacher Durchlassbereich und ein oszilierender
Sperrbereich. Der dazugehörige Matlab-Code sieht folgendermaßen aus.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="e8e7f798-1cac-4488-b77b-5b609bce85ce" name="68dfaa2b-13f8-4b17-8d16-c6b75fa9300a" type="radio">
</input><label class="sd-tab-label" for="e8e7f798-1cac-4488-b77b-5b609bce85ce">
Matlab</label><div class="sd-tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">Pass_freq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span><span class="w"> </span><span class="c">% Matlab uses normalized frequencies from 0..2</span><span class="w"></span>
<span class="w">    </span><span class="n">Pass_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_freq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="p">[</span><span class="n">N</span><span class="p">,</span><span class="n">f_g</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheb2ord</span><span class="p">(</span><span class="n">Pass_freq</span><span class="p">,</span><span class="n">Stop_freq</span><span class="p">,</span><span class="n">Pass_dB</span><span class="p">,</span><span class="n">Stop_dB</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c">% Results in a 5th Order filter with f_g = 0.2</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheby2</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Stop_dB</span><span class="p">,</span><span class="n">f_g</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<input id="3f55106a-a9b0-4e92-88fd-4209aa20be52" name="68dfaa2b-13f8-4b17-8d16-c6b75fa9300a" type="radio">
</input><label class="sd-tab-label" for="3f55106a-a9b0-4e92-88fd-4209aa20be52">
Python</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
    <span class="n">Pass_freq</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">Pass_dB</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Stop_freq</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Stop_dB</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="n">order</span><span class="p">,</span> <span class="n">wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheb2ord</span><span class="p">(</span><span class="n">wp</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">ws</span><span class="o">=</span><span class="n">Stop_freq</span><span class="p">,</span> <span class="n">gpass</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">gstop</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">f_s</span><span class="p">)</span>
    <span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheby2</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">rs</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="n">Stop_freq</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="cauer-filter">
<h4><span class="section-number">6.2.5.4. </span>Cauer-Filter<a class="headerlink" href="#cauer-filter" title="Permalink to this headline">#</a></h4>
<p>Das Cauer-Filter auch als Ellpitisches-Filter bezeichnet, definiert
einen Equiripple-Entwurf im Durchlass- und Sperrbereich. Dies führt zu
einer weiteren Reduzierung der Ordnung. Der Entwurf sieht wie
folgt aus.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="18e47d16-9e24-4506-949c-457cbc7a618b" name="0b870dd7-256f-419f-92f4-666cd0965af7" type="radio">
</input><label class="sd-tab-label" for="18e47d16-9e24-4506-949c-457cbc7a618b">
Matlab</label><div class="sd-tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">Pass_freq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span><span class="w"> </span><span class="c">% Matlab uses normalized frequencies from 0..2</span><span class="w"></span>
<span class="w">    </span><span class="n">Pass_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_freq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="p">[</span><span class="n">N</span><span class="p">,</span><span class="n">f_g</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">ellipord</span><span class="p">(</span><span class="n">Pass_freq</span><span class="p">,</span><span class="n">Stop_freq</span><span class="p">,</span><span class="n">Pass_dB</span><span class="p">,</span><span class="n">Stop_dB</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c">% Results in a 4th Order filter with f_g = 0.1</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">ellip</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Pass_dB</span><span class="p">,</span><span class="n">Stop_dB</span><span class="p">,</span><span class="n">f_g</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<input id="373196f6-3a2e-4111-832a-3601d4bf0b4e" name="0b870dd7-256f-419f-92f4-666cd0965af7" type="radio">
</input><label class="sd-tab-label" for="373196f6-3a2e-4111-832a-3601d4bf0b4e">
Python</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
    <span class="n">Pass_freq</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">Pass_dB</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Stop_freq</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Stop_dB</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="n">order</span><span class="p">,</span> <span class="n">wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">ellipord</span><span class="p">(</span><span class="n">wp</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">ws</span><span class="o">=</span><span class="n">Stop_freq</span><span class="p">,</span> <span class="n">gpass</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">gstop</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">f_s</span><span class="p">)</span>
    <span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">ellip</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">rp</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">rs</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="vor-und-nachteile-der-unterschiedlichen-entwurfsverfahren">
<h4><span class="section-number">6.2.5.5. </span>Vor- und Nachteile der unterschiedlichen Entwurfsverfahren<a class="headerlink" href="#vor-und-nachteile-der-unterschiedlichen-entwurfsverfahren" title="Permalink to this headline">#</a></h4>
<p>Die Wahl der Entwurfsmethode beruht im großen Maße auf den gegebenen
Randparamtern. Um eine geeignete Wahl zu treffen ist es aber notwendig
die Stärken und Schwächen der einzelnen Verfahren zu beleuchten. Aus den
vorherigen Abschnitten ist bereits ersichtlich, dass die Ordnung der
Filter und somit die Anzahl der benötigten Filterkoeffizienten vom
Entwurf abhängt. Der Butterworth-Entwurf benötigt immer die größte
Ordnung, während das Cauer-Filter immer mit der geringsten Ordnung
auskommt. Gleichzeitig sind die resultierenden Koeffizienten auch für
eine SOS-Lösung numerisch am fragilsten und benötigen eine hohe
Quantisierung.</p>
<p>Um die weiteren Vor- und Nachteile zu verdeutlichen sind in <a class="reference internal" href="#fig-iirdesign"><span class="std std-numref">Abbildung 6.19</span></a>  die verschiedenen Entwurfsverfahren am
oben verwendeten Beispiel gezeigt.</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Demoscript for &quot;Signalverarbeitung 1&quot;</span>
<span class="c1">#</span>
<span class="c1"># Version: 1.0   18.02.2022</span>
<span class="c1"># </span>
<span class="c1"># This software is released as public domain under CC0 1.0</span>
<span class="c1"># https://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="c1">#-------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>

<span class="c1"># determine where we&#39;re running from and set paths accordingly</span>
<span class="k">try</span><span class="p">:</span> 
    <span class="k">if</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ZMQInteractiveShell&#39;</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;../../&#39;</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">sv.mplstyle&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">((</span><span class="n">ax_durch_b_c1</span><span class="p">,</span> <span class="n">ax_durch_c2_c</span><span class="p">),</span> <span class="p">(</span><span class="n">ax_sperr_b_c1</span><span class="p">,</span> <span class="n">ax_sperr_c2_c</span><span class="p">),</span> 
        <span class="p">(</span><span class="n">ax_phase_b_c1</span><span class="p">,</span> <span class="n">ax_phase_c2_c</span><span class="p">))</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">f_s</span> <span class="o">=</span> <span class="mi">48000</span> 

<span class="c1"># filter design parameters</span>
<span class="n">order</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">Pass_freq</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">Pass_dB</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">Stop_freq</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">Stop_dB</span> <span class="o">=</span> <span class="mi">30</span>

<span class="c1"># Filter design process: </span>
<span class="c1">#   1. find necessary order for the desired parameters</span>
<span class="c1">#   2. use corresponding filter design function, </span>
<span class="c1">#        giving the necessary parameter (not always all of them)</span>
<span class="c1">#   3. calculate the transfer function using freqz on the filter coefficients</span>
<span class="c1"># displaying:</span>
<span class="c1">#   4. show amplitude of transfer function in Pass stop and transition, </span>
<span class="c1">#       using fitting zooms</span>
<span class="c1">#   5. show phase. numpy.unwrap for smooth display i.e. no jumps from 2*pi to 0</span>

<span class="c1"># Butterworth vs Chebychev-1 filter design</span>
<span class="c1"># ----------------------------------------</span>

<span class="c1"># Butterworth:</span>
<span class="n">order</span><span class="p">,</span> <span class="n">wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">buttord</span><span class="p">(</span><span class="n">wp</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">ws</span><span class="o">=</span><span class="n">Stop_freq</span><span class="p">,</span> 
        <span class="n">gpass</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">gstop</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">)</span>
<span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span>

<span class="n">ax_durch_b_c1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)))</span>
<span class="n">ax_durch_b_c1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in rad/s&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Pegel in dB&#39;</span><span class="p">,</span> 
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;a) Durchlassbereich&#39;</span><span class="p">)</span>

<span class="n">ax_sperr_b_c1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)))</span>
<span class="n">ax_sperr_b_c1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in rad/s&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Pegel in dB&#39;</span><span class="p">,</span> 
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;b) Sperrbereich&#39;</span><span class="p">)</span>
<span class="n">ax_phase_b_c1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">h</span><span class="p">)))</span>
<span class="n">ax_phase_b_c1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in rad/s&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Phase in rad&#39;</span><span class="p">,</span> 
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;c) Phase&#39;</span><span class="p">)</span>

<span class="c1"># Cheby1</span>
<span class="n">order</span><span class="p">,</span> <span class="n">wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheb1ord</span><span class="p">(</span><span class="n">wp</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">ws</span><span class="o">=</span><span class="n">Stop_freq</span><span class="p">,</span> 
        <span class="n">gpass</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">gstop</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">f_s</span><span class="p">)</span>
<span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheby1</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">rp</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span>

<span class="n">ax_durch_b_c1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax_sperr_b_c1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax_phase_b_c1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">h</span><span class="p">)),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="c1"># Chebychev-2 vs Cauer filter design</span>
<span class="c1"># ----------------------------------</span>

<span class="c1"># Cheby2</span>
<span class="n">order</span><span class="p">,</span> <span class="n">wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheb2ord</span><span class="p">(</span><span class="n">wp</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">ws</span><span class="o">=</span><span class="n">Stop_freq</span><span class="p">,</span> 
        <span class="n">gpass</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">gstop</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">f_s</span><span class="p">)</span>
<span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheby2</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">rs</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="n">Stop_freq</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span>

<span class="n">ax_durch_c2_c</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)))</span>
<span class="n">ax_durch_c2_c</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in rad/s&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Pegel in dB&#39;</span><span class="p">,</span> 
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;d) Durchlassbereich&#39;</span><span class="p">)</span>
<span class="n">ax_sperr_c2_c</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)))</span>
<span class="n">ax_sperr_c2_c</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in rad/s&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Pegel in dB&#39;</span><span class="p">,</span> 
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;e) Sperrbereich&#39;</span><span class="p">)</span>
<span class="n">ax_phase_c2_c</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">h</span><span class="p">)))</span>
<span class="n">ax_phase_c2_c</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in rad/s&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Phase in rad&#39;</span><span class="p">,</span> 
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;f) Phase&#39;</span><span class="p">)</span>

<span class="c1"># Cauer</span>
<span class="n">order</span><span class="p">,</span> <span class="n">wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">ellipord</span><span class="p">(</span><span class="n">wp</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">ws</span><span class="o">=</span><span class="n">Stop_freq</span><span class="p">,</span> 
        <span class="n">gpass</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">gstop</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">f_s</span><span class="p">)</span>
<span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">ellip</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">rp</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">rs</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">,</span> 
        <span class="n">Wn</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span>

<span class="n">ax_durch_c2_c</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax_sperr_c2_c</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax_phase_c2_c</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">h</span><span class="p">)),</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># glue this figure to paste it later (no effect outside of MyST NB)</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;IIRDesign&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="fig-iirdesign" style="width: 75%">
<div class="cell_output docutils container">
<img alt="_images/filter_50_1.png" src="_images/filter_50_1.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 6.19 </span><span class="caption-text">Beispiel eines Tiefpass-Entwurfes für verschiedene Entwurfsverfahren.</span><a class="headerlink" href="#fig-iirdesign" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Das Butterworth-Filter hat im Durchlassbereich den erwarteten positiven
flachen Verlauf, der im Sperrbereich zu einer monoton fallenden Dämpfung
führt. Dieses Verhalten im Sperrbereich wird auch vom
Tschebyscheff-I-Filter im Sperrbereich erreicht, wobei trotz der
geringeren Ordnung ein zunächst steilerer Übergang an der Grenzfrequenz
erreicht wird. Beim Tschebyscheff-II-Filter im Durchlassbereich wird
deutlich, dass die Spezifikation übererfüllt wird. Die Grenzfrequenz bei
der der Übergang beginnt, ist verschoben, da beim
Tschebyscheff-II-Design in erster Linie der Sperrbereich erfüllt werden
soll.</p>
<p>Ein bisher nicht beachteter Aspekt ist in den Bildern c und f gezeigt.
Hier wird deutlich, dass die Phase im Übergangsbereich durch das
Cauer-Filter am stärksten verzerrt wird, während das Butterworth-Filter
am ehesten der meistens gewünschten linearen Phase entspricht.</p>
<div class="error admonition">
<p class="admonition-title">To Do</p>
<p>Impuls bzw. Step-Verhalten zur Glättung</p>
</div>
</section>
<section id="entwurf-von-hochpass-bandpass-und-bandsperr-filter">
<h4><span class="section-number">6.2.5.6. </span>Entwurf von Hochpass, Bandpass und Bandsperr-Filter<a class="headerlink" href="#entwurf-von-hochpass-bandpass-und-bandsperr-filter" title="Permalink to this headline">#</a></h4>
<p>Bisher wurden nur Tiefpass-Entwürfe betrachtet. Alle anderen Filter
lassen sich ebenfalls errechnen, wobei die dazu verwendeten
Frequenz-Transformationen (nicht zu verwechseln mit der Fourier-Transformation) erst bei der Betrachtung der analogen
Prototyp-Filter genauer erläutert werden soll.</p>
<p>Für den Entwurf mit Matlab ergibt sich für alle Verfahren das gleiche
Schema. Ein Hochpass-Filter wird durch einen speziellen Schalter (Flag =
“high”) angezeigt. Der Bandpass-Entwurf ergibt sich automatisch, wenn
mehr als eine Grenzfrequenz angegeben wird, während die Bandsperre mit
zwei Grenzfrequenzen und einem Flag = “stop” angezeigt wird. Zur
Berechnung der Ordnung reicht es die Grenzfrequenzen zu vertauschen, um
einen Hochpass anzuzeigen.</p>
<p>Beispiel:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="c9bfe8a4-3f6e-4923-8655-b3fc2edc834a" name="3f593d1a-9860-4bbb-afd3-3084758b53fa" type="radio">
</input><label class="sd-tab-label" for="c9bfe8a4-3f6e-4923-8655-b3fc2edc834a">
Matlab</label><div class="sd-tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c">% Highpass-Design</span><span class="w"></span>
<span class="w">    </span><span class="n">Pass_freq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"> </span><span class="c">% Matlab uses normalized frequencies from 0..2</span><span class="w"></span>
<span class="w">    </span><span class="n">Pass_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_freq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="p">[</span><span class="n">N</span><span class="p">,</span><span class="n">f_g</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">buttord</span><span class="p">(</span><span class="n">Pass_freq</span><span class="p">,</span><span class="n">Stop_freq</span><span class="p">,</span><span class="n">Pass_dB</span><span class="p">,</span><span class="n">Stop_dB</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c">% Result is 7th Order and f_g = 0.1247</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">f_g</span><span class="p">,</span><span class="s">&#39;high&#39;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c">%Bandpass Design</span><span class="w"></span>
<span class="w">    </span><span class="n">Pass_freqLow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"> </span><span class="c">% Matlab uses normalized frequencies from 0..2</span><span class="w"></span>
<span class="w">    </span><span class="n">Pass_freqHigh</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.3</span><span class="p">;</span><span class="w"> </span><span class="c">% Matlab uses normalized frequencies from 0..2</span><span class="w"></span>
<span class="w">    </span><span class="n">Pass_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_freqLow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_freqHigh</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">N</span><span class="p">,</span><span class="n">f_g</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">buttord</span><span class="p">([</span><span class="n">Pass_freqLow</span><span class="w"> </span><span class="n">Pass_freqHigh</span><span class="p">],[</span><span class="n">Stop_freqLow</span><span class="w"> </span><span class="n">Stop_freqHigh</span><span class="p">],</span><span class="n">Pass_dB</span><span class="p">,</span><span class="n">Stop_dB</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">f_g</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c">% Bandstop Design</span><span class="w"></span>
<span class="w">    </span><span class="n">Pass_freqLow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span><span class="w"> </span><span class="c">% Matlab uses normalized frequencies from 0..2</span><span class="w"></span>
<span class="w">    </span><span class="n">Pass_freqHigh</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.4</span><span class="p">;</span><span class="w"> </span><span class="c">% Matlab uses normalized frequencies from 0..2</span><span class="w"></span>
<span class="w">    </span><span class="n">Pass_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_freqLow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_freqHigh</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">N</span><span class="p">,</span><span class="n">f_g</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">buttord</span><span class="p">([</span><span class="n">Pass_freqLow</span><span class="w"> </span><span class="n">Pass_freqHigh</span><span class="p">],[</span><span class="n">Stop_freqLow</span><span class="w"> </span><span class="n">Stop_freqHigh</span><span class="p">],</span><span class="n">Pass_dB</span><span class="p">,</span><span class="n">Stop_dB</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">f_g</span><span class="p">,</span><span class="s">&#39;stop&#39;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<input id="7ffc37fd-5acd-48bd-a8d9-241f2184e4e1" name="3f593d1a-9860-4bbb-afd3-3084758b53fa" type="radio">
</input><label class="sd-tab-label" for="7ffc37fd-5acd-48bd-a8d9-241f2184e4e1">
Python</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="c1"># Highpass Design</span>
    <span class="n">Pass_freq</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Pass_dB</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Stop_freq</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">Stop_dB</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="n">order</span><span class="p">,</span> <span class="n">wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">buttord</span><span class="p">(</span><span class="n">wp</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">ws</span><span class="o">=</span><span class="n">Stop_freq</span><span class="p">,</span> <span class="n">gpass</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">gstop</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">)</span>
    <span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;highpass&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span>

    <span class="c1"># Bandpass Design</span>
    <span class="n">Pass_freqLow</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Pass_freqHigh</span> <span class="o">=</span> <span class="mf">0.3</span>
    <span class="n">Pass_dB</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Stop_freqLow</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">Stop_freqHigh</span> <span class="o">=</span> <span class="mf">0.4</span>
    <span class="n">Stop_dB</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="n">order</span><span class="p">,</span> <span class="n">wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">buttord</span><span class="p">(</span><span class="n">wp</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">ws</span><span class="o">=</span><span class="n">Stop_freq</span><span class="p">,</span> <span class="n">gpass</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">gstop</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">)</span>
    <span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="p">[</span><span class="n">Pass_freqLow</span><span class="p">,</span> <span class="n">Pass_freqHigh</span><span class="p">],</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;bandpass&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span>

    <span class="c1"># Bandstop Design</span>
    <span class="n">Pass_freqLow</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">Pass_freqHigh</span> <span class="o">=</span> <span class="mf">0.4</span>
    <span class="n">Pass_dB</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Stop_freqLow</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Stop_freqHigh</span> <span class="o">=</span> <span class="mf">0.3</span>
    <span class="n">Stop_dB</span> <span class="o">=</span> <span class="mi">30</span> 
    <span class="n">order</span><span class="p">,</span> <span class="n">wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">buttord</span><span class="p">(</span><span class="n">wp</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">ws</span><span class="o">=</span><span class="n">Stop_freq</span><span class="p">,</span> <span class="n">gpass</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">gstop</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">)</span>
    <span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="p">[</span><span class="n">Pass_freqLow</span><span class="p">,</span> <span class="n">Pass_freqHigh</span><span class="p">],</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;bandstop&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="spektren.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">5. </span>Spektren</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="zbibliography.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">7. </span>Literaturverzeichnis</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Joerg Bitzer<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>