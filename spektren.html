
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>5. Spektren &#8212; Signalverarbeitung 1</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="6. Filter" href="filter.html" />
    <link rel="prev" title="4. z-Transformation" href="ztrafo.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Signalverarbeitung 1</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Signalverarbeitung 1
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="grundlagen.html">
   1. Einf√ºhrung
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="signale.html">
   2. Signale
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="systeme.html">
   3. Systeme
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ztrafo.html">
   4. z-Transformation
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   5. Spektren
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="filter.html">
   6. Filter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="zbibliography.html">
   7. Literaturverzeichnis
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/JoergBitzer/Signalverarbeitung_Vorlesungsskript/master?urlpath=tree/spektren.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/JoergBitzer/Signalverarbeitung_Vorlesungsskript/"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/JoergBitzer/Signalverarbeitung_Vorlesungsskript//issues/new?title=Issue%20on%20page%20%2Fspektren.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/spektren.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="_sources/spektren.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#einfluss-der-pole-und-nullstellen-auf-die-ubertragungsfunktion">
   5.1. Einfluss der Pole und Nullstellen auf die √úbertragungsfunktion
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#diskrete-fourier-transformation">
   5.2. Diskrete Fourier-Transformation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eigenschaften">
   5.3. Eigenschaften
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#zusammenhang-dtft-und-dft">
     5.3.1. Zusammenhang DTFT und DFT
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#symmetrien-der-dft">
     5.3.2. Symmetrien der DFT
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#spektren-reeller-gerader-folgen">
       5.3.2.1. Spektren reeller gerader Folgen
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rechenregeln">
     5.3.3. Rechenregeln
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#linearitat">
       5.3.3.1. Linearit√§t
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#faltung">
       5.3.3.2. Faltung
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#theorem-von-parseval">
       5.3.3.3. Theorem von Parseval
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#effiziente-implementierung">
     5.3.4. Effiziente Implementierung
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#spezielle-signale-und-ihre-spektren">
   5.4. Spezielle Signale und ihre Spektren
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spektrum-fur-delta-k">
     5.4.1. Spektrum f√ºr
     <span class="math notranslate nohighlight">
      \(\delta(k)\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spektrum-fur-delta-k-k-0">
     5.4.2. Spektrum f√ºr
     <span class="math notranslate nohighlight">
      \(\delta(k-k_0)\)
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#weitere-fensterfunktionen-und-deren-eigenschaften">
   5.5. Weitere Fensterfunktionen und deren Eigenschaften
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Spektren</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#einfluss-der-pole-und-nullstellen-auf-die-ubertragungsfunktion">
   5.1. Einfluss der Pole und Nullstellen auf die √úbertragungsfunktion
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#diskrete-fourier-transformation">
   5.2. Diskrete Fourier-Transformation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eigenschaften">
   5.3. Eigenschaften
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#zusammenhang-dtft-und-dft">
     5.3.1. Zusammenhang DTFT und DFT
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#symmetrien-der-dft">
     5.3.2. Symmetrien der DFT
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#spektren-reeller-gerader-folgen">
       5.3.2.1. Spektren reeller gerader Folgen
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rechenregeln">
     5.3.3. Rechenregeln
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#linearitat">
       5.3.3.1. Linearit√§t
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#faltung">
       5.3.3.2. Faltung
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#theorem-von-parseval">
       5.3.3.3. Theorem von Parseval
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#effiziente-implementierung">
     5.3.4. Effiziente Implementierung
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#spezielle-signale-und-ihre-spektren">
   5.4. Spezielle Signale und ihre Spektren
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spektrum-fur-delta-k">
     5.4.1. Spektrum f√ºr
     <span class="math notranslate nohighlight">
      \(\delta(k)\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spektrum-fur-delta-k-k-0">
     5.4.2. Spektrum f√ºr
     <span class="math notranslate nohighlight">
      \(\delta(k-k_0)\)
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#weitere-fensterfunktionen-und-deren-eigenschaften">
   5.5. Weitere Fensterfunktionen und deren Eigenschaften
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="spektren">
<span id="sec-spektren"></span><h1><span class="section-number">5. </span>Spektren<a class="headerlink" href="#spektren" title="Permalink to this headline">#</a></h1>
<p>Neben den zwei Beschreibungsebenen f√ºr diskrete Signale und
Systeme, den Zeitbereich mit der Differenzengleichung und
die z-Ebene, gilt ein besonderes Interesse, wie sich die Signale und
Systeme in Abh√§ngigkeit von der Frequenz verhalten. Diese Darstellung
wird als Spektrum bezeichnet. Dabei ist das Betragsverhalten
(Betragsspektrum), also ob und mit welcher Leistung eine Frequenz im
Signal vorhanden ist oder ob ein System eine bestimmte Frequenz
verst√§rkt oder d√§mpft, interessant. Das Phasenverhalten ist f√ºr viele
Anwendungen von sekund√§rer Bedeutung. Trotzdem kann insbesondere bei der
Beschreibung von Systemen das Phasenspektrum eine wichtige Information
darstellen.</p>
<div class="hint admonition">
<p class="admonition-title">Beispiel</p>
<p>Motivationsbeispiel: Feedbackproblematik im H√∂rger√§t oder bei der B√ºhnenbeschallung. Analyse des Signals (Spektrum) erm√∂glicht zu erkennen, bei welcher Frequenz die St√∂rung auftritt. Nach der Analyse kann ein System eingebaut werden, dass die √úbertragung bei dieser Frequenz d√§mpft. Durch den frequenzselektiven EingriÔ¨Ä wird das Nutzssignal nur unwesentlich beeinflusst.</p>
</div>
<div class="error admonition">
<p class="admonition-title">ToDo</p>
<p>Das Motivationsbeispiel in einer konkreten Realisierung w√§re sch√∂n.</p>
</div>
<p>Das Verhalten bei einer bestimmten Frequenz l√§sst sich z.B. testen,
indem das LTI-System mit Signalen angeregt wird, die nur aus einer Frequenz bestehen und dann die Ver√§nderung am Ausgang des Systems zu messen. Ein sehr gutes
Eingangssignal um Betrag und Phase zu bestimmen ist die unged√§mpfte
diskrete Exponentialschwingung</p>
<div class="math notranslate nohighlight" id="equation-eq-def-euler-spektren">
<span class="eqno">(5.1)<a class="headerlink" href="#equation-eq-def-euler-spektren" title="Permalink to this equation">#</a></span>\[
    e^{j\Omega_0 k} = \cos(\Omega k)+j\sin(\Omega k)~~~,
\]</div>
<p>mit <span class="math notranslate nohighlight">\(\Omega_0 = 2 \pi f_0/ f_\text{s}\)</span>, wobei <span class="math notranslate nohighlight">\(f_0\)</span> die Analysefrequenz und <span class="math notranslate nohighlight">\(f_\text{s}\)</span>
die Samplingfrequenz angibt.</p>
<div class="hint admonition">
<p class="admonition-title">Exkurs: Frequenzachsen in der DSV</p>
<p>Manchmal ist es verwirrend in
welcher Form Frequenzen in der digitalen Signalverarbeitung angegeben
werden. Die am h√§ufigsten verwendeten Systeme und ihre √Ñquivalenz als
Achse und ihre Position auf dem Einheitskreis in der z-Ebene zeigt
<a class="reference internal" href="#fig-frequenzskalierungenexkurs"><span class="std std-numref">Abbildung 5.1</span></a> .</p>
<figure class="align-default" id="fig-frequenzskalierungenexkurs">
<a class="reference internal image-reference" href="_images/FrequenzskalierungenExkurs.png"><img alt="_images/FrequenzskalierungenExkurs.png" src="_images/FrequenzskalierungenExkurs.png" style="height: 200px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5.1 </span><span class="caption-text">Veranschaulichung der unterschiedlichen
Frequenzbezeichnungen in der DSV und ihre Position auf dem Einheitskreis
in der
z-Ebene.</span><a class="headerlink" href="#fig-frequenzskalierungenexkurs" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
<p>Mit Hilfe der Faltung ergibt sich am Ausgang eines durch die
Impulsantwort beschriebenen Systems</p>
<div class="math notranslate nohighlight" id="equation-eq-ftrafo-bsp">
<span class="eqno">(5.2)<a class="headerlink" href="#equation-eq-ftrafo-bsp" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{aligned}
    y(k)&amp; = &amp;x(k)\ast h(k) = \sum_{\kappa = -\infty}^{\infty} h(\kappa)
    e^{j\Omega_0(k-\kappa)}\\
    &amp;= &amp; \underbrace{e^{j\Omega_0 k}}_{\mbox{Eingangssignal}} \cdot
    \underbrace{\sum_{\kappa = -\infty}^{\infty} h(\kappa) e^{-j\Omega_0
    \kappa}}_{\mbox{Komplexer Multiplikator}}\end{aligned}~~~.
\end{split}\]</div>
<p>Das hei√üt also, die am Ausgang gemessene Schwingung besitzt die gleiche Frequenz, die aber in ihrer Phase und ihrem Betrag ge√§ndert sein k√∂nnte. Die Berechnung
dieses Ausgangsverhalten f√ºr alle Frequenzen f√ºhrt zum gew√ºnschten Spektrum.
Auff√§llig bei LTI-Systemen ist, das keine neuen Frequenzen entstehen.
Dies ist eine typische Eigenschaft von LTI-Systemen.</p>
<div class="attention admonition">
<p class="admonition-title">Wichtig</p>
<p>LTI-Systeme erzeugen keine neuen Frequenzen.</p>
</div>
<p>Bei Systemen wird die frequenzabh√§ngige Ver√§nderung des Betrages und der Phase √úbertragungsfunktion genannt und durch</p>
<div class="math notranslate nohighlight" id="equation-eq-dtfd-hin">
<span class="eqno">(5.3)<a class="headerlink" href="#equation-eq-dtfd-hin" title="Permalink to this equation">#</a></span>\[
    H(e^{j \Omega}) = \sum_{k = -\infty}^{\infty} h(k) e^{-j\Omega k}
\]</div>
<p>berechnet. Dies entspricht einer Fourier-Transformation der nur zu diskreten Punkten definierten Impulsantwort. Allgemein kann jedes beliebige diskrete Signal so in den Frequenzbereich transformiert werden. Die dazugeh√∂rige Transformation wird Zeitdiskrete Fourier-Transformation (<em>Discrete Time Fourier-Transformation, DTFT</em>) genannt.</p>
<p>Vergleichen wir nun Gleichung
<a class="reference internal" href="#equation-eq-dtfd-hin">(5.3)</a> mit der Definition der z-Transformation, so
ist zu erkennen, dass die DTFT die z-Transformation f√ºr <span class="math notranslate nohighlight">\(z = e^{j\Omega}\)</span>
darstellt und somit genau den Einheitskreis in der z-Ebene beschreibt.
Es kann also direkt am Einheitskreis das frequenzabh√§ngige
√úbertragungsverhalten von Systemen abgelesen werden. Dies gilt analog nat√ºrlich
auch f√ºr Signale.</p>
<p>Ist also die z-Transformation eines Systems bekannt kann auch sofort die √úbertragungsfunktion
angeben werden. Beispielsweise ergibt sich
f√ºr das System <span class="math notranslate nohighlight">\(y(k) = x(k) + x(k-1)\)</span> mit <span class="math notranslate nohighlight">\(e^{j\Omega}\)</span> in die
z-Transformierte eingesetzt</p>
<div class="math notranslate nohighlight" id="equation-eq-ftrafo-bsp-ztrafoftrafo">
<span class="eqno">(5.4)<a class="headerlink" href="#equation-eq-ftrafo-bsp-ztrafoftrafo" title="Permalink to this equation">#</a></span>\[
    H(e^{j \Omega}) = 1+z^{-1} \Big|_{z = e^{j\Omega}} = 1+e^{-j\Omega}~~~.
\]</div>
<p>Eine Multiplikation beider Seiten mit <span class="math notranslate nohighlight">\(e^{j \Omega / 2}\)</span> f√ºhrt zu:</p>
<div class="math notranslate nohighlight" id="equation-eq-ftrafo-bspuebrtragungf">
<span class="eqno">(5.5)<a class="headerlink" href="#equation-eq-ftrafo-bspuebrtragungf" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{aligned}
   e^{j\Omega / 2} H(e^{j \Omega}) &amp;= &amp; e^{j \Omega / 2}+e^{-j\Omega / 2}\\
   H(e^{j \Omega}) &amp; = &amp; 2 \cos(\Omega / 2) e^{-j\Omega / 2}
\end{aligned}
\end{split}\]</div>
<p>Die komplexwertige Darstellung mit Real- und Imagin√§rteil ist dabei zur
Veranschaulichung und Interpretation nicht geeignet. Statt dessen wird
das komplexe Signal meist in den Betragsfrequenzgang, d.h, eine
Darstellung von <span class="math notranslate nohighlight">\(|H(e^{j \Omega})|\)</span> √ºber der Frequenz und den Phasengang, eine
Darstellung des Arguments von <span class="math notranslate nohighlight">\(H(e^{j \Omega})\)</span>, aufgeteilt, wobei bei dem Betrag
oder dem Betragsquadrat auch h√§ufig eine logarithmische Darstellung
gew√§hlt wird. In der Audiotechnik wird zus√§tzlich auch die Frequenzachse logarithmisch
dargestellt, da dies eher der menschlichen Wahrnehmung von Tonh√∂he entspricht.</p>
<section id="einfluss-der-pole-und-nullstellen-auf-die-ubertragungsfunktion">
<h2><span class="section-number">5.1. </span>Einfluss der Pole und Nullstellen auf die √úbertragungsfunktion<a class="headerlink" href="#einfluss-der-pole-und-nullstellen-auf-die-ubertragungsfunktion" title="Permalink to this headline">#</a></h2>
<p>Um den Einfluss der Pole und Nullstellen auf die √úbertragungsfunktion
abzusch√§tzen, hilft zun√§chst ein Besipiel. <a class="reference internal" href="ztrafo.html#fig-polnullstellenplan"><span class="std std-numref">Abbildung 4.5</span></a> zeigt rechts <span class="math notranslate nohighlight">\(|H(z)|^2\)</span> als dreidimensionalen H√∂henplot und <span class="math notranslate nohighlight">\(|H(e^{j \Omega})|^2\)</span> als schwarzen Einheitskreis in einer logarithmischen Darstellung. Der Betragsfrequenzgang der DTFT (schwarze Linie)
kann direkt aus dem enstehenden ‚ÄúGebirge‚Äù abgelesen werden, wenn der
Einheitskreis vom Winkel <span class="math notranslate nohighlight">\(0\)</span> bis <span class="math notranslate nohighlight">\(\pi\)</span> umlaufen wird. Der Pol bei <span class="math notranslate nohighlight">\(\pi/10\)</span>
verursacht eine Verst√§rkung auf dem Einheitskreis. Ein Pol direkt auf
dem Einheitskreis w√ºrde zu einer unendlichen Verst√§rkung f√ºhren. Sobald
der Winkel gr√∂√üer wird als <span class="math notranslate nohighlight">\(\pi/10\)</span> nimmt die Verst√§rkung ab. Ab einem
Winkel von <span class="math notranslate nohighlight">\(\pi/2\)</span> werden die Nullstellen dominant, die dazu f√ºhren,
dass sich der Betragsfrequenzgang null n√§hert und die Null bei genau
<span class="math notranslate nohighlight">\(\pi\)</span> erreicht. Auf dem unteren Halbkreis geht zun√§chst der Einfluss der
Nullstelle zur√ºck und der konjugiert komplexe Pol bei <span class="math notranslate nohighlight">\(-\pi/10\)</span> gewinnt
an Einfluss.<span class="math notranslate nohighlight">\(\Omega =
2\pi\)</span> entspricht erneut <span class="math notranslate nohighlight">\(\Omega = 0\)</span>. Der Betragsfrequenzgang
wiederholt sich also periodisch in <span class="math notranslate nohighlight">\(2\pi\)</span> f√ºr diskrete Signale. Dies ist
auch direkt aus der Beziehung</p>
<div class="math notranslate nohighlight" id="equation-eq-spek-peridozitaetserklaerung">
<span class="eqno">(5.6)<a class="headerlink" href="#equation-eq-spek-peridozitaetserklaerung" title="Permalink to this equation">#</a></span>\[
    e^{j\Omega k} = e^{j(\Omega +2\pi n) k} \quad \forall \quad n \in \mathbb{N}
\]</div>
<p>zu sehen.</p>
<p>Eine direkte Berechnung des Betrag- und Phasenganges aus den Polen und
Nullstellen ist ebenfalls m√∂glich. Um das zu veranschaulichen ist in
<a class="reference internal" href="#fig-uebertragpolnullstellen"><span class="std std-numref">Abbildung 5.2</span></a>  ein System zweiter Ordnung mit zwei Polen und zwei Nullstellen in der
z-Ebene  gezeigt.</p>
<figure class="align-default" id="fig-uebertragpolnullstellen">
<a class="reference internal image-reference" href="_images/UebertragPolNullstellen.png"><img alt="_images/UebertragPolNullstellen.png" src="_images/UebertragPolNullstellen.png" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5.2 </span><span class="caption-text">Skizze zur Veranschaulichung des
Einflusses von Polen und Nullstellen auf die √úbertragungsfunktion
<span class="math notranslate nohighlight">\(H(e^{j \Omega})\)</span>.</span><a class="headerlink" href="#fig-uebertragpolnullstellen" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Um den Betrag des Frequenzganges an der Stelle <span class="math notranslate nohighlight">\(P\)</span> zu berechnen, m√ºssen
die Abst√§nde der Pole und Nullstellen zu diesem Punkt <span class="math notranslate nohighlight">\(A_1,
A_2,B_1,B_2\)</span> bekannt sein. Er ergibt sich</p>
<div class="math notranslate nohighlight" id="equation-eq-spec-einfachebetragsrechnung">
<span class="eqno">(5.7)<a class="headerlink" href="#equation-eq-spec-einfachebetragsrechnung" title="Permalink to this equation">#</a></span>\[
    \left|H(e^{j \Omega})\right|\Big|_{e^{j\Omega} = P} = |b_0| \frac{B_1 B_2}{A_1
    A_2}.
\]</div>
<p>Zus√§tzlich hat der Koeffizient <span class="math notranslate nohighlight">\(b_0\)</span> einen Einfluss, der
aber aus dem Pol-Nullstellenplan nicht ersichtlich ist.</p>
<p>Die Phase an diesem Punkt kann durch</p>
<div class="math notranslate nohighlight" id="equation-eq-spec-eenfachephasenrechnung">
<span class="eqno">(5.8)<a class="headerlink" href="#equation-eq-spec-eenfachephasenrechnung" title="Permalink to this equation">#</a></span>\[
    \arg\left\{H(e^{j \Omega}) \right\}\Big|_{e^{j\Omega} = P} = -\arg\{b_0\}  + \beta_1 + \beta_2
    - \alpha_1 - \alpha_2
\]</div>
<p>berechnet werden. Da <span class="math notranslate nohighlight">\(b_0\)</span> f√ºr reellwertige
Systeme ebenfalls reell ist, kann der Term <span class="math notranslate nohighlight">\(\arg\{b_0\}\)</span> auch
weggelassen werden, bzw.¬†f√ºhrt bei negativem <span class="math notranslate nohighlight">\(b_0\)</span> zu einer
Phasendrehung von <span class="math notranslate nohighlight">\(\pi\)</span>.</p>
<p>F√ºr allgemeine Systeme mit einem Z√§hlergrad <span class="math notranslate nohighlight">\(M\)</span> und einem Nennergrad <span class="math notranslate nohighlight">\(N\)</span> ergibt sich (angelehnt an <span id="id1">[<a class="reference internal" href="zbibliography.html#id3" title="K. D. Kammeyer and K. Kroschel. Digitale Signalverarbeitung: Filterung und Spektralanalyse. Teubner, Stuttgart, 3. edition, 1998.">KK98</a>]</span>)</p>
<div class="math notranslate nohighlight" id="equation-eq-spektrumbetragallg">
<span class="eqno">(5.9)<a class="headerlink" href="#equation-eq-spektrumbetragallg" title="Permalink to this equation">#</a></span>\[
    \left|H(e^{j \Omega})\right| = |b_0| \frac{\displaystyle \prod_{i = 0}^{M-1} \sqrt{1-2|n_i|\cos(\Omega-\arg\{n_i\})+|n_i|^2}}
    {\displaystyle \prod_{i = 0}^{N-1}\sqrt{1-2|p_i|\cos(\Omega-\arg\{p_i\})+|p_i|^2}}
\]</div>
<p>bzw. f√ºr die Phase</p>
<p><span class="math notranslate nohighlight">\(\renewcommand{\Re}[1]{\mathfrak{R}\left\{ #1 \right\}}\)</span>
<span class="math notranslate nohighlight">\(\renewcommand{\Im}[1]{\mathfrak{I}\left\{ #1 \right\}}\)</span></p>
<div class="math notranslate nohighlight" id="equation-eq-spektrumphaseallg">
<span class="eqno">(5.10)<a class="headerlink" href="#equation-eq-spektrumphaseallg" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{aligned}
    \arg\left\{H(e^{j \Omega})\right\} &amp;=&amp; (M-N)\Omega - \arg\{b_0\} \\\nonumber
        &amp;&amp; + \sum_{i = 0}^{M-1}\arctan\left\{\frac{\sin \Omega-\Im{n_i}}{\cos \Omega- \Re{n_i}}
    \right\}\\\nonumber
    &amp;&amp; - \sum_{i = 0}^{N-1}\arctan\left\{\frac{\sin \Omega-\Im{p_i}}{\cos \Omega-\Re{p_i}} \right\}\end{aligned}
\end{split}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(\Re{\cdot}\)</span> und <span class="math notranslate nohighlight">\(\Im{\cdot}\)</span> den Real- bzw. Imagin√§ranteil einer komplexen Zahl symbolisieren.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Demoscript for &quot;Signalverarbeitung 1&quot;</span>
<span class="c1">#</span>
<span class="c1"># Version: 1.0   17.02.2022</span>
<span class="c1"># </span>
<span class="c1"># This software is released as public domain under CC0 1.0</span>
<span class="c1"># https://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="c1">#-------------------------------------------------------------------------------</span>

<span class="c1">#%matplotlib inline</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy.signal</span> <span class="k">as</span> <span class="nn">signal</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>

<span class="n">radius_poles</span> <span class="o">=</span> <span class="mf">0.9</span>
<span class="n">omega_poles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">10</span>

<span class="n">pole_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">radius_poles</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">omega_poles</span><span class="p">)]</span>
<span class="n">pole_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pole_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">conjugate</span><span class="p">())</span>


<span class="n">radius_zeros</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="n">omega_zeros</span> <span class="o">=</span> <span class="mi">7</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">10</span>

<span class="n">zero_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">radius_zeros</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">omega_zeros</span><span class="p">)]</span>
<span class="n">zero_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zero_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">conjugate</span><span class="p">())</span>


<span class="c1"># from poles and zeros, compute system coefficients</span>
<span class="n">a_coefficients</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly</span><span class="p">(</span><span class="n">pole_list</span><span class="p">)</span>
<span class="n">b_coefficients</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly</span><span class="p">(</span><span class="n">zero_list</span><span class="p">)</span>

<span class="c1"># draw poles and zeros</span>
<span class="c1">#plt.figure(1)</span>
<span class="c1">#plt.scatter(np.real(pole_list), np.imag(pole_list), marker=&#39;x&#39;, c=&#39;r&#39;)</span>
<span class="c1">#plt.scatter(np.real(zero_list), np.imag(zero_list), marker=&#39;o&#39;, c=&#39;b&#39;)</span>

<span class="c1"># draw unit circle inside the same plot</span>
<span class="n">angles_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
<span class="c1">#plt.plot(np.cos(angles_rad), np.sin(angles_rad), c=&#39;k&#39;)</span>

<span class="c1"># plot formatting stuff</span>
<span class="c1">#plt.axis(&#39;equal&#39;)</span>
<span class="c1">#plt.grid()</span>
<span class="c1">#plt.title(&#39;Pol-Nullstellen-Plan&#39;)</span>
<span class="c1">#plt.xlabel(&#39;Re(z)&#39;)</span>
<span class="c1">#plt.ylabel(&#39;Im(z)&#39;)</span>
<span class="c1">#plt.show()</span>
<span class="c1"># compute complex-valued transfer function</span>
<span class="n">_</span><span class="p">,</span> <span class="n">transfer_function</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b_coefficients</span><span class="p">,</span> <span class="n">a_coefficients</span><span class="p">,</span> <span class="n">whole</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="c1"># def pole_zero_influence_plot(spec_idx):</span>
    
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># first subplot: pole-zero plot</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">pole_list</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">pole_list</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">zero_list</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">zero_list</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angles_rad</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angles_rad</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="c1"># second subplot: magnitude of transfer function</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">transfer_function</span><span class="p">)))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">transfer_function</span><span class="p">)])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">])</span>

<span class="c1"># second subplot: phase of transfer function</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">transfer_function</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">transfer_function</span><span class="p">)])</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">])</span>

<span class="c1"># draw lines from each pole to the current index</span>
<span class="c1">#or pole_idx in range(0, len(pole_list)):</span>
<span class="c1">#   ax[0].plot([np.cos(angles_rad[spec_idx]), np.real(pole_list[pole_idx])],</span>
<span class="c1">#              [np.sin(angles_rad[spec_idx]), np.imag(pole_list[pole_idx])], &#39;:&#39;)</span>

<span class="c1"># draw lines from each zero to the current index</span>
<span class="c1">#or zero_idx in range(0, len(zero_list)):</span>
<span class="c1">#   ax[0].plot([np.cos(angles_rad[spec_idx]), np.real(zero_list[zero_idx])],</span>
<span class="c1">#              [np.sin(angles_rad[spec_idx]), np.imag(zero_list[zero_idx])], &#39;:&#39;)</span>

<span class="c1"># plot markers into transfer function plots at the same index</span>
<span class="c1">#x[1].plot([spec_idx, spec_idx], [-40, 20*np.log10(np.abs(transfer_function[spec_idx]))])</span>
<span class="c1">#x[2].plot([spec_idx, spec_idx], [-np.pi, np.angle(transfer_function[spec_idx])])</span>

        

<span class="c1"># create a slider that uses the slider value inside of the plot function</span>
<span class="c1"># interactive_plot = widgets.interactive(pole_zero_influence_plot, spec_idx=(1, len(transfer_function)-1, 5))</span>

<span class="c1"># show the slider and the plot</span>
<span class="c1"># interactive_plot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-3.141592653589793, 3.141592653589793)
</pre></div>
</div>
<img alt="_images/spektren_4_1.png" src="_images/spektren_4_1.png" />
</div>
</div>
<div class="error admonition">
<p class="admonition-title">To Do</p>
<p>Phase muss noch deutlich besser erkl√§rt werden und die folgenden Interpretationen sollten durch Besipiele (plots mit Python) gezeigt werden. Plot fuer ein PN Plan siehe oben</p>
</div>
<p>Eine Interpretation (die Nutzung vom FilterDeMystifier hilft hier sehr, siehe <a class="reference internal" href="ztrafo.html#sec-interactive-ztransform"><span class="std std-numref">Abschnitt 4.8</span></a>) f√ºhrt zu den Schl√ºssen:</p>
<ul>
<li><p>Je n√§her ein Pol am Einheitkreis liegt umso gr√∂√üer ist sein Einfluss
auf die √úbertragungsfunktion.</p></li>
<li><p>Eine Nullstelle auf dem Einheitskreis f√ºhrt zu einem Phasensprung um
<span class="math notranslate nohighlight">\(\pi\)</span>.</p></li>
<li><p>Systeme, bei denen alle Nullstellen im inneren des Einheitskreises
liegen, hei√üen minimalphasig.</p></li>
<li><p>Pole oder Nullstellen im Ursprung ver√§ndern nur die Phase, aber
nicht den Betrag der √úbertragungsfunktion.</p></li>
<li><p>Nullstellen die am Einheitskreis gespiegelt werden
(<span class="math notranslate nohighlight">\(r_\text{out} = 1/r_\text{in}\)</span>), f√ºhren nur zu einer Ver√§nderung der
Grundverst√§rkung des Betrages der √úbertragungsfunktion aber nicht zu
einer Ver√§nderung der Form. Gleichzeitig wird aber die Phase so
ver√§ndert, dass sie um √ºber <span class="math notranslate nohighlight">\(180^{\circ}\)</span> dreht und das
resultierende System nicht mehr minimalphasig ist.</p></li>
<li><p>Systeme bei denen die Nullstellen an den Positionen der am
Einheitskreis gespiegelten Pole liegen</p>
<div class="math notranslate nohighlight" id="equation-eq-allpassgrundlagenformel">
<span class="eqno">(5.11)<a class="headerlink" href="#equation-eq-allpassgrundlagenformel" title="Permalink to this equation">#</a></span>\[
        n_{i_0} = \frac{1}{p_{i_{\infty}}}
    \]</div>
<p>hei√üen Allpasssysteme, da
der Betrag f√ºr alle Frequenzen konstant bleibt. Nur die Phase wird
ver√§ndert und dreht um <span class="math notranslate nohighlight">\(N \pi\)</span>, wobei <span class="math notranslate nohighlight">\(N\)</span> die Ordnung des Systems
angibt.</p>
</li>
</ul>
</section>
<section id="diskrete-fourier-transformation">
<span id="sec-diskretefourier-transformation"></span><h2><span class="section-number">5.2. </span>Diskrete Fourier-Transformation<a class="headerlink" href="#diskrete-fourier-transformation" title="Permalink to this headline">#</a></h2>
<p>Zur Frequenzanalyse ist bisher nur die DTFT bekannt. Aber diese
Transformation kann nicht auf einem Computer umgesetzt werden, da das
resultierende Spektrum nicht diskret ist. Au√üerdem ben√∂tigt man
unendlich viele Eingangswerte um das Spektrum zu berechnen. Deshalb wird
in einem ersten Schritt die Anzahl der genutzten Abtastwerte auf <span class="math notranslate nohighlight">\(N\)</span>
beschr√§nkt. Man k√∂nnte dies auch so interpretieren, dass die unendliche
Folge des Signals mit einer Rechteckfolge der H√∂he eins und der L√§nge N
multipliziert wird. Da au√üerhalb des Eins-Bereichs alle Multiplikationen
zu Null werden, k√∂nnen auch die Summengrenzen ver√§ndert werden.</p>
<p>Diese Rechteckfolge werden wir im weiteren mit Fenster oder <em>Window</em>
bezeichnen, da es aus der Folge nur einen Ausschnitt zeigt, in Anlehnung
an ein Glasfenster, das uns nur einen Ausschnitt der Wirklichkeit zeigt
(siehe <a class="reference internal" href="#fig-dft-fenstermultiplikation"><span class="std std-numref">Abbildung 5.3</span></a>s). Die L√§nge <span class="math notranslate nohighlight">\(N\)</span> nennen wir Blockgr√∂√üe,
da nur noch ein Block mit Daten verarbeitet wird.</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Demoscript for &quot;Signalverarbeitung 1&quot;</span>
<span class="c1">#</span>
<span class="c1"># Version: 1.0   17.02.2022</span>
<span class="c1"># </span>
<span class="c1"># This software is released as public domain under CC0 1.0</span>
<span class="c1"># https://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="c1">#-------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">pyplot</span>

<span class="c1"># determine where we&#39;re running from and set paths accordingly</span>
<span class="k">try</span><span class="p">:</span> 
    <span class="k">if</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ZMQInteractiveShell&#39;</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;../../&#39;</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">sv.mplstyle&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax_signal</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">signal</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random_sample</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span> <span class="c1"># random sample scaled -2 to 2</span>
<span class="n">ax_signal</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">26</span><span class="p">),</span> <span class="n">signal</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax_signal</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenkindex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x[k]&#39;</span><span class="p">,</span> 
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Eingangssignal&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">26</span><span class="p">])</span>

<span class="n">ax_window</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">window</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">16</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="p">])</span>
<span class="n">ax_window</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">26</span><span class="p">),</span> <span class="n">window</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="s1">&#39;mid&#39;</span><span class="p">)</span>
<span class="n">ax_window</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenkindex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x[k]&#39;</span><span class="p">,</span> 
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Rechteck-Fensterfunktion&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">26</span><span class="p">])</span>

<span class="n">ax_filtered</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">filtered_signal</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="n">window</span> <span class="c1"># filtering in time domain</span>
<span class="n">ax_filtered</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">26</span><span class="p">),</span> <span class="n">filtered_signal</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax_filtered</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenkindex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x[k]&#39;</span><span class="p">,</span> 
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;gefenstertes Signal&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">26</span><span class="p">])</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># glue this figure to paste it later (no effect outside of MyST NB)</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;DFT_FensterMultiplikation&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="fig-dft-fenstermultiplikation" style="width: 100%">
<div class="cell_output docutils container">
<img alt="_images/spektren_7_1.png" src="_images/spektren_7_1.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 5.3 </span><span class="caption-text">Veranschaulichung der Wirkung einer
Rechteck-Fensterfunktion der L√§nge
<span class="math notranslate nohighlight">\(N = 16\)</span>.</span><a class="headerlink" href="#fig-dft-fenstermultiplikation" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Das resultierende Spektrum ist aber immer noch kontinuierlich. Durch die
periodische Wiederholung des Spektrums ist es aber ausreichend nur den
Bereich von <span class="math notranslate nohighlight">\(0 \leq \omega\leq 2\pi\)</span> genauer zu betrachten. Um
eine diskretes Spektrum zu erhalten, unterteilen wir das Spektrum in <span class="math notranslate nohighlight">\(N\)</span>
gleichf√∂rmige Abschnitte (es kann eine beliebige Anzahl verwendet werden, eine Zweierpotenz f√ºhrt aber zu besonders effizienten L√∂sungen).</p>
<p>Die DTFT geht damit in</p>
<div class="math notranslate nohighlight" id="equation-eq-dfthin-def">
<span class="eqno">(5.12)<a class="headerlink" href="#equation-eq-dfthin-def" title="Permalink to this equation">#</a></span>\[
    X(n) = X\left(e^{j 2 \pi n / N}\right) = \sum_{k = 0}^{N-1}x(k) e^{-j 2 \pi n k /N}
\]</div>
<p>√ºber.</p>
<p>Umgekehrt ist es nat√ºrlich auch m√∂glich, aus den <span class="math notranslate nohighlight">\(N\)</span> Spektralwerten
auf die Folge <span class="math notranslate nohighlight">\(x(k)\)</span> zur√ºckzuschlie√üen. Die R√ºcktransformation</p>
<div class="math notranslate nohighlight" id="equation-eq-dftrueck-def">
<span class="eqno">(5.13)<a class="headerlink" href="#equation-eq-dftrueck-def" title="Permalink to this equation">#</a></span>\[
    x(k) = \frac{1}{N} \sum_{n = 0}^{N-1}X(n) e^{j 2 \pi n k /N}
\]</div>
<p>enth√§lt zus√§tzlich noch einen Normierungsterm <span class="math notranslate nohighlight">\(N\)</span> und unterscheidet sich sonst nur in dem Vorzeichen der e-Funktion.</p>
<p>Das Transformationsp√§rchen
<a class="reference internal" href="#equation-eq-dfthin-def">(5.12)</a> und <a class="reference internal" href="#equation-eq-dftrueck-def">(5.13)</a> werden als diskrete Fourier-Transformation (DFT), bzw.¬†inverse DFT (IDFT) bezeichnet.</p>
</section>
<section id="eigenschaften">
<h2><span class="section-number">5.3. </span>Eigenschaften<a class="headerlink" href="#eigenschaften" title="Permalink to this headline">#</a></h2>
<section id="zusammenhang-dtft-und-dft">
<h3><span class="section-number">5.3.1. </span>Zusammenhang DTFT und DFT<a class="headerlink" href="#zusammenhang-dtft-und-dft" title="Permalink to this headline">#</a></h3>
<p>Wir haben, um von der exakten Darstellung des Spektrums mittels DTFT auf
die computerl√∂sbare DFT zu kommen, zwei Ver√§nderungen vorgenommen. Und nat√ºrlich spiegeln sich diese Ver√§nderungen auch im Ergebnis wieder. Wir m√ºssen also versuchen, die Ver√§nderungen zu analysieren, um sicher zu sein, dass die DFT zumindest eine N√§herung der DTFT ist.</p>
<p>Zun√§chst ist es interessant die vorgenommene Diskretisierung im
Frequezbereich zu untersuchen. Im Grunde genommen haben wir das Spektrum
abgetastet. Die Konsequenz der Abtastung kennen wir bereits aus der
normalen Abtastung im Zeitbereich. Es kommt zu einer periodischen
Wiederholung des Spektrums. Die Abtastung im Frequenzbereich f√ºhrt zu
einer periodischen Wiederholung im Zeitbereich. Wenn man also ein Signal
analysiert und zur√ºck transformiert ergibt sich eine periodische
Wiederholung. Auch hier gibt es eine andere Interpretationsm√∂glichkeit.
Bei der Analyse von periodischen Signalen mittels Fourier-Reihen ergeben
sich diskrete Spektren. Ein diskretes Spektrum f√ºhrt im Umkehrschluss
also zu einer periodischen Zeitfunktion, wobei bei der DFT die Periode
genau <span class="math notranslate nohighlight">\(N\)</span> ist (siehe <a class="reference internal" href="#fig-dft-signalperiodizitaet"><span class="std std-numref">Abbildung 5.4</span></a>).</p>
<figure class="align-default" id="fig-dft-signalperiodizitaet">
<a class="reference internal image-reference" href="_images/DFT_SignalPeriodizitaet.png"><img alt="_images/DFT_SignalPeriodizitaet.png" src="_images/DFT_SignalPeriodizitaet.png" style="width: 75%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5.4 </span><span class="caption-text">Veranschaulichung der erzwungenen
Signalperiodizit√§t durch die
DFT.</span><a class="headerlink" href="#fig-dft-signalperiodizitaet" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Der Einfluss der Fenster-Funktion l√§sst sich zun√§chst nur durch die DTFT beschreiben. Es ist bekannt, dass eine Faltung im Zeitbereich zu einer Multiplikation im Bildbereich (Frequenzbereich) f√ºhrt. Das Umgekehrte
gilt aber auch. Eine Multiplikation im Zeitbereich, und damit die Nutzung des Fensters, ist eine Multiplikation. Sie f√ºhrt im Frequenzbereich zu einer Faltung der Spektren, wobei die Faltung hier kontinuierlich als Integral zu definieren ist, da wir ja ein kontinuierliches periodisches Spektrum haben.</p>
<div class="math notranslate nohighlight" id="equation-eq-spektrumbegrenzterfolgen">
<span class="eqno">(5.14)<a class="headerlink" href="#equation-eq-spektrumbegrenzterfolgen" title="Permalink to this equation">#</a></span>\[
    H(e^{j \Omega}) \Big|_{0 \leq n \leq N} = \int_{\theta = -\pi}^{\pi} H
    (e^{j\theta}) H^{W}(e^{j(\Omega - \theta)})\text{d}\theta
\]</div>
<p>wobei <span class="math notranslate nohighlight">\(H^{W}\)</span> die √úbertragungsfunktion der Fensterfunktion ist.</p>
<p>F√ºr das Rechteckfenster ergibt sich das Spektrum, indem wir zun√§chst die z-Transformation der Fensterfolge <span class="math notranslate nohighlight">\(w(k)\)</span> ansetzen. Es gilt</p>
<div class="math notranslate nohighlight">
\[
H^{W}(z) = \sum_{k = -\infty}^{\infty} w(k) z^{-k} = \sum_{k = 0}^{N-1} z^{-k}~~~.
\]</div>
<p>Durch einsetzen von <span class="math notranslate nohighlight">\(z = e^{j\Omega}\)</span> ergibt sich das Spektrum</p>
<div class="math notranslate nohighlight">
\[
H^{W}(z)\Big|_{z = e^{j\Omega}} = \sum_{k = 0}^{N-1} e^{-j\Omega k}~~.
\]</div>
<p>Mit der Formel der endlichen geometrischen Reihe<a class="footnote-reference brackets" href="#id7" id="id2">2</a> erh√§lt man das
Spektrum der Rechteckfunktion</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    H^{W}(e^{j \Omega}) &amp; = &amp; \frac{1-e^{-j\Omega N}}{1- e^{-j\Omega}}\\
    &amp; = &amp; \frac{e^{-j\Omega N/2} \overbrace{(e^{j\Omega N/2}- e^{-j\Omega N/2})}^{2j\sin(\Omega N/2)}}
    {e^{-j \Omega/2}\underbrace{(e^{j \Omega/2}- e^{-j\Omega/2})}_{2j\sin(\Omega/2)}}\\
    &amp; = &amp; e^{-j(N-1)\Omega/2}\frac{\sin\left(N \Omega/2
\right)}{\sin\left(\Omega/2 \right)}\end{aligned}
\end{split}\]</div>
<p>Der vordere Teil dieser Funktion entspricht einer linearen Phasenverschiebung. Der zweite Teil mit den Sinustermen stellt eine sogenannte Dirichlet-Funktion dar.
Der Betrag dieser Funktion ist in <a class="reference internal" href="#fig-dirichletfkt"><span class="std std-numref">Abbildung 5.5</span></a> gezeigt.</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Demoscript for &quot;Signalverarbeitung 1&quot;</span>
<span class="c1">#</span>
<span class="c1"># Version: 1.0   17.02.2022</span>
<span class="c1"># </span>
<span class="c1"># This software is released as public domain under CC0 1.0</span>
<span class="c1"># https://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="c1">#-------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>

<span class="c1"># determine where we&#39;re running from and set paths accordingly</span>
<span class="k">try</span><span class="p">:</span> 
    <span class="k">if</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ZMQInteractiveShell&#39;</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;../../&#39;</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">sv.mplstyle&#39;</span><span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">16</span> <span class="c1"># filter length</span>
<span class="n">freqs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span> <span class="c1"># frequency vector</span>
<span class="n">dirichlet</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">freqs</span><span class="p">)</span> 
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">freqs</span><span class="p">)):</span>
    <span class="c1"># calculate dirichlet function with sin(N*w/4)/sin(w/4)</span>
    <span class="n">dirichlet</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="n">freqs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span><span class="o">/</span> \
            <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">freqs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># normalizing</span>
<span class="n">dirichlet_abs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dirichlet</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dirichlet</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax_dirichlet</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax_dirichlet</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">dirichlet_abs</span><span class="p">)</span>
<span class="n">ax_dirichlet</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz rad/pi &#39;</span><span class="p">,</span> 
        <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Frequenzanteil normiert auf 1&#39;</span><span class="p">,</span> 
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Spektrum eines Rechteckfenster (Dirichlet-Funktion)&#39;</span><span class="p">)</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># glue this figure to paste it later (no effect outside of MyST NB)</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;DirichletFkt&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="fig-dirichletfkt" style="width: 75%">
<div class="cell_output docutils container">
<img alt="_images/spektren_12_1.png" src="_images/spektren_12_1.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 5.5 </span><span class="caption-text">Betrag von <span class="math notranslate nohighlight">\(H^{W}(e^{j \Omega})\)</span> f√ºr
<span class="math notranslate nohighlight">\(N = 16\)</span>.</span><a class="headerlink" href="#fig-dirichletfkt" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="hint admonition">
<p class="admonition-title">Beispiel: DTFT und DFT bei einer Cosinus-Schwingung</p>
<p>Um die Unterscheide zwischen DTFT und DFT bei der Spektrumsberechnung
eines Cosinus aufzuzeigen, m√ºssen wir zun√§chst das Spektrum einer abgetasteten
Cosinusschwingung berechnen:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
H(e^{j \Omega}) &amp; = &amp; \sum_{-\infty}^{\infty} \cos \left(k \Omega_0  \right) e^{-j\Omega k}\\
       &amp; = &amp; \sum_{-\infty}^{\infty} \frac{1}{2}\left( e^{j k \Omega_0} + e^{-j k \Omega_0}\right) e^{-j\Omega k}\\
       &amp; = &amp; \sum_{-\infty}^{\infty} \frac{1}{2} \left( e^{j k (\Omega_0-\Omega)} + e^{-j k (\Omega_0 + \Omega)}\right)\\
       &amp; = &amp; \sum_{-\infty}^{\infty} \frac{1}{2} e^{-j k (\Omega-\Omega_0)}
       + \sum_{-\infty}^{\infty} \frac{1}{2} e^{-j k (\Omega + \Omega_0)}\\
       &amp; = &amp; \frac{1}{2} \delta^D(\Omega - \Omega_0)
       + \frac{1}{2} \delta^D(\Omega + \Omega_0)~~~,
\end{aligned}
\end{split}\]</div>
<p>mit
<span class="math notranslate nohighlight">\(\Omega = 2\pi f / f_\text{s}\)</span>. Das hei√üt, das Spektrum des abgetasteten
Cosinus hat nur zwei definierte Frequenzwerte, an den Frequenzen
<span class="math notranslate nohighlight">\(\Omega = \pm \Omega_0\)</span>.</p>
</div>
<p>Um den Einfluss der Ann√§herung durch die DFT zu veranschaulichen,
begrenzen wir den betrachteten Signalausschnitt auf <span class="math notranslate nohighlight">\(N\)</span> Datenwerte. Dies
f√ºhrt wie in Gleichung
<a class="reference internal" href="#equation-eq-spektrumbegrenzterfolgen">(5.14)</a> gezeigt zu einer Faltung mit
dem Spektrum des Rechtecks. Durch die Siebeigenschaft der
<span class="math notranslate nohighlight">\(\delta\)</span>-Funktion ergibt sich</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    H(e^{j \Omega}) &amp; = &amp; \left(\frac{1}{2} \delta \left(\Omega - \Omega_0 \right)
       + \frac{1}{2} \delta \left(\Omega + \Omega_0 \right) \right) \ast H^{W}(e^(j \Omega)) \\
           &amp; = &amp; \frac{1}{2} H^{W} \left(e^{j(\Omega -\Omega_0 )}\right) +
                 \frac{1}{2} H^{W} \left(e^{j(\Omega + \Omega_0 )}\right).\end{aligned}
\end{split}\]</div>
<p>Das Spektrum des Rechtecks wird also, um <span class="math notranslate nohighlight">\(\pm \Omega_0\)</span> verschoben.
<a class="reference internal" href="#fig-dft-cosinus"><span class="std std-numref">Abbildung 5.6</span></a> zeigt das resultierende
Spektrum f√ºr <span class="math notranslate nohighlight">\(N =\)</span> 16 bei einer Grundfrequenz von <span class="math notranslate nohighlight">\(f_0 =\)</span> 155 Hz und einer
Abtastrate von <span class="math notranslate nohighlight">\(f_\text{s} =\)</span> 1 kHz.</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Demoscript for &quot;Signalverarbeitung 1&quot;</span>
<span class="c1">#</span>
<span class="c1"># Version: 1.0   17.02.2022</span>
<span class="c1"># </span>
<span class="c1"># This software is released as public domain under CC0 1.0</span>
<span class="c1"># https://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="c1">#-------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>

<span class="c1"># determine where we&#39;re running from and set paths accordingly</span>
<span class="k">try</span><span class="p">:</span> 
    <span class="k">if</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ZMQInteractiveShell&#39;</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;../../&#39;</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">sv.mplstyle&#39;</span><span class="p">)</span>

<span class="n">num_samples</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">f0</span> <span class="o">=</span> <span class="mi">155</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="n">sample</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">num_samples</span>

<span class="n">kk</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_samples</span><span class="p">)</span>
<span class="n">cos_series</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f0</span><span class="o">*</span><span class="n">kk</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>

<span class="n">sample</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span><span class="n">cos_series</span><span class="p">,[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">))</span>

<span class="n">reconst_sig</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">cos_series</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:],</span><span class="n">cos_series</span><span class="p">,</span><span class="n">cos_series</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]))</span>


<span class="c1"># signal reconstruction from fft through ifft</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span><span class="mi">256</span><span class="p">)</span>
<span class="n">spectrumshort</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>

<span class="n">spectrumshort</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrumshort</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrumshort</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span>
<span class="c1"># dB normalized to 0 max amplitude</span>
<span class="n">spectrum_abs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> 
<span class="c1"># frequency bins for plotting</span>
<span class="n">freqs_fft</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_abs</span><span class="p">))</span> 
<span class="n">freqs_fftshort</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrumshort</span><span class="p">))</span> 


<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="o">-</span><span class="mi">4</span><span class="p">),</span><span class="n">sample</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenndex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x[k]&#39;</span><span class="p">,</span> 
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Eingangssignal Sinus&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_fft</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz rad/pi &#39;</span><span class="p">,</span> 
        <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Frequenzanteil normiert auf 1&#39;</span><span class="p">,</span> 
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Amplitudenspektrum der gefensterten Cosinus-Fkt&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">freqs_fftshort</span><span class="p">,</span> <span class="n">spectrumshort</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz rad/pi &#39;</span><span class="p">,</span> 
        <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Frequenzanteil normiert auf 1&#39;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Abgetastetes Amplitudenspektrum&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="o">-</span><span class="mi">4</span><span class="p">),</span><span class="n">reconst_sig</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenndex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x[k]&#39;</span><span class="p">,</span> 
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;durch Abtastung des Spektrums erzieltes rekonstruiertes Signal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r:&#39;</span> <span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">15.5</span><span class="p">,</span><span class="mf">15.5</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r:&#39;</span><span class="p">)</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># glue this figure to paste it later (no effect outside of MyST NB)</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;DFT_Cosinus&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="fig-dft-cosinus" style="width: 100%">
<div class="cell_output docutils container">
<img alt="_images/spektren_15_1.png" src="_images/spektren_15_1.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 5.6 </span><span class="caption-text">Spektrum (rechts) eines
abgetasteten Cosinus (links), der auf <span class="math notranslate nohighlight">\(N = \)</span>16 Werte begrenzt wird
(<span class="math notranslate nohighlight">\(f_s = \)</span>1 kHz und <span class="math notranslate nohighlight">\(f_0 = \)</span>155 Hz).</span><a class="headerlink" href="#fig-dft-cosinus" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Um nun das DFT-Spektrum zu berechnen ist zus√§tzlich die Abtastung im
Frequenzbereich notwendig. Dies hat implizit zur Folge, dass die
Cosinusfolge periodisch wiederholt wird. Das abgetastete Spektrum ist
auf der unteren linken Seite in Abbildung
<a class="reference internal" href="#fig-dft-cosinus"><span class="std std-numref">Abbildung 5.6</span></a> zu sehen und die
resultierende Folge auf der rechten Seite.</p>
<p>Das resultierende Spektrum hat nicht das erwartete Maximum bei <span class="math notranslate nohighlight">\(f_0\)</span>, da
155 Hz nicht im Abtastraster einer 16 Punkte FFT bei einer Abtastrate
von 1 kHz liegt. Statt dessen ist die Leistung des Cosinus √ºber viele
Abtastpunkte spektral verteilt. Dieser Effekt wird auch als <em>Leakage</em>
bezeichnet.</p>
<div class="error admonition">
<p class="admonition-title">To Do</p>
<p>Beispiele mit anderen Frequenzen, um zu zeigen, dass Dirichlet-
Funktion abgetastet wird.</p>
</div>
</section>
<section id="symmetrien-der-dft">
<h3><span class="section-number">5.3.2. </span>Symmetrien der DFT<a class="headerlink" href="#symmetrien-der-dft" title="Permalink to this headline">#</a></h3>
<p>Eine der wichtigsten Symmetrien f√ºr die diskrete sowie f√ºr die
zeitdiskrete Fourier-Transformation (DFT und DTFT) ergibt sich f√ºr
reelle Signale. Aus den Eigenschaften der z-Transformation ist deutlich,
dass sich nur dann reelle Koeffizienten bei Signalen und Systemen
ergeben, wenn die Pole und Nullstellen konjugiert komplex auftreten.
Daraus folgt, dass die Spektren reeller Signale konjugiert komplex
sind. Es ergibt sich also eine Symmetrie der Spektren an der Null-Hertz-Linie (Gleichstrom). Der Realteil ist dabei achsensymmetrisch (gerade)
und der Imagin√§rteil punktsymmetrisch (ungerade). Diese Symmetrien
ergeben sich auch, wenn Betrag und Phase betrachtet werden. Der Betrag
reeller Funktionen ist immer achsensymmetrisch und die Phase
punktsymmetrisch (siehe <a class="reference internal" href="#fig-symmetrieplot"><span class="std std-numref">Abbildung 5.7</span></a>).</p>
<figure class="align-default" id="fig-symmetrieplot">
<a class="reference internal image-reference" href="_images/SymmetriePlot.png"><img alt="_images/SymmetriePlot.png" src="_images/SymmetriePlot.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5.7 </span><span class="caption-text">Beispiel eines Frequenz- und Phasenverlaufs
eines reellwertigen Systems.</span><a class="headerlink" href="#fig-symmetrieplot" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Die Symmetrien lassen sich bei der Berechnung der DFT und IDFT
ausnutzen, da immer nur das halbe Spektrum berechnet werden muss,
w√§hrend die andere H√§lfte durch Spiegelung erzeugt werden kann. H√§ufig
kommt es vor, dass man im Spektralbereich etwas berechnet und an der
dazugeh√∂rigen Zeitfolge interessiert ist (zum Beispiel bei einen
Filterentwurf). Es reicht aus, f√ºr eine <span class="math notranslate nohighlight">\(N\)</span>-Punkte DFT, <span class="math notranslate nohighlight">\(N/2+1\)</span>
Spektralwerte zu kennen. Man ben√∂tigt einen Wert mehr, da die DFT f√ºr
die h√∂chste Frequenz bei <span class="math notranslate nohighlight">\(f_\text{s}/2\)</span> nur einen reellwertigen Koeffizienten
besitzt. Die Kopiervorschrift in Matlab sieht dann wie folgt aus, wobei
wir annehmen, dass die <span class="math notranslate nohighlight">\(N/2+1\)</span> Werte in <code class="docutils literal notranslate"><span class="pre">H_halb</span></code> gespeichert sind.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="d49d3a60-3bbf-4930-8faf-a02a782c2fcc" name="bda2b842-67d0-4d1e-af46-ba5bf350e1dc" type="radio">
</input><label class="sd-tab-label" for="d49d3a60-3bbf-4930-8faf-a02a782c2fcc">
Matlab</label><div class="sd-tab-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">H_voll</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="n">H_halb</span><span class="w"> </span><span class="nb">conj</span><span class="p">(</span><span class="n">H_halb</span><span class="p">(</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">))];</span><span class="w"></span>
</pre></div>
</div>
</div>
<input id="b11049d2-9f28-4729-83f2-651b6bc02f40" name="bda2b842-67d0-4d1e-af46-ba5bf350e1dc" type="radio">
</input><label class="sd-tab-label" for="b11049d2-9f28-4729-83f2-651b6bc02f40">
Python</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="n">H_halb_c</span> <span class="o">=</span> <span class="n">H_halb</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">}]</span>
    <span class="n">H_voll</span> <span class="o">=</span> <span class="n">H_halb</span> <span class="o">+</span> <span class="n">H_halb_c</span>
</pre></div>
</div>
</div>
</div>
<p>Entsteht nach der R√ºcktransformation eine rein reellwertige Folge, wurden alle Symmetrien richtig aufgebaut. Dies kann als Gegenprobe verwendet werden, wobei die resultierende Variable durch Rundungsfehler bei der elektronischen Verarbeitung immer komplex ist. Es ist deshalb notwendig, den Betrag des
Imagin√§ranteils zu √ºberpr√ºfen. Dieser sollte Werte um
<span class="math notranslate nohighlight">\(10^{-7}\)</span> nicht √ºberschreiten.</p>
<p>Wie l√§sst sich die Symmetriebedingung mathematisch zeigen?</p>
<p>Ausgehend von</p>
<div class="math notranslate nohighlight">
\[
X(n) = \sum_{k = 0}^{N-1} x(k) e^{-jkn2\pi/N}
\]</div>
<p>ergibt sich f√ºr die an der y-Achse gespiegelte Folge durch Variablensubstitution</p>
<div class="math notranslate nohighlight">
\[
X(-n) = \sum_{k = 0}^{N-1} x(k) e^{jkn2\pi/N}~~~.
\]</div>
<p>Konjugiert man dieses Signal ergibt sich</p>
<div class="math notranslate nohighlight">
\[
X^{\ast}(-n)   =  \sum_{k = 0}^{N-1} 
    e^{-jkn2\pi/N}~~~, 
\]</div>
<p>wobei der negative Exponent zu beachten ist. F√ºr ein reelwertiges Signal gilt <span class="math notranslate nohighlight">\(x^{\ast}(k) = x(k)\)</span>, woraus folgt, dass</p>
<div class="math notranslate nohighlight">
\[
X^{\ast}(-n)   =  X(n)~~~. 
\]</div>
<section id="spektren-reeller-gerader-folgen">
<h4><span class="section-number">5.3.2.1. </span>Spektren reeller gerader Folgen<a class="headerlink" href="#spektren-reeller-gerader-folgen" title="Permalink to this headline">#</a></h4>
<p>Die Symmetriebedingung reeller gerader Folgen kann aus den vorherigen
√úberlegungen geschlossen werden. Da gerade Funktionen achsensymmetrisch
sind, der Imagin√§rteil aber punktsymmetrisch, k√∂nnen wir schlie√üen, dass
reelle, gerade Funktionen ein reelles, gerades Spektrum haben.</p>
</section>
</section>
<section id="rechenregeln">
<h3><span class="section-number">5.3.3. </span>Rechenregeln<a class="headerlink" href="#rechenregeln" title="Permalink to this headline">#</a></h3>
<section id="linearitat">
<h4><span class="section-number">5.3.3.1. </span>Linearit√§t<a class="headerlink" href="#linearitat" title="Permalink to this headline">#</a></h4>
<p>Die DFT ist eine lineare Transformation. Es gilt also das
Superpositionsprinzip</p>
<div class="math notranslate nohighlight" id="equation-eq-dft-linearitaet">
<span class="eqno">(5.15)<a class="headerlink" href="#equation-eq-dft-linearitaet" title="Permalink to this equation">#</a></span>\[
  a_1 x_1(k) + a_2 x_2(k) ;\circ \hskip-1ex -\hskip-1.2ex -\hskip-1.2ex- \hskip-1ex \bullet\; a_1 X_1(n) + a_2 X_2(n)~~~.
\]</div>
</section>
<section id="faltung">
<span id="sec-dft-faltung"></span><h4><span class="section-number">5.3.3.2. </span>Faltung<a class="headerlink" href="#faltung" title="Permalink to this headline">#</a></h4>
<p>Bisher haben wir bereits die Faltung bei der z-Transformation kennen
gelernt und den √úbergang der Faltung in die Multiplikation in der
z-Ebene. Dieser Zusammenhang gilt auch f√ºr die DTFT, aber nicht so
direkt f√ºr die DFT. Um das zu veranschaulichen, kann ein einfaches
Beispiel dienen. Gehen wir davon aus, dass wir eine Folge mit <span class="math notranslate nohighlight">\(N = 8\)</span>
Werten mit Hilfe der DFT in den Bildbereich transformieren. Wir erhalten
8 Frequenzpunkte. Des Weiteren transformieren wir eine zweite Folge mit
8 Datenwerten. Wir erhalten erneut 8 Spektralwerte. Multiplizieren wir
diese beiden Spektren und f√ºhren eine R√ºcktransformation durch, so
besteht das Ergebnis auch aus 8 Werten im Zeitbereich. Aus der
Faltungsalgebra wissen wir aber, dass das Faltungsprodukt aus <span class="math notranslate nohighlight">\(L+M-1\)</span>
Elementen bestehen muss, in diesem Beispiel also 15 Datenwerte. Daraus
folgt, dass die Faltung nicht der Multiplikation mit den
DFT-Spektralwerten entspricht.</p>
<p>Die Ursache hierf√ºr ist in der implizierten Periodizit√§t der DFT zu
finden. Das DFT Spektrum ist gerade nicht das Signal im betrachteten
Zeitfenster, sondern ein Signal das periodisch fortgesetzt ist. Die
Multiplikation im Frequenzbereich f√ºhrt deshalb auf eine Faltung dieser
periodisch fortgesetzten Sequenzen. Dies f√ºhrt dazu, dass auch das
Faltungsprodukt periodisch ist. Man spricht deshalb von der zyklischen
Faltung. Das Ergebnis kann sich vollst√§ndig von dem gew√ºnschten Ergebnis
unterscheiden. Dies wird in <a class="reference internal" href="#fig-bspzyklischefaltung"><span class="std std-numref">Abbildung 5.8</span></a> demonstriert. Die beiden Folgen
(a, b) ergeben bei der Faltung im Zeitbereich die Folge c. Die L√∂sung mit
Hilfe der DFT f√ºhrt auf die Folge d.</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Demoscript for &quot;Signalverarbeitung 1&quot;</span>
<span class="c1">#</span>
<span class="c1"># Version: 1.0   17.02.2022</span>
<span class="c1"># </span>
<span class="c1"># This software is released as public domain under CC0 1.0</span>
<span class="c1"># https://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="c1">#-------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>

<span class="c1"># determine where we&#39;re running from and set paths accordingly</span>
<span class="k">try</span><span class="p">:</span> 
    <span class="k">if</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ZMQInteractiveShell&#39;</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;../../&#39;</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">sv.mplstyle&#39;</span><span class="p">)</span>

<span class="c1"># input samples</span>
<span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">]</span>

<span class="c1"># usual convolution</span>
<span class="n">usual_convolution</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="c1"># cyclical convolution, equal to multiplying spectra</span>
<span class="n">dft_spektrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="n">zyklische_faltung</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">dft_spektrum</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="p">((</span><span class="n">ax_a</span><span class="p">,</span> <span class="n">ax_b</span><span class="p">),</span> <span class="p">(</span><span class="n">ax_ab</span><span class="p">,</span> <span class="n">ax_fft</span><span class="p">))</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">ax_a</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax_a</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenndex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x[k]&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Signal A&#39;</span><span class="p">)</span>
<span class="n">ax_b</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax_b</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenndex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x[k]&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Signal B&#39;</span><span class="p">)</span>
<span class="n">ax_ab</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">usual_convolution</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax_ab</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenndex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">,</span> 
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Konventionelle Faltung&#39;</span><span class="p">)</span>
<span class="n">ax_fft</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">zyklische_faltung</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax_fft</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenndex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">,</span> 
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Zyklische Faltung&#39;</span><span class="p">)</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># glue this figure to paste it later (no effect outside of MyST NB)</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;BspZyklischeFaltung&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="fig-bspzyklischefaltung" style="width: 100%">
<div class="cell_output docutils container">
<img alt="_images/spektren_21_2.png" src="_images/spektren_21_2.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 5.8 </span><span class="caption-text">Beispiel f√ºr zyklische Faltung. Die
beiden Folgen (Bild a,b) ergeben bei konventioneller Faltung Bild c.
Bild d zeigt das Resultat f√ºr die direkte Faltung im Frequenzbereich mit
Hilfe der DFT.</span><a class="headerlink" href="#fig-bspzyklischefaltung" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Um die zyklischen Faltungsprodukte zu verhindern ist es notwendig Nullen
an die zu transformierenden Folgen anzuh√§ngen (<em>Zero-Padding</em>) und eine
entsprechend gr√∂√üere Transformationsl√§nge zu w√§hlen. Dies f√ºhrt dazu,
dass die implizite Periodizit√§t die Nullen einschlie√üt. Die Nullen
ver√§ndern das Spektrum nicht, sondern nur die Frequenzaufl√∂sung<a class="footnote-reference brackets" href="#id8" id="id3">3</a>. Die
R√ºcktransformation f√ºhrt zu der gew√ºnschten Faltungsfolge, wobei durch
die vorher eingebrachten Nullen keine zyklischen Faltungsprodukte das
Ergebnis verf√§lschen. Bei dem obigen Beispiel w√ºrde sich das Ergebnis in
<a class="reference internal" href="#fig-bspzyklischefaltung"><span class="std std-numref">Abbildung 5.8</span></a> c ergeben, wenn an die Folgen a und
b jeweils 8 Nullen angeh√§ngt werden und die DFT L√§nge auf 16 erh√∂ht
wird.</p>
<div class="error admonition">
<p class="admonition-title">To Do</p>
<p>Einfacheres Beispiel mit Rechteck und Dreiecksfunktionen, bei denen die Wiederholungen eingezeichnet sind.</p>
</div>
</section>
<section id="theorem-von-parseval">
<h4><span class="section-number">5.3.3.3. </span>Theorem von Parseval<a class="headerlink" href="#theorem-von-parseval" title="Permalink to this headline">#</a></h4>
<p>Das Theorem von Parseval sagt aus, dass man die Energie eines Signals im
Zeit, oder im Frequenzbereich berechnen kann, bzw. dass die Leistung
eines Signals im Zeit- und Frequenzbereich gleich ist. F√ºr
die DTFT gilt</p>
<div class="math notranslate nohighlight" id="equation-eq-parsevaldtft">
<span class="eqno">(5.16)<a class="headerlink" href="#equation-eq-parsevaldtft" title="Permalink to this equation">#</a></span>\[
    \sum_{k = -\infty}^{\infty} x^2(k) = \frac{1}{2\pi} \int_{-\pi}^{\pi} \left|X(e^(j \Omega)) \right|^2 \text{d}\Omega~~~, 
\]</div>
<p>bzw. f√ºr die DFT</p>
<div class="math notranslate nohighlight" id="equation-eq-parsevaldft">
<span class="eqno">(5.17)<a class="headerlink" href="#equation-eq-parsevaldft" title="Permalink to this equation">#</a></span>\[
    \sum_{k = 0}^{N-1} x^2(k) = \frac{1}{N}\sum_{n = 0}^{N-1} |X(n)|^2~~~.
\]</div>
</section>
</section>
<section id="effiziente-implementierung">
<h3><span class="section-number">5.3.4. </span>Effiziente Implementierung<a class="headerlink" href="#effiziente-implementierung" title="Permalink to this headline">#</a></h3>
<p>Die DFT l√§sst sich durch Ausnutzung unterschiedlicher Symmetrien sehr
effizient berechnen. Um dies zu verdeutlichen, soll das sogenannten <em>Decimation
in Time</em>-Verfahren zur drastischen Reduktion der ben√∂tigten
Rechenleistung genauer gezeigt werden. Andere Verfahren k√∂nnen in der
sehr umfangreichen Literatur zur Entwicklung der Fast Fourier
Transform (FFT) gefunden werden <span id="id4">[<a class="reference internal" href="zbibliography.html#id5" title="James W. Cooley. How the FFT gained acceptance. In S. G. Nash, editor, A History of Scientific Computing, 133-140. Reading, Massachusetts, 1990. ACM Press, Addison-Wesley.">Coo90</a>, <a class="reference internal" href="zbibliography.html#id3" title="K. D. Kammeyer and K. Kroschel. Digitale Signalverarbeitung: Filterung und Spektralanalyse. Teubner, Stuttgart, 3. edition, 1998.">KK98</a>, <a class="reference internal" href="zbibliography.html#id4" title="A. V. Oppenheim and R. W. Schafer. Zeitdiskrete Signalverarbeitung. Oldenbourg, 1999.">OS99</a>]</span>.</p>
<p>Um eine effiziente Realisierung zu finden, legen wir die L√§nge der FFT als Zweierpotenz fest. Besonders h√§ufig in der
Audio und Sprachsignalverarbeitung genutzte FFT-L√§ngen sind 256, 512,
1024 und 2048. Durch diese Forderung ist es m√∂glich, die Folge in zwei
Teilfolgen zu zerlegen, wobei wir immer abwechselnd die Elemente der
Folge den jeweiligen neuen Teilfolgen zuordnen. Es ergeben sich die
Folgen <span class="math notranslate nohighlight">\(x(2k)\)</span> und <span class="math notranslate nohighlight">\(x(2k+1)\)</span> (siehe <a class="reference internal" href="#fig-decimationintime"><span class="std std-numref">Abbildung 5.9</span></a>).</p>
<figure class="align-default" id="fig-decimationintime">
<a class="reference internal image-reference" href="_images/DecimationInTime.png"><img alt="_images/DecimationInTime.png" src="_images/DecimationInTime.png" style="width: 60%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5.9 </span><span class="caption-text">Aufteilung einer Sequenz in zwei
Teilsequenzen zur Erkl√§rung der FFT (Decimation in
Time)</span><a class="headerlink" href="#fig-decimationintime" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Die Konsequenzen f√ºr die DFT lassen sich nun wie folgt berechnen:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
 \nonumber
\sum_{k = 0}^{N-1} x(k) e^{-j 2 \pi n k /N} &amp; = &amp;
\sum_{k = 0}^{\frac{N}{2}-1} \underbrace{x(2k)}_{u(k)} e^{-j 2 \pi n 2k /N} +
\sum_{k = 0}^{\frac{N}{2}-1} \underbrace{x(2k+1)}_{v(k)} e^{-j 2 \pi n (2k+1) /N} \\\nonumber
&amp; = &amp; \underbrace{\sum_{k = 0}^{\frac{N}{2}-1}u(k) e^{-j 2 \pi n k /\frac{N}{2}}}_{U(n) \qquad \mbox {N/2 DFT}} +
e^{-j2\pi n /N} \underbrace{\sum_{k = 0}^{\frac{N}{2}-1}
v(k) e^{-j 2 \pi n k /\frac{N}{2}}}_{V(n) \qquad \mbox {N/2 DFT}}\\
X(n) &amp; = &amp; U(n) + e^{-j2\pi n /N} V(n)\end{aligned}
\end{split}\]</div>
<p>Die N-Punkte DFT
l√§sst sich also in zwei N/2-Punkte DFT zerlegen. Hierbei tritt jetzt das
Problem auf, dass die Folgen <span class="math notranslate nohighlight">\(U(n)\)</span> und <span class="math notranslate nohighlight">\(V(n)\)</span> nur bis <span class="math notranslate nohighlight">\(N/2\)</span> definiert
sind, da ja auch nur eine N/2 DFT durchgef√ºhrt wurde. Die L√∂sung f√ºr
dieses Problem ist durch die Periodizit√§t der DFT aber sehr einfach zu
umgehen, da sich das Spektrum immer wiederholt.</p>
<p>Aber warum stellt es einen Vorteil dar, wenn man die DFT so zerlegen
kann? Um eine diskrete Frequenz zu berechnen sind <span class="math notranslate nohighlight">\(N\)</span> komplexe
Multiplikationen n√∂tig. Dieser Schritt muss f√ºr alle diskreten Frequenzen
durchgef√ºhrt werden. Die Berechnung des vollst√§ndigen Spektrums ben√∂tigt
also <span class="math notranslate nohighlight">\(N^2\)</span> Multiplikationen. Teilen wir die Aufgabe in zwei Teilspektren
ben√∂tigt man <span class="math notranslate nohighlight">\(2\left(\frac{N}{2}\right)^2\)</span> + <span class="math notranslate nohighlight">\(N\)</span> Multiplikationen f√ºr
den Drehfaktor vor <span class="math notranslate nohighlight">\(V(n)\)</span>. Im Vergleich ergeben sich f√ºr <span class="math notranslate nohighlight">\(N = 8\)</span> einmal
64 Multiplikationen und f√ºr die aufgeteilten Spektren 40
Multiplikationen. Der Schritt der Aufteilung kann nun solange wiederholt
werden, bis die Folge nicht weiter aufgeteilt werden kann (<span class="math notranslate nohighlight">\(N = 2\)</span>).
Zus√§tzlich k√∂nnen einige Multiplikationen vernachl√§ssigt werden, da
<span class="math notranslate nohighlight">\(e^{j0} = 1\)</span> ist. Eine Reduktion auf
<span class="math notranslate nohighlight">\(\frac{N}{2}\left( \text{ld}\left(\frac{N}{2}\right) \right)\)</span> ist so m√∂glich (ld = Logarithmus zur Basis 2, <em>logarithmus dualis</em>). Somit
ergibt sich eine im rechenaufwand stark reduzierte DFT, die als
<em>Fast Fourier Transform</em> (FFT) bekannt ist<a class="footnote-reference brackets" href="#id9" id="id5">5</a>.</p>
</section>
</section>
<section id="spezielle-signale-und-ihre-spektren">
<h2><span class="section-number">5.4. </span>Spezielle Signale und ihre Spektren<a class="headerlink" href="#spezielle-signale-und-ihre-spektren" title="Permalink to this headline">#</a></h2>
<section id="spektrum-fur-delta-k">
<h3><span class="section-number">5.4.1. </span>Spektrum f√ºr <span class="math notranslate nohighlight">\(\delta(k)\)</span><a class="headerlink" href="#spektrum-fur-delta-k" title="Permalink to this headline">#</a></h3>
<p>Berechnet man die DTFT f√ºr den <span class="math notranslate nohighlight">\(\delta\)</span>-Impuls ergibt sich</p>
<div class="math notranslate nohighlight" id="equation-eq-spektrumdeltaimpuls">
<span class="eqno">(5.18)<a class="headerlink" href="#equation-eq-spektrumdeltaimpuls" title="Permalink to this equation">#</a></span>\[
    X(e^{j \Omega}) = \sum_{k = -\infty}^{\infty} \delta(k)e^{-jk \Omega} =e^{-j0 \Omega} = 1~~~,
\]</div>
<p>da der <span class="math notranslate nohighlight">\(\delta\)</span>-Impuls ausschlie√ülich an der Stelle <span class="math notranslate nohighlight">\(k = 0\)</span> definiert
ist. Der Betrag des Spektrums ist also eins f√ºr alle Frequenzen und die
Phase ist null f√ºr alle Frequenzen.</p>
</section>
<section id="spektrum-fur-delta-k-k-0">
<h3><span class="section-number">5.4.2. </span>Spektrum f√ºr <span class="math notranslate nohighlight">\(\delta(k-k_0)\)</span><a class="headerlink" href="#spektrum-fur-delta-k-k-0" title="Permalink to this headline">#</a></h3>
<p>Der um <span class="math notranslate nohighlight">\(k_0\)</span> verschobene <span class="math notranslate nohighlight">\(\delta\)</span>-Impuls f√ºhrt zu einem etwas anderem
Spektrum</p>
<div class="math notranslate nohighlight" id="equation-eq-spektrumdeltaimpulsverschoben">
<span class="eqno">(5.19)<a class="headerlink" href="#equation-eq-spektrumdeltaimpulsverschoben" title="Permalink to this equation">#</a></span>\[
    X(e^{j \Omega}) = \sum_{k = -\infty}^{\infty} \delta(k-k_0)e^{-jk \Omega} =e^{-jk_0 \Omega}~~~.
\]</div>
<p>Das Spektrum ist im Betrag ebenfalls Eins f√ºr alle Frequenzen, aber die
Phase des Signals wird linear abh√§ngig von der Frequenz ver√§ndert, wenn
ein <span class="math notranslate nohighlight">\(\delta(k)\)</span> ein System darstellt.</p>
</section>
</section>
<section id="weitere-fensterfunktionen-und-deren-eigenschaften">
<h2><span class="section-number">5.5. </span>Weitere Fensterfunktionen und deren Eigenschaften<a class="headerlink" href="#weitere-fensterfunktionen-und-deren-eigenschaften" title="Permalink to this headline">#</a></h2>
<p>Wir haben gesehen, dass die DFT f√ºr eine zeitlich beschr√§nkte Funktion
auch als Multiplikation mit einer Fensterfunktion interpretiert werden
kann. Dieses Fenster hatte einen deutlichen Einfluss auf das
dargestellte Spektrum. Zur Beschreibung der Eigenschaften des Fensters
im Frequenzbereich wird h√§ufig die spektrale Aufl√∂sung des Maximums zu
den 3 dB Punkten verwendet. Weiterhin ist die H√∂he der n√§chsten Maxima (Betrag) interessant. F√ºr das Rechteckfenster sind
diese beiden Gr√∂√üen durch <span class="math notranslate nohighlight">\(2pi/N\)</span> und <span class="math notranslate nohighlight">\(\approx 13\)</span> dB gegeben. Etwas
anders sieht dies bei anderen Fensterfunktionen aus (siehe <a class="reference internal" href="#fig-rechteckwindow"><span class="std std-numref">Abbildung 5.10</span></a>
bis <a class="reference internal" href="#fig-kaiserwindow-a4"><span class="std std-numref">Abbildung 5.16</span></a>)</p>
<div class="hint admonition">
<p class="admonition-title">Interaktiv arbeiten</p>
<ol class="simple">
<li><p>Starten des interaktiven Programms - <code class="docutils literal notranslate"><span class="pre">Spektren_Fenster.py</span></code> in <code class="docutils literal notranslate"><span class="pre">jupyterbook/code/interactive_programs/</span></code></p></li>
<li><p>Mit den Buttons kann der Fenstertyp ge√§ndert und</p></li>
<li><p>mit Slidern die Fensterparameter gesteuert werden. Hier kann auch eine eigene Fensterfunktion designt werden.</p></li>
</ol>
</div>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Demoscript for &quot;Signalverarbeitung 1&quot;</span>
<span class="c1">#</span>
<span class="c1"># Version: 1.0   17.02.2022</span>
<span class="c1"># </span>
<span class="c1"># This software is released as public domain under CC0 1.0</span>
<span class="c1"># https://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="c1">#-------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>

<span class="c1"># determine where we&#39;re running from and set paths accordingly</span>
<span class="k">try</span><span class="p">:</span> 
    <span class="k">if</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ZMQInteractiveShell&#39;</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;../../&#39;</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">sv.mplstyle&#39;</span><span class="p">)</span>

<span class="c1"># create a rectengular window</span>
<span class="n">rect_window</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">30</span><span class="o">+</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="c1"># and do zero padding</span>
<span class="n">rect_window</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">rect_window</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">])</span>

<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">rect_window</span><span class="p">)</span>
<span class="n">mid</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># shift area from pi -&gt; 2pi to -pi -&gt; 0</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">spectrum</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">):],</span> <span class="n">spectrum</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">)]])</span> 
<span class="c1"># dB maximum = 0dB</span>
<span class="n">spectrum_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> 
<span class="n">freqs_fft</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_abs</span><span class="p">))</span> <span class="c1"># freq bins, for plotting</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_sample</span><span class="p">,</span> <span class="n">ax_spectrum</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax_sample</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rect_window</span><span class="p">)</span>
<span class="n">ax_sample</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenndex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x[k]&#39;</span><span class="p">,</span> 
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">31</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Rechteck-Fenster im Frequenzbereich&#39;</span><span class="p">)</span>

<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_fft</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">)</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz rad/pi &#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;D√§mpfung in dB&#39;</span><span class="p">,</span> 
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Rechteck-Fenster im Frequenzbereich&#39;</span><span class="p">)</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># glue this figure to paste it later (no effect outside of MyST NB)</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;RechteckWindow&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="fig-rechteckwindow" style="width: 100%">
<div class="cell_output docutils container">
<img alt="_images/spektren_26_1.png" src="_images/spektren_26_1.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 5.10 </span><span class="caption-text">Zeitliche und spektrale Eigenschaft des Rechteckfensters</span><a class="headerlink" href="#fig-rechteckwindow" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Als Ursache f√ºr das Verschmieren im Frequenzbereich wurde die Faltung
mit der Fensterfunktion genannt. Die Ursache im Zeitbereich hierf√ºr war
das abrupte Abschneiden, dass durch die angenommene zirkulare
Wiederholung zu einem nicht-repr√§sentativen Ausschnitt f√ºhrte. Deshalb
ist eine Design-Idee f√ºr andere Fenster eine m√∂glichst weiche
Ausblendung zu den R√§ndern zu erm√∂glichen. Fenster die diese Eigenschaft
besitzen k√∂nnen zum Beispiel durch Cosinusfunktionen realisiert werden.</p>
<p>Eine generalisierte Version ergibt sich dabei zu</p>
<div class="math notranslate nohighlight" id="equation-eq-windowfunction-general">
<span class="eqno">(5.20)<a class="headerlink" href="#equation-eq-windowfunction-general" title="Permalink to this equation">#</a></span>\[
   w(k) = \alpha - \beta \cos(2\pi k /N) + \gamma \cos(4\pi k /N) \quad mit \quad 0\leq k
   &lt; N
\]</div>
<p>Durch Ver√§nderung der drei Parameter <span class="math notranslate nohighlight">\(\alpha, \beta, \gamma\)</span> k√∂nnen die
bekanntesten Fenster-Funktionen angegeben werden<a class="footnote-reference brackets" href="#id10" id="id6">6</a>.</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Demoscript for &quot;Signalverarbeitung 1&quot;</span>
<span class="c1">#</span>
<span class="c1"># Version: 1.0   17.02.2022</span>
<span class="c1"># </span>
<span class="c1"># This software is released as public domain under CC0 1.0</span>
<span class="c1"># https://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="c1">#-------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>

<span class="c1"># determine where we&#39;re running from and set paths accordingly</span>
<span class="k">try</span><span class="p">:</span> 
    <span class="k">if</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ZMQInteractiveShell&#39;</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;../../&#39;</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">von_hann_window</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">N</span>

<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">von_hann_window</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">idx</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>
<span class="n">von_hann_window</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">von_hann_window</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">])</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">von_hann_window</span><span class="p">)</span>
<span class="n">mid</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># shift area from pi -&gt; 2pi to -pi -&gt; 0</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">spectrum</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">):],</span> <span class="n">spectrum</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">)]])</span> 
<span class="c1"># dB maximum = 0dB</span>
<span class="n">spectrum_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> 
<span class="n">freqs_fft</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_abs</span><span class="p">))</span> <span class="c1"># freq bins, for plotting</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_sample</span><span class="p">,</span> <span class="n">ax_spectrum</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax_sample</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">von_hann_window</span><span class="p">)</span>
<span class="n">ax_sample</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenndex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x[k]&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Von-Hann-Fenster im Zeitbereich&#39;</span><span class="p">)</span>

<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_fft</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">)</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz rad/pi &#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;D√§mpfung in dB&#39;</span><span class="p">,</span> 
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Von-Hann-Fenster im Frequenzbereich&#39;</span><span class="p">)</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># glue this figure to paste it later (no effect outside of MyST NB)</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;HannWindow&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Demoscript for &quot;Signalverarbeitung 1&quot;</span>
<span class="c1">#</span>
<span class="c1"># Version: 1.0   17.02.2022</span>
<span class="c1"># </span>
<span class="c1"># This software is released as public domain under CC0 1.0</span>
<span class="c1"># https://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="c1">#-------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>

<span class="c1"># determine where we&#39;re running from and set paths accordingly</span>
<span class="k">try</span><span class="p">:</span> 
    <span class="k">if</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ZMQInteractiveShell&#39;</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;../../&#39;</span>
    
<span class="n">N</span> <span class="o">=</span> <span class="mi">32</span> <span class="c1"># window length</span>

<span class="c1"># calculate window samples by sample</span>
<span class="n">hamming_window</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">N</span> 
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">hamming_window</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.54</span> <span class="o">-</span> <span class="mf">0.46</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">idx</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>

<span class="n">hamming_window</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">hamming_window</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100000</span><span class="p">])</span> <span class="c1"># zero padding</span>

<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">hamming_window</span><span class="p">)</span>
<span class="n">mid</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># shift area from pi -&gt; 2pi to -pi -&gt; 0</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">spectrum</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">):],</span> <span class="n">spectrum</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">)]])</span> 
<span class="c1"># dB maximum = 0dB</span>
<span class="n">spectrum_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> 
<span class="n">freqs_fft</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_abs</span><span class="p">))</span> <span class="c1"># freq bins, for plotting</span>

<span class="c1"># time plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_sample</span><span class="p">,</span> <span class="n">ax_spectrum</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax_sample</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hamming_window</span><span class="p">)</span>
<span class="n">ax_sample</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenndex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x[k]&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Hamming-Fenster im Zeitbereich&#39;</span><span class="p">)</span>

<span class="c1"># spectral plot</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_fft</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">)</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz rad/pi &#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;D√§mpfung in dB&#39;</span><span class="p">,</span> 
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Hamming-Fenster im Frequenzbereich&#39;</span><span class="p">)</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># glue this figure to paste it later (no effect outside of MyST NB)</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;HammingWindow&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Demoscript for &quot;Signalverarbeitung 1&quot;</span>
<span class="c1">#</span>
<span class="c1"># Version: 1.0   17.02.2022</span>
<span class="c1"># </span>
<span class="c1"># This software is released as public domain under CC0 1.0</span>
<span class="c1"># https://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="c1">#-------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>

<span class="c1"># determine where we&#39;re running from and set paths accordingly</span>
<span class="k">try</span><span class="p">:</span> 
    <span class="k">if</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ZMQInteractiveShell&#39;</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;../../&#39;</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">32</span> <span class="c1"># window length</span>

<span class="c1"># calculate window samples by sample</span>
<span class="n">blackman_window</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">N</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">blackman_window</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.42</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">idx</span><span class="o">/</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> \
            <span class="mf">0.08</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">idx</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>
<span class="n">blackman_window</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">blackman_window</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">])</span>


<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">blackman_window</span><span class="p">)</span>
<span class="n">mid</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># shift area from pi -&gt; 2pi to -pi -&gt; 0</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">spectrum</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">):],</span> <span class="n">spectrum</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">)]])</span> 
<span class="c1"># dB maximum = 0dB</span>
<span class="n">spectrum_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> 
<span class="n">freqs_fft</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_abs</span><span class="p">))</span> <span class="c1"># freq bins, for plotting</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_sample</span><span class="p">,</span> <span class="n">ax_spectrum</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># time plot</span>
<span class="n">ax_sample</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">blackman_window</span><span class="p">)</span>
<span class="n">ax_sample</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenndex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x[k]&#39;</span><span class="p">,</span> 
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Blackman-Fenster im Zeitbereich&#39;</span><span class="p">)</span>

<span class="c1"># spectral plot</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_fft</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">)</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz rad/pi &#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;D√§mpfung in dB&#39;</span><span class="p">,</span> 
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Blackman-Fenster im Frequenzbereich&#39;</span><span class="p">)</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># glue this figure to paste it later (no effect outside of MyST NB)</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;BlackmanWindow&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Demoscript for &quot;Signalverarbeitung 1&quot;</span>
<span class="c1">#</span>
<span class="c1"># Version: 1.0   17.02.2022</span>
<span class="c1"># </span>
<span class="c1"># This software is released as public domain under CC0 1.0</span>
<span class="c1"># https://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="c1">#-------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>

<span class="c1"># determine where we&#39;re running from and set paths accordingly</span>
<span class="k">try</span><span class="p">:</span> 
    <span class="k">if</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ZMQInteractiveShell&#39;</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;../../&#39;</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">32</span> <span class="c1"># window length</span>

<span class="c1"># create window in time domains</span>
<span class="n">dolph_cheb_win</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">chebwin</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">at</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="n">dolph_cheb_win</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">dolph_cheb_win</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">])</span>

<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">dolph_cheb_win</span><span class="p">)</span>
<span class="n">mid</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># shift area from pi -&gt; 2pi to -pi -&gt; 0</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">spectrum</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">):],</span> <span class="n">spectrum</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">)]])</span> 
<span class="c1"># dB maximum = 0dB</span>
<span class="n">spectrum_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> 
<span class="n">freqs_fft</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_abs</span><span class="p">))</span> <span class="c1"># freq bins, for plotting</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_sample</span><span class="p">,</span> <span class="n">ax_spectrum</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax_sample</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dolph_cheb_win</span><span class="p">)</span>
<span class="n">ax_sample</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenndex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x[k]&#39;</span><span class="p">,</span> 
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Dolph-Tschebyscheff-Fenster im Zeitbereich&#39;</span><span class="p">)</span>

<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_fft</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">)</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz rad/pi &#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;D√§mpfung in dB&#39;</span><span class="p">,</span> 
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Dolph-Tschebyscheff-Fenster im Frequenzbereich&#39;</span><span class="p">)</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># glue this figure to paste it later (no effect outside of MyST NB)</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;ChebWindow&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Demoscript for &quot;Signalverarbeitung 1&quot;</span>
<span class="c1">#</span>
<span class="c1"># Version: 1.0   17.02.2022</span>
<span class="c1"># </span>
<span class="c1"># This software is released as public domain under CC0 1.0</span>
<span class="c1"># https://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="c1">#-------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>

<span class="c1"># determine where we&#39;re running from and set paths accordingly</span>
<span class="k">try</span><span class="p">:</span> 
    <span class="k">if</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ZMQInteractiveShell&#39;</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;../../&#39;</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">32</span> <span class="c1"># window length</span>

<span class="c1"># create windows in time domain</span>
<span class="n">k4_window</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">kaiser</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">k2_window</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">kaiser</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1"># zero pad</span>
<span class="n">k4_window</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">k4_window</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">])</span>
<span class="n">k2_window</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">k2_window</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">])</span>


<span class="n">spectrum_k4</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">k4_window</span><span class="p">)</span>
<span class="n">spectrum_k2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">k2_window</span><span class="p">)</span>

<span class="n">mid</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">spectrum_k4</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># shift pi -&gt; 2*pi to -pi -&gt; 0</span>
<span class="n">spectrum_k4</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">spectrum_k4</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">):],</span> <span class="n">spectrum_k4</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">)]])</span>
<span class="n">spectrum_k2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">spectrum_k2</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">):],</span> <span class="n">spectrum_k2</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">)]])</span>
<span class="c1"># dB normalized to maximum amplitude=0dB</span>
<span class="n">spectrum_k4_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span>
        <span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum_k4</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum_k4</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">spectrum_k2_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span>
        <span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum_k2</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum_k2</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="c1"># frequency bins, for plotting</span>
<span class="n">freqs_fft_k4</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_k4_abs</span><span class="p">))</span>
<span class="n">freqs_fft_k2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_k2_abs</span><span class="p">))</span>

<span class="c1"># time and frequency domain plots of beta = 4</span>
<span class="n">fig1</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_sample_k4</span><span class="p">,</span> <span class="n">ax_spectrum_k4</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax_sample_k4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k4_window</span><span class="p">)</span>
<span class="n">ax_spectrum_k4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_fft_k4</span><span class="p">,</span> <span class="n">spectrum_k4_abs</span><span class="p">)</span>
<span class="n">ax_sample_k4</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenndex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x[k]&#39;</span><span class="p">,</span> 
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Kaiser-Fenster (alpha = 4) im Zeitbereich&#39;</span><span class="p">)</span>
<span class="n">ax_spectrum_k4</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz rad/pi &#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;D√§mpfung in dB&#39;</span><span class="p">,</span> 
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Kaiser-Fenster (alpha = 4) im Frequenzbereich&#39;</span><span class="p">)</span>

<span class="c1"># time and frequency domain plots of beta = 2 </span>
<span class="n">fig2</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_sample_k2</span><span class="p">,</span> <span class="n">ax_spectrum_k2</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax_sample_k2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k2_window</span><span class="p">)</span>
<span class="n">ax_spectrum_k2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_fft_k2</span><span class="p">,</span> <span class="n">spectrum_k2_abs</span><span class="p">)</span>
<span class="n">ax_sample_k2</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenndex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x[k]&#39;</span><span class="p">,</span> 
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Kaiser-Fenster (alpha = 2) im Zeitbereich&#39;</span><span class="p">)</span>
<span class="n">ax_spectrum_k2</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz rad/pi &#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;D√§mpfung in dB&#39;</span><span class="p">,</span> 
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Kaiser-Fenster (alpha = 2) im Frequenzbereich&#39;</span><span class="p">)</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># glue this figure to paste it later (no effect outside of MyST NB)</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;KaiserWindow-a4&quot;</span><span class="p">,</span> <span class="n">fig1</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;KaiserWindow-a2&quot;</span><span class="p">,</span> <span class="n">fig2</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="ed36265e-47fd-4b59-8290-abbf87d228d9" name="ec288382-acef-4e79-8068-aa185d4670a3" type="radio">
</input><label class="sd-tab-label" for="ed36265e-47fd-4b59-8290-abbf87d228d9">
von Hann</label><div class="sd-tab-content docutils">
<ul class="simple">
<li><p><strong>von Hann-Fenster (oft f√§lschlich Hanning):</strong> F√ºr das Hann-Fenster ist
<span class="math notranslate nohighlight">\(\alpha = \beta = 0{,}5\)</span> und <span class="math notranslate nohighlight">\(\gamma = 0\)</span>. Daraus ergibt sich im
Frequenzbereich ein etwas breiteres Hauptmaxima <span class="math notranslate nohighlight">\(4\pi/N\)</span>. Die
Nebenmaxima sind daf√ºr im Gegensatz zum Rechteck-Fenster sehr viel
st√§rker bed√§mpft.</p></li>
</ul>
<figure class="align-default" id="fig-hannwindow" style="width: 100%">
<div class="cell_output docutils container">
<img alt="_images/spektren_29_1.png" src="_images/spektren_29_1.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 5.11 </span><span class="caption-text">Zeitliche und spektrale Eigenschaft des von Hann-Fensters</span><a class="headerlink" href="#fig-hannwindow" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="9151a769-d43a-4751-afe6-5328def99a3a" name="ec288382-acef-4e79-8068-aa185d4670a3" type="radio">
</input><label class="sd-tab-label" for="9151a769-d43a-4751-afe6-5328def99a3a">
Hamming</label><div class="sd-tab-content docutils">
<ul class="simple">
<li><p><strong>Hamming-Fenster:</strong> F√ºr das Hamming-Fenster ist <span class="math notranslate nohighlight">\(\alpha = 0{,}54\)</span>,
<span class="math notranslate nohighlight">\(\beta = 0{,}46\)</span> und <span class="math notranslate nohighlight">\(\gamma = 0\)</span>. Das Design-Ziel des Hamming-Fenster
ist das erste Nebenmaxima m√∂glichst optimal zu unterdr√ºcken. Daf√ºr
geht aber insgesamt eine schlechtere D√§mpfung der anderen
Nebenmaxima einher. Die Verbreiterung entspricht der des
Hann-Fensters <span class="math notranslate nohighlight">\(4\pi/N\)</span>.</p></li>
</ul>
<figure class="align-default" id="fig-hammingwindow" style="width: 100%">
<div class="cell_output docutils container">
<img alt="_images/spektren_30_1.png" src="_images/spektren_30_1.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 5.12 </span><span class="caption-text">Zeitliche und spektrale Eigenschaft des Hamming-Fensters</span><a class="headerlink" href="#fig-hammingwindow" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="b76ed224-a65d-40ba-bdf3-749cf9b1f582" name="ec288382-acef-4e79-8068-aa185d4670a3" type="radio">
</input><label class="sd-tab-label" for="b76ed224-a65d-40ba-bdf3-749cf9b1f582">
Blackman</label><div class="sd-tab-content docutils">
<ul class="simple">
<li><p><strong>Blackman-Fenster:</strong> F√ºr das Blackman-Fenster ist <span class="math notranslate nohighlight">\(\alpha = 0{,}42\)</span>,
<span class="math notranslate nohighlight">\(\beta = 0{,}5\)</span> und <span class="math notranslate nohighlight">\(\gamma = 0{,}08\)</span>. Dieses Fenster hat eine deutlich
breitere Hauptkeule <span class="math notranslate nohighlight">\(6\pi/N\)</span>, aber die D√§mpfung der Nebenmaxima und
der Abfall der weiteren Nebenmaxima ist sehr hoch.</p></li>
</ul>
<figure class="align-default" id="fig-blackmanwindow" style="width: 100%">
<div class="cell_output docutils container">
<img alt="_images/spektren_31_1.png" src="_images/spektren_31_1.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 5.13 </span><span class="caption-text">Zeitliche und spektrale Eigenschaft des Blackman-Fensters</span><a class="headerlink" href="#fig-blackmanwindow" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="4ddb8422-24ea-4d2b-98fe-6cdfaa4bd478" name="ec288382-acef-4e79-8068-aa185d4670a3" type="radio">
</input><label class="sd-tab-label" for="4ddb8422-24ea-4d2b-98fe-6cdfaa4bd478">
Dolph-Tschebyscheff</label><div class="sd-tab-content docutils">
<ul class="simple">
<li><p><strong>Dolph-Tschebyscheff-Fenster:</strong> Im Gegensatz zu den anderen Fenstern
in dasDolph-Tschebyscheff-Fenster parametrisierbar. Bei einer
vorgegebenen Fensterl√§nge <span class="math notranslate nohighlight">\(N\)</span> kann die Absenkung der Nebenzipfel
angegeben werden. Dieser Wert wird f√ºr alle Nebenzipfel gleichm√§√üig
erreicht. Die Breite der Hauptkeule wird gleichzeitig optimal klein
f√ºr eine gegebene Fensterl√§nge <span class="math notranslate nohighlight">\(N\)</span>. Siehe auch <code class="docutils literal notranslate"><span class="pre">chebwin</span></code> in Matlab.</p></li>
</ul>
<figure class="align-default" id="fig-chebwindow" style="width: 100%">
<div class="cell_output docutils container">
<img alt="_images/spektren_32_2.png" src="_images/spektren_32_2.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 5.14 </span><span class="caption-text">Zeitliche und spektrale Eigenschaft des
Dolph-Tschebyscheff-Fensters</span><a class="headerlink" href="#fig-chebwindow" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="16685bef-caeb-4796-a5d8-9cf08d9f1b77" name="ec288382-acef-4e79-8068-aa185d4670a3" type="radio">
</input><label class="sd-tab-label" for="16685bef-caeb-4796-a5d8-9cf08d9f1b77">
Kaiser-Fester</label><div class="sd-tab-content docutils">
<ul class="simple">
<li><p><strong>Kaiser-Fenster:</strong> Auch das Kaiser-Fenster ist mit Hilfe des
Parameters <span class="math notranslate nohighlight">\(\alpha\)</span> ver√§nderlich. Es basiert auf der Form</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-eq-kaiser-fenster">
<span class="eqno">(5.21)<a class="headerlink" href="#equation-eq-kaiser-fenster" title="Permalink to this equation">#</a></span>\[\begin{split}
       w(k,\alpha) = \left\{\begin{array}{c}
         \frac{I_0\left(\alpha \sqrt{1-(k/N)^2}\right)}{I_0 (\alpha)}     \quad mit \quad 0\leq k
       &lt; N\\
         0 \quad \quad \mbox{sonst} \\
       \end{array}
       \right.
\end{split}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(I_0\)</span> die modifizierte Bessel-Funktion nullter
Ordnung darstellt.</p>
<p><a class="reference internal" href="#fig-kaiserwindow-a2"><span class="std std-numref">Abbildung 5.15</span></a>  und
<a class="reference internal" href="#fig-kaiserwindow-a4"><span class="std std-numref">Abbildung 5.16</span></a>  zeigen f√ºr unterschiedliche <span class="math notranslate nohighlight">\(\alpha\)</span>
den zeitlichen Verlauf und die dazugeh√∂rigen spektralen
Eigenschaften.</p>
<figure class="align-default" id="fig-kaiserwindow-a2" style="width: 75%">
<div class="cell_output docutils container">
<img alt="_images/spektren_33_3.png" src="_images/spektren_33_3.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 5.15 </span><span class="caption-text">Zeitliche und spektrale Eigenschaft des
Kaiser-Fensters mit
<span class="math notranslate nohighlight">\(\alpha =\)</span> 2.</span><a class="headerlink" href="#fig-kaiserwindow-a2" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="fig-kaiserwindow-a4" style="width: 75%">
<div class="cell_output docutils container">
<img alt="_images/spektren_33_2.png" src="_images/spektren_33_2.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 5.16 </span><span class="caption-text">Zeitliche und spektrale Eigenschaft des
Kaiser-Fensters mit
<span class="math notranslate nohighlight">\(\alpha =\)</span> 4.</span><a class="headerlink" href="#fig-kaiserwindow-a4" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="id7"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><div class="math notranslate nohighlight">
\[1+x + x^2 + \cdots + x^{N-1} = \frac{1-x^N}{1-x}\]</div>
</dd>
<dt class="label" id="id8"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>Es enstehen keine genaueren Spektralwerte gegen√ºber der kurzen
Folge. Die Werte bei der h√∂heren Frequenzaufl√∂sung k√∂nnten auch aus
einer Interpolation des Spektrums mit geringrer Aufl√∂sung gewonnen
werden.</p>
</dd>
<dt class="label" id="id9"><span class="brackets"><a class="fn-backref" href="#id5">5</a></span></dt>
<dd><p>In Matlab wird die DFT durch die Funktion <code class="docutils literal notranslate"><span class="pre">FFT</span></code> aufgerufen.</p>
</dd>
<dt class="label" id="id10"><span class="brackets"><a class="fn-backref" href="#id6">6</a></span></dt>
<dd><p>Bei der Darstellung wurden die jeweiligen √úbertragungsfunktionen
auf ihr Maximum normiert, so dass sich immer ein Hauptmaxima mit 0dB
ergibt.</p>
</dd>
</dl>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="ztrafo.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">4. </span>z-Transformation</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="filter.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6. </span>Filter</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Joerg Bitzer<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>